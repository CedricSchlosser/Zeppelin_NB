{"paragraphs":[{"text":"%md\n#Step 1 :\n##Import new files on HDFS \n#### Unzip freshly received data with the tool provided for matlab in: \n    N:\\DA\\SOC\\NP\\ORG\\DGT\\UNIX\\SCIENTIFIQUE\\CSC\\PROJET\\IRYS2-TREND\\02-ANALYSES\\02_SYSTEMES\\matlab-v011500-d20200721\\matlab\n### Then launch trend monitoring and click on check for new files. If there are new files to process, the tool will take them and sort them in the correct folder on the newtwork N:\\\n#### To synchronise local folder from the N:\\ with the big data datalake, write this command line in a CMD interpreter (write cmd in search bar then press enter) : \n    python N:\\DA\\SOC\\NP\\ORG\\DGT\\POLE-SYSTEME\\PRESTATION\\DTS_Cedric_Schlosser\\Importation\\webhdfs-master@cb177a1893d\\importation_acmf_new_version.py \n#### Enter password LDAP password, press enter and wait for the end","dateUpdated":"2023-08-29T17:26:22+0200","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step 1 :</h1>\n<h2>Import new files on HDFS</h2>\n<h4>Unzip freshly received data with the tool provided for matlab in:</h4>\n<pre><code>N:\\DA\\SOC\\NP\\ORG\\DGT\\UNIX\\SCIENTIFIQUE\\CSC\\PROJET\\IRYS2-TREND\\02-ANALYSES\\02_SYSTEMES\\matlab-v011500-d20200721\\matlab\n</code></pre>\n<h3>Then launch trend monitoring and click on check for new files. If there are new files to process, the tool will take them and sort them in the correct folder on the newtwork N:\\</h3>\n<h4>To synchronise local folder from the N:\\ with the big data datalake, write this command line in a CMD interpreter (write cmd in search bar then press enter) :</h4>\n<pre><code>python N:\\DA\\SOC\\NP\\ORG\\DGT\\POLE-SYSTEME\\PRESTATION\\DTS_Cedric_Schlosser\\Importation\\webhdfs-master@cb177a1893d\\importation_acmf_new_version.py \n</code></pre>\n<h4>Enter password LDAP password, press enter and wait for the end</h4>\n"}]},"apps":[],"jobName":"paragraph_1693322782860_-1715852975","id":"20221102-110041_543643774","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:52"},{"text":"%md \n#Step 2 :\n## Preprocessing of the newly imported data\n","dateUpdated":"2023-08-29T17:26:22+0200","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step 2 :</h1>\n<h2>Preprocessing of the newly imported data</h2>\n"}]},"apps":[],"jobName":"paragraph_1693322782885_-1725471698","id":"20221102-110305_990680666","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:53"},{"title":"Nombre de vols avant prétraitement","text":"%pyspark\nimport subprocess, re\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\n\nfrom datetime import datetime\nstart = datetime.now()\nprint('Nombre de rapport vol avant pretraitement le', start)\n\nSN_vol = listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2')\nfor sn in SN_vol:\n    print(sn[-5:], len(listdir(sn)))","dateUpdated":"2023-08-29T17:26:22+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Nombre de rapport vol avant pretraitement le 2023-06-29 13:49:13.061320\nSN267 519\nSN268 1113\nSN269 1125\nSN270 1094\nSN412 1486\nSN425 1737\nSN449 553\nSN455 563\nSN466 511"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1713<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1713/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1713/</a>"}]},"apps":[],"jobName":"paragraph_1693322782901_-1719315715","id":"20221102-112448_1589718539","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:54"},{"title":"Lancement du pretraitement","text":"%sh\nexport SPARK_MAJOR_VERSION=2\n\nspark-submit --deploy-mode cluster --master yarn --executor-cores 32 --driver-memory 25g --executor-memory 100g --conf spark.storage.memoryFraction=0.6 --queue dev /da/sc/np/home/data/e854129/spark_submit/new_files/Pretraitement_new_files_27_01_2023.py","dateUpdated":"2023-08-29T17:26:22+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"INCOMPLETE","msg":[{"type":"TEXT","data":"SPARK_MAJOR_VERSION is set to 2, using Spark2\n23/06/29 13:49:32 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n23/06/29 13:49:32 WARN DomainSocketFactory: The short-circuit local reads feature cannot be used because libhadoop cannot be loaded.\n23/06/29 13:49:32 INFO RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/06/29 13:49:32 INFO Client: Requesting a new application from cluster with 4 NodeManagers\n23/06/29 13:49:33 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (460000 MB per container)\n23/06/29 13:49:33 INFO Client: Will allocate AM container, with 28160 MB memory including 2560 MB overhead\n23/06/29 13:49:33 INFO Client: Setting up container launch context for our AM\n23/06/29 13:49:33 INFO Client: Setting up the launch environment for our AM container\n23/06/29 13:49:33 INFO Client: Preparing resources for our AM container\n23/06/29 13:49:36 INFO Client: Use hdfs cache file as spark.yarn.archive for HDP, hdfsCacheFile:hdfs://hdfs.isilon.dassault-avion.fr:8020/hdp/apps/2.6.5.0-292/spark2/spark2-hdp-yarn-archive.tar.gz\n23/06/29 13:49:36 INFO Client: Source and destination file systems are the same. Not copying hdfs://hdfs.isilon.dassault-avion.fr:8020/hdp/apps/2.6.5.0-292/spark2/spark2-hdp-yarn-archive.tar.gz\n23/06/29 13:49:36 INFO Client: Uploading resource file:/da/sc/np/home/data/e854129/spark_submit/new_files/Pretraitement_new_files_27_01_2023.py -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1714/Pretraitement_new_files_27_01_2023.py\n23/06/29 13:49:36 INFO Client: Uploading resource file:/usr/hdp/current/spark2-client/python/lib/pyspark.zip -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1714/pyspark.zip\n23/06/29 13:49:39 INFO Client: Uploading resource file:/usr/hdp/current/spark2-client/python/lib/py4j-0.10.6-src.zip -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1714/py4j-0.10.6-src.zip\n23/06/29 13:49:39 INFO Client: Uploading resource file:/tmp/spark-e526f14e-304e-4ac0-8fba-83bd0299f23f/__spark_conf__5461962100578822203.zip -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1714/__spark_conf__.zip\n23/06/29 13:49:40 WARN Client: spark.yarn.am.extraJavaOptions will not take effect in cluster mode\n23/06/29 13:49:40 INFO SecurityManager: Changing view acls to: e854129\n23/06/29 13:49:40 INFO SecurityManager: Changing modify acls to: e854129\n23/06/29 13:49:40 INFO SecurityManager: Changing view acls groups to: \n23/06/29 13:49:40 INFO SecurityManager: Changing modify acls groups to: \n23/06/29 13:49:40 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(e854129); groups with view permissions: Set(); users  with modify permissions: Set(e854129); groups with modify permissions: Set()\n23/06/29 13:49:40 INFO Client: Submitting application application_1661169780396_1714 to ResourceManager\n23/06/29 13:49:40 INFO YarnClientImpl: Submitted application application_1661169780396_1714\n23/06/29 13:49:41 INFO Client: Application report for application_1661169780396_1714 (state: ACCEPTED)\n23/06/29 13:49:41 INFO Client: \n\t client token: N/A\n\t diagnostics: AM container is launched, waiting for AM container to Register with RM\n\t ApplicationMaster host: N/A\n\t ApplicationMaster RPC port: -1\n\t queue: dev\n\t start time: 1688039385412\n\t final status: UNDEFINED\n\t tracking URL: http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1714/\n\t user: e854129\n23/06/29 13:49:42 INFO Client: Application report for application_1661169780396_1714 (state: ACCEPTED)\n23/06/29 13:49:43 INFO Client: Application report for application_1661169780396_1714 (state: ACCEPTED)\n23/06/29 13:49:44 INFO Client: Application report for application_1661169780396_1714 (state: ACCEPTED)\n23/06/29 13:49:46 INFO Client: Application report for application_1661169780396_1714 (state: ACCEPTED)\n23/06/29 13:49:47 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:47 INFO Client: \n\t client token: N/A\n\t diagnostics: N/A\n\t ApplicationMaster host: 192.200.242.12\n\t ApplicationMaster RPC port: 0\n\t queue: dev\n\t start time: 1688039385412\n\t final status: UNDEFINED\n\t tracking URL: http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1714/\n\t user: e854129\n23/06/29 13:49:48 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:49 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:50 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:51 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:52 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:53 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:54 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:55 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:56 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:57 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:58 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:49:59 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:00 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:01 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:02 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:03 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:04 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:05 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:06 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:07 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:08 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:09 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:10 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:11 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:12 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:13 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:14 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:15 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:16 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:17 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:18 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:19 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:20 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:21 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:22 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:23 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:24 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:25 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:26 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:27 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:28 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:29 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n23/06/29 13:50:30 INFO Client: Application report for application_1661169780396_1714 (state: RUNNING)\n"},{"type":"TEXT","data":"Paragraph received a SIGTERM\nExitValue: 143"}]},"apps":[],"jobName":"paragraph_1693322782918_-1736629416","id":"20221102-111209_936936743","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:55"},{"title":"Vérification du déroulement ","text":"%sh\r\nyarn application -list \r\nyarn application -appStates RUNNING -list | grep \"applicationName\"","dateUpdated":"2023-08-29T17:26:22+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"23/06/30 09:15:42 INFO client.RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/06/30 09:15:42 INFO client.AHSProxy: Connecting to Application History server at dalbigm03.dassault-avion.fr/192.200.242.3:10200\nTotal number of applications (application-types: [] and states: [SUBMITTED, ACCEPTED, RUNNING]):2\n                Application-Id\t    Application-Name\t    Application-Type\t      User\t     Queue\t             State\t       Final-State\t       Progress\t                       Tracking-URL\napplication_1661169780396_1718\t   livy-session-8169\t               SPARK\t   e854129\t       dev\t           RUNNING\t         UNDEFINED\t            10%\thttp://dalbigc03.dassault-avion.fr:37124\napplication_1661169780396_1602\tThrift JDBC/ODBC Server\t               SPARK\t      hive\t   default\t           RUNNING\t         UNDEFINED\t            10%\thttp://dalbigm01.dassault-avion.fr:4040\n23/06/30 09:15:43 INFO client.RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/06/30 09:15:43 INFO client.AHSProxy: Connecting to Application History server at dalbigm03.dassault-avion.fr/192.200.242.3:10200\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1693322782933_-1731627680","id":"20221102-113314_719818459","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"title":"Arret d'un spark submit","text":"%sh\r\nyarn application -kill application_1661169780396_1493\r\n","dateUpdated":"2023-08-29T17:26:22+0200","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"23/05/04 15:14:36 INFO client.RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/05/04 15:14:37 INFO client.AHSProxy: Connecting to Application History server at dalbigm03.dassault-avion.fr/192.200.242.3:10200\nKilling application application_1661169780396_1493\n23/05/04 15:14:37 INFO impl.YarnClientImpl: Killed application application_1661169780396_1493\n"}]},"apps":[],"jobName":"paragraph_1693322782947_-1747787134","id":"20221103-143237_568908965","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"title":"A lancer après fin du pretraitement","text":"%pyspark\nfrom datetime import datetime\nimport subprocess, re\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\nstop = datetime.now()\nprint('Nombre de rapport apres pretraitement le', stop)\n\nSN_vol = listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2')\nfor sn in SN_vol:\n    print(sn[-5:], len(listdir(sn)))\n","dateUpdated":"2023-08-29T17:26:22+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Nombre de rapport apres pretraitement le 2023-06-30 09:17:09.157713\nSN267 520\nSN268 1114\nSN269 1167\nSN270 1125\nSN412 1515\nSN425 1801\nSN449 598\nSN455 600\nSN466 551"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1718<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1718/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1718/</a>"}]},"apps":[],"jobName":"paragraph_1693322782961_-1742400649","id":"20221102-113303_402800297","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"title":"Essai direct (Code de Louis Carmier)","text":"%pyspark\nimport sys\nfrom pyspark import SparkContext, SparkConf\nfrom pyspark.sql import SparkSession \n\nfrom pyspark.sql.types import StructType\nfrom pyspark.sql.types import StructField\nfrom pyspark.sql.types import StringType\n\nfrom pyspark.sql.functions import pandas_udf\n\nimport pandas as pd\n\nfrom datetime import datetime\nfrom datetime import timedelta\n\nimport subprocess, re\n\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.types import IntegerType\n\nimport pyspark.sql.functions as F\n\n#En entree un rdd et le numero de ligneF\n#En sortie une ligne du rdd\ndef GetSpecificRow(rdd, id):\n\treturn rdd.zipWithIndex().filter(lambda x: x[1]==id)\n\n#En entree un rdd associe a un fichier acmf\n#En sortie les colonnes du ichier ACMF\ndef get_header(rdd):\n\theaderRow = GetSpecificRow(rdd,6).map(lambda x: x[0]).map(lambda x: x.split(',')) #ici les donnees sont separees par des virgules\n\theader = headerRow.first()\n\theader = ['other' if column == ' ' else column for column in header]\n\treturn header\n\n#En entree une liste de noms de fichiers appartenant a un meme vol\n#En sortie un rdd contenant l'ensemble des fichiers d un meme vol concatenes.\ndef create_join_rdd(vol):\n\tc=0\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n   \n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\trdd2.collect()\n\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header\n\t\n#En entree un rdd et un header (label des colonnes)\n#En sortie une dataframe  objet qui permet des traitements par colonnes alors que rdd par ligne\ndef data_frame(rdd, header):\n\tschema = StructType([StructField(column, StringType(), True) for column in header])\n\tdf = spark.createDataFrame(rdd, schema)\n\tdf=df.toDF(*(c.replace(' ', '_') for c in df.columns))\n\tdf=df.toDF(*(c.replace('(', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace(')', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace('.', '_') for c in df.columns))\n\treturn df\n\t\n#En entree un rdd\n#En sortie l heure de debut d enregistrement\ndef trigger_time(rdd):\n\tTriggerTimeRow = GetSpecificRow(rdd,3).map(lambda x: x[0]).map(lambda x: x.split(' '))\n\tTriggerTime = ' '.join(TriggerTimeRow.first()[1:])\n\treturn TriggerTime\n\n#En entree une dataframe\n#en sortie la meme dataframe adjointe dun vecteur date\ndef insert_date(df):\n\t@pandas_udf(StringType())\n\tdef pandas_insert_date(trigger: pd.Series, frame: pd.Series) -> pd.Series:\n\t\ttrig=pd.Series([datetime.strptime(TriggerTime, \"%d %b %Y %H:%M:%S\") for TriggerTime in trigger])\n\t\tdelta=pd.Series([timedelta(milliseconds=int(ms)*100) for ms in frame])\n\t\tdate=trig+delta\n\t\treturn pd.Series([d.strftime(\"%d %m %Y %H:%M:%S.%f\") for d in date])\n\t\t\n\tdf=df.withColumn('date', pandas_insert_date(df['Trigger'], df['Frame_100_ms_']))\n\t\n\treturn df\n\t\n#retourne la liste des colonnes doublons (pour information avec leur nom d origine), le nouveau header avec les noms modifies, et une liste contenant le nom des colonnes doublons renommees\ndef detect_doublon(header):\n\tcolonnes=[]\n\tliste_doublon=[]\n\tliste_tot_doublons=[]\n\tc=0\n\tnew_header=[]\n\t\n\tfor col in header:\n\t\tif col in colonnes:\n\t\t\tif col in liste_doublon:\n\t\t\t\tc+=1\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\t\n\t\t\telse:\n\t\t\t\tliste_doublon.append(col)\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\telse:\n\t\t\tnew_header.append(col)\n\t\t\tcolonnes.append(col)\n\treturn liste_doublon, new_header, liste_tot_doublons\n\t\n#suppression des colonnes doublons    \ndef suppr_doublon(df, new_header, liste_tot_doublons):\n\tschema = StructType([StructField(column, StringType(), True) for column in new_header])\n\tcsv=df.rdd\n\tdf=spark.createDataFrame(csv, schema)\n\tfor col in liste_tot_doublons:\n\t\tdf=df.drop(df[col])\n\treturn df\n\t\n#en entree les fichiers appartenant a un meme vol\n#creation de la dataframe corrigee avec adjonction du vecteur temps\n#en sortie la dataframe corrigee\ndef create_df_vol(vol):\n\trdd,header=create_join_rdd(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date(df)\n\t\n\treturn df\n\t\n#les fonctions suivantes sont utiles dans le cas ou l on traite un fichier seul, qui n a pas pu etre lie a un vol.\ndef insert_date_seul(df, TriggerTime):\n\t@pandas_udf(StringType())\n\tdef pandas_insert_date(series: pd.Series) -> pd.Series:\n\t\tdate=datetime.strptime(TriggerTime, \"%d %b %Y %H:%M:%S\")\n\t\treturn pd.Series([(date+timedelta(milliseconds=int(ms)*100)).strftime(\"%d %m %Y %H:%M:%S.%f\") for ms in series])\n\t\n\tdf=df.withColumn('date', pandas_insert_date(df['Frame_100_ms_']))\n\t\n\treturn df\n\t\n#creation dune dataframe a parir dun fichier seul\ndef create_df(path):\n\trdd_brut = sc.textFile(path)\n\tTriggerTime=trigger_time(rdd_brut)\n\theader=get_header(rdd_brut)\n\trdd = rdd_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_seul(df, TriggerTime)\n\n\treturn df  \n\t\ndef create_df_slow(path):\n\trdd_brut = sc.textFile(path)\n\tTriggerTime=trigger_time(rdd_brut)\n\theader=get_header(rdd_brut)\n\trdd = rdd_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tdf=data_frame(rdd, header)\n\tdf = df.withColumn('Trigger', F.lit(TriggerTime))\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n \n\tdf=insert_date_udf(df)\n\t\n\treturn df\n\t\n#en entree le chemin vers un dossier\n#en sortie une la liste des fichiers dans le dossier\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\n\t\n#extraction du nom du fichier a partir du chemin complet\ndef extract_name(path):\n\tfor i in range (1, len(path)):\n\t\tif path[-i]=='/':\n\t\t\treturn (path[len(path)-i+1:-4])\n\t\t\t\n#extraction de la date d enregistrement\ndef id_date(path):\n\treturn(extract_name(path)[-15:])\n\t\n#identite de lavion et date\ndef id(path):\n\treturn(extract_name(path)[-23:])\n\t\n#Detection de fichiers appartenant a un meme vol\n#Le defaut est corrige\ndef isSameFlight(t1,t2):\n\ttry:\n\t\tt1 = datetime.strptime(t1,\"%Y%m%d%H%M%S\")\n\t\tt2 = datetime.strptime(t2,\"%Y%m%d%H%M%S\")\n\t\tif t1 > t2:\n\t\t\tdelta= t1-t2\n\t\telse:\n\t\t\tdelta=t2-t1\n\t\t\t\n\t\tif delta<timedelta(seconds=220):\n\t\t\treturn True\n\t\telse:\n\t\t\treturn False\n\texcept:\n\t\treturn False\n\t\t\n#version plus efficace de get_vols\ndef get_vols_perfo(liste_fichiers):\n\tif liste_fichiers==[]:\n\t\treturn []\n\telse:\n\t\tvol=[liste_fichiers[0]]\n\t\tL_vols=[]\n\t\tfor i in range(len(liste_fichiers)-1):\n\t\t\tp1=liste_fichiers[i]\n\t\t\tp2=liste_fichiers[i+1]\n\t\t\tif isSameFlight(id_date(p1)[:-1], id_date(p2)[:-1]):\n\t\t\t\ttry:\n\t\t\t\t\tif datetime.strptime(id_date(p2)[:-1], \"%Y%m%d%H%M%S\")  < datetime.strptime(id_date(vol[0])[:-1], \"%Y%m%d%H%M%S\"):\n\t\t\t\t\t\tvol.insert(0, p2)\n\t\t\t\t\tif datetime.strptime(id_date(p2)[:-1], \"%Y%m%d%H%M%S\")  > datetime.strptime(id_date(vol[-1])[:-1], \"%Y%m%d%H%M%S\"):\n\t\t\t\t\t\tvol.append(p2)\n\t\t\t\t\telse:\n\t\t\t\t\t\tvol.insert(len(vol)-2, p2)\n\t\t\t\texcept:\n\t\t\t\t\tprint(p1,p2)\n\t\t\telse:\n\t\t\t\tL_vols.append(vol)\n\t\t\t\tvol=[p2]\n\t\tL_vols.append(vol)\n\t\treturn L_vols\n\t\t\n#suppression des lignes ou la jointure est decalee\ndef fill(df):\n\tdf=df.replace(' ', None)\n\tdf=df.dropna(subset=df.columns[2:10])\n\t\n\treturn df\n\ndef fill2(df):\n\tfor c in df.columns[:-3]:\n\t\tdf = df.withColumn(c, F.regexp_replace(c, ' ', ''))\n\treturn df.dropna()\n\t\ndef isSameFlight_perfo2(t,vol):\n\ttry:\n\t\td=datetime.strptime(id_date(vol[0])[:-1], \"%Y%m%d%H%M%S\")\n\t\tf=datetime.strptime(id_date(vol[-1])[:-1], \"%Y%m%d%H%M%S\")\n\t\tT=datetime.strptime(t[:-1], \"%Y%m%d%H%M%S\")\n\t\tif T>=d and T<=f: \n\t\t\treturn True\n\t\telse: \n\t\t\treturn False\n\texcept:\n\t\tprint(id_date(vol[0]), id_date(vol[-1]))\n\t\t\n#distinciton entre fichiers irys et fichiers perfos\ndef nom_vol(path):\n\tif 'IRYS2' in path:\n\t\treturn('IRYS2_')\n\tif 'PERFOS' in path:\n\t\treturn('PERFOS_')\n\t\t\t\t\t\n#detection d un fichier vol\ndef is_Irys(path):\n\treturn 'IRYS2' in path or 'PERFOS' in path\n\t\n#detection de tous les fichiers vols et systeme\ndef get_files(files):\n\tsystems = []\n\tflights = []\n\tfor file in files:\n\t\tif is_Irys(file):\n\t\t\tflights.append(file)\n\t\telse:\n\t\t\tsystems.append(file)\n\treturn flights, systems\n\t\t\n\n#extraction nom du fichier systeme\ndef nom_syst(path):\n\treturn(extract_name(path)[:-24])\n\n#envoi de fichiers sur l hdfs\ndef envoi(df, nom, destination):\n\tdf.write.mode(\"overwrite\").parquet(destination+nom+'.parquet')\n\ndef decalage(df):\n\n\t@pandas_udf(StringType())\n\tdef pandas_del_na(series: pd.Series) -> pd.Series:\n\t\tt=series.size\n\t\tseries=series.dropna()\n\t\ttna=series.size\n\t\treturn pd.concat([series, pd.Series([None for i in range(t-tna)])])\n\t\t\n\tdf=df.replace(' ', None)\n\tfor c in df.columns:\n\t\tdf=df.withColumn(c, pandas_del_na(F.col(c)))\n\t\t\n\treturn df\n\n#system correspond au nom du rapport systeme a filtrer\ndef find_rename_send_system_report(L_vols, L_system, destination, system):\n\tif L_system==[] or L_vols==[]:\n\t\tNone\n\telse:\n\t\tL=[]\n\t\tfor p in L_system:\n\t\t\ttry:\n\t\t\t\tsys_split = p.split('_')[5]\n\t\t\t\tif system == sys_split:\n\t\t\t\t\tL.append(p)\n\t\t\texcept:\n\t\t\t\tpass\n\t\tfor syst in L:\n\t\t\tfound=False\n\t\t\tfor vol in L_vols:\n\t\t\t\tif isSameFlight_perfo2(id_date(syst),vol) and not found:\n\t\t\t\t\ttry:\n\t\t\t\t\t\tfound=True\n\t\t\t\t\t\tdf_syst=create_df(syst).repartition(1)\n\t\t\t\t\t\tdf_syst=decalage(df_syst)\n\t\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\t\tenvoi(df_syst, extract_name(syst)+'_'+id_date(vol[0]), destination)\n\t\t\t\t\texcept:\n\t\t\t\t\t\tpass\n\t\t\t\t\t\t\n#Recuperation des nouveaux fichiers Irys Perfo                    \ndef get_new_irys_syst(SN):\n\tancienSyst = listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_systeme/')\n\tlast=datetime.strptime('20101225153010', \"%Y%m%d%H%M%S\")\n\tfor syst in ancienSyst:\n\t\ttry:\n\t\t\tancienVols=listdir(syst + '/' + SN[-5:])\n\t\t\tfor vol in ancienVols:\n\t\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\t\tif last<date:\n\t\t\t\t\tlast=date\n\t\t\t\n\t\t\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/' + SN[-5:]))\n\t\t\t\n\t\t\tnouveauxIrys=[]\n\t\t\tfor irys in tousIrys:\n\t\t\t\ttry:\n\t\t\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\t\tif date>last:\n\t\t\t\t\t\tnouveauxIrys.append(irys)\n\t\t\t\texcept:\n\t\t\t\t\tprint(irys)        \n\t\t\t\n\t\texcept:\n\t\t\tpass\n\t\t\n\treturn nouveauxIrys\n\t\ndef get_new_irys_vol(SN):\n\tancienVols=listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'+SN)\n\ttry:\n\t\tlast=datetime.strptime(ancienVols[0][-23:-9], \"%Y%m%d%H%M%S\")\n\texcept:\n\t\tlast=datetime.strptime(ancienVols[3][-23:-9], \"%Y%m%d%H%M%S\")\n\tfor vol in ancienVols:\n\t\ttry:\n\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\tif last<date:\n\t\t\t\tlast=date\n\t\texcept:\n\t\t\tNone\n\t\t\t\n\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+SN))\n\t\n\tnouveauxIrys=[]\n\tfor irys in tousIrys:\n\t\ttry:\n\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\tif date>last:\n\t\t\t\tnouveauxIrys.append(irys)\n\t\texcept:\n\t\t\tNone\n\n\treturn nouveauxIrys\n\t\t\ndef get_new_irys_manuel(SN, date_str):\n\t\t\n\tlast = datetime.strptime(date_str, \"%Y%m%d%H%M%S\")\n\t\n\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+SN))\n\t\n\tnouveauxIrys=[]\n\tfor irys in tousIrys:\n\t\ttry:\n\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\tif date>last:\n\t\t\t\tnouveauxIrys.append(irys)\n\t\texcept:\n\t\t\tNone\n\n\treturn nouveauxIrys\n\t\ndef get_new_files(SN, all_files=False):\n\t\n\tancienVols=listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/' + SN)\n\n\ttousIrys, tousSyst = get_files(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+ SN))\n\n\t\t\n\t#Getting date of last flight\n\tif (ancienVols == []) or (all_files) :\n\t\treturn tousIrys, tousSyst\n\telse:\n\t\tlast = None\n\t\ti=0\n\t\twhile last==None:\n\t\t\ttry:\n\t\t\t\tlast=datetime.strptime(ancienVols[i][-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\texcept:\n\t\t\t\tpass\n\t\t\ti+=1\n\t\t  \n\t\tfor vol in ancienVols:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\t\tif last<date:\n\t\t\t\t\tlast=date\n\t\t\texcept:\n\t\t\t\tpass\n\t\tlast = last - timedelta(days=0) # modifiel le Delta pour ne pas toucher au fichier de Louis, pas de droits d ecriture\n\t\t\n\t\t\n\t\t\n\t\tnouveauxIrys=[]\n\t\tfor irys in tousIrys:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\tif date>last:\n\t\t\t\t\tnouveauxIrys.append(irys)\n\t\t\texcept:\n\t\t\t\tNone\n\t\t\n\t\tnouveauxSyst=[]\n\t\tfor syst in tousSyst:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(id_date(syst)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\tif date>last:\n\t\t\t\t\tnouveauxSyst.append(syst)\n\t\t\texcept:\n\t\t\t\tNone\n\t\treturn nouveauxIrys, nouveauxSyst\n\t\n\t\n\t\n#Retourne la liste des systemes presents dans la liste des systemes                    \ndef get_system_identifier(L_systems):\n\tsystems = []\n\tfor path in L_systems:    \n\t\tif '.csv' in path:\n\t\t\tp = path.split('_')\n\t\t\tif ('TRD' in p[1]) | ('MUX' in p[1]):\n\t\t\t\tif (p[5] not in systems) & (p[5] != 'IRYS2') & (p[5] != 'PERFOS'):\n\t\t\t\t\tsystems.append(p[5])\n\t\t\telse:\n\t\t\t\tif (p[4] not in systems) & ('P1153' in p[1]):\n\t\t\t\t\tsystems.append(p[4])\n\treturn systems \n\ndef insert_date_udf(df):\n\tdef insert_date_simple(trigger, frame):\n\t\ttrig = datetime.strptime(trigger, \"%d %b %Y %H:%M:%S\")\n\t\tdelta = timedelta(milliseconds=int(frame)*100)\n\t\tdate = trig + delta\n\t\treturn date.strftime(\"%d %m %Y %H:%M:%S.%f\")\n\tinsert_date_udf = F.udf(insert_date_simple, StringType())\n\t\n\tdf=df.withColumn('date', insert_date_udf(df['Trigger'], df['Frame_100_ms_']))\n\treturn df\n\t\ndef create_df_vol_slow(vol):\n\trdd,header=create_join_rdd_debug(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_udf(df)\n\t\n\treturn df\n\t\ndef create_join_rdd_debug(vol):\n\t\n\tc=0\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tlength0 = rdd1.count()\n\t\n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\tif rdd2.count() != length0:\n\t\t\trdd=sc.union(rdds)\n\t\t\treturn rdd,header\n\t\telse:\n\t\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\t\trdd2.collect()\n\t\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header\n\t\ndef find_rename_send_system_report_all_files(L_vols, L_system, destination, system):\n\tif L_system==[] or L_vols==[]:\n\t\tNone\n\telse:\n\t\tL=[]\n\t\tfor p in L_system:\n\t\t\ttry:\n\t\t\t\tsys_split = p.split('_')[5]\n\t\t\t\tif system == sys_split:\n\t\t\t\t\tL.append(p)\n\t\t\texcept:\n\t\t\t\tpass\n\t\tfor syst in L:\n\t\t\tfound=False\n\t\t\tfor vol in L_vols:\n\t\t\t\tif isSameFlight_perfo2(id_date(syst),vol):\n\t\t\t\t\ttry:\n\t\t\t\t\t\tfound=True\n\t\t\t\t\t\tdf_syst=create_df_slow(syst).repartition(1)\n\t\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\t\tversion = syst.split('/')[8]\n\t\t\t\t\t\tenvoi(df_syst, extract_name(syst)+'_'+id_date(vol[0]), destination + version + '/')\n\t\t\t\t\t\tbreak\n\t\t\t\t\texcept:\n\t\t\t\t\t\tbreak\n\t\t\t\t\n\t\t\tif not found:\n\t\t\t\ttry:\n\t\t\t\t\tdf_syst=create_df_slow(syst).repartition(1)\n\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\tversion = syst.split('/')[8]\n\t\t\t\t\tenvoi(df_syst, extract_name(syst)+'_X', destination + version + '/')\n\t\t\t\texcept:\n\t\t\t\t\tpass\n\n#concatenation et envoi des fichiers sur l hdfs\ndef concatenate_send(L_vols, destination):\n\tseptx = ['SN267', 'SN268', 'SN269', 'SN270']\n\t\n\tif L_vols==[]:\n\t\tNone\n\telse:\n\t\tfor vol in L_vols:\n\t\t\tif len(vol)>1:\n\t\t\t\t\tdf=create_df_vol_slow(vol)\n\t\t\t\t\tdf= df.drop('other')\n\t\t\t\t\tdf=fill2(df)\n\t\t\t\t\tdf=df.repartition('Part')\n\t\t\t\t\tversion = vol[0].split('/')[8]\n\t\t\t\t\tp = nom_vol(vol[0])+id(vol[0])\n\t\t\t\t\t#Lorsque l'ACMF est extrait du CMC le nom et numero avion n'est pas forcement ecrit\n\t\t\t\t\tif '__' in p:\n\t\t\t\t\t\t\n\t\t\t\t\t\tif version in septx:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0420' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0580' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\telse:\n\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+id(vol[0]), destination + version + '/')\n\n\t\t\t\t\t\n\t\t\telse:\n\t\t\t\ttry:\n\t\t\t\t\tdf=create_df_slow(vol[0])\n\t\t\t\t\tdf= df.drop('other')\n\t\t\t\t\tdf=fill2(df)\n\t\t\t\t\tdf=df.withColumn('Part', F.lit('0'))\n\t\t\t\t\tp = nom_vol(vol[0])+id(vol[0])\n\t\t\t\t\tversion = vol[0].split('/')[8]\n\t\t\t\t\tif '__' in p:\n\t\t\t\t\t\tif version in septx:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0420' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0580' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+id(vol[0]), destination + version + '/')\n\t\t\t\texcept:\n\t\t\t\t\tprint('Bug 2')\n\n#Envoi des nouveaux fichiers systemes\ndef write_systems_files_datalake(input_path):\n\t\n\t#inputSN = listdir(input_path)\n\t#A MODIFIER ICI POUR NE PAS METTRE LA PRIO SUR 268\n\tinputSN = ['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN412']\n# \tinputSN = ['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN267', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN268', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN269', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN270', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN412', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN425', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN449', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN455', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466']\n\n\t\n\tfor SN in inputSN:\n\n\t\t\tif not '.xlsx' in SN:\n\t\t\t\toutput_destination_vol = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'\n\t\t\t\tL_vols, L_syst = get_new_files(SN[-5:], all_files=False)\n\t\t\t\t\n\t\t\t\t#MODIF ICI\n\t\t\t\tnew_vols = get_vols_perfo(L_vols)\n\t\t\t\t\n\t\t\t\tconcatenate_send(new_vols, output_destination_vol)\n\t\t\t\t\n\t\t\t\tsystems = get_system_identifier(L_syst)\n\n\t\t\t\tif systems != []:\n\t\t\t\t\tfor system in systems:\n\t\t\t\t\t\toutput_destination_syst = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_systeme_2/' + system + '/'\n\t\t\t\t\t\tfind_rename_send_system_report_all_files(new_vols, L_syst, output_destination_syst, system)\n\t\t\t\t\t\t\nwrite_systems_files_datalake('/datalake/prod/c2/ddd/crm/acmf/fichier_brut')","dateUpdated":"2023-08-29T17:26:22+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0947<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0947/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0947/</a>"}]},"apps":[],"jobName":"paragraph_1693322782973_-1747017636","id":"20221104-150256_54577721","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"text":"%pyspark\nSN = '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466'\n\noutput_destination_vol = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'\nL_vols, L_syst = get_new_files(SN[-5:], all_files=False)","dateUpdated":"2023-08-29T17:26:22+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0929<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/</a>"}]},"apps":[],"jobName":"paragraph_1693322782985_-1665450869","id":"20230126-140602_1668236806","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"text":"%pyspark\nnew_vols = get_vols_perfo(L_vols)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0929<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/</a>"}]},"apps":[],"jobName":"paragraph_1693322782998_-1656601645","id":"20230126-140701_186133162","dateCreated":"2023-08-29T17:26:22+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%pyspark\nprint(new_vols[0])","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155424t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155606t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155747t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155930t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160112t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160253t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160435t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160617t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160759t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160942t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161124t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161306t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161449t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161632t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161814t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161957t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162139t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162321t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162503t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162645t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162827t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163008t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163150t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163332t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163514t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163656t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163838t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164020t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164203t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164345t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164527t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164710t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164852t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165034t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165216t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165358t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165539t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165721t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165903t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170045t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170228t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170410t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170552t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170734t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170917t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171059t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171242t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171426t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171609t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171751t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171932t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128172114t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128172256t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128172438t.csv']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0934<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/</a>"}]},"apps":[],"jobName":"paragraph_1693322783010_-1673530596","id":"20230126-140824_1782834653","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%pyspark\nconcatenate_send([new_vols[1]], output_destination_vol)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"An error occurred while calling o83250.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\nTraceback (most recent call last):\n  File \"<stdin>\", line 601, in concatenate_send\n  File \"<stdin>\", line 304, in envoi\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/readwriter.py\", line 804, in parquet\n    self._jwrite.parquet(path)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/protocol.py\", line 320, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o83250.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\n\n"}]},"apps":[],"jobName":"paragraph_1693322783284_-1965170263","id":"20230126-141121_1875415749","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%pyspark\ndf = spark.read.parquet(\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424t.parquet\")\n","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0934<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/</a>"}]},"apps":[],"jobName":"paragraph_1693322783301_-1984022959","id":"20230126-142229_1215656770","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\ndf.show()","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------+-------------------------------------+------------------------------------------+-------------------------------------------+------------------------------------------+-----------------------------------------+-----------------------------------------------+-----------------------------------------+-------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------+--------------------------------------------------------------------+-------------------------------------------+-----------------------------------------+--------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------------------+--------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------+---------------------------------------------+-------------------------------------------------+----------------------------------------------+--------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------+--------------------------------------------------+--------------------------------------------------+--------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------+--------------------------------------------------------+-----------------------------------------------+----------------------------------------------+------------------------------------------------+-----------------------------------------------+-----------------------------------------------+------------------------------------------------------+----------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------+-----------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+--------------------------------------------------------------------------------+------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------+--------------------+----+--------------------+\n|Frame_100_ms_|_ASCB_D\\ADS\\ADS1aADA\\airData1000msecA429Data\\totalAirTemperature|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\lbl241b28_12AngleOfAttackAircraft|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\lbl250b28_12AngleofSideslip|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\staticAirTemperature|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\staticPressure|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\totalPressure|_ASCB_D\\ADS\\ADS2aADA\\airData1000msecA429Data\\totalAirTemperature|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\lbl241b28_12AngleOfAttackAircraft|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\lbl250b28_12AngleofSideslip|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\staticAirTemperature|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\staticPressure|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\totalPressure|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Data\\lbl274b29_14BASFlow|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl270b22BrakeHeatingMode|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl270b23SDuctAntiIceMode|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl270b24WingAntiIceMode|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl272b15MprsovEng1ClosedPositionSwitch|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl272b29HprSovClosed|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Data\\lbl274b29_14BASFlow|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Data\\lbl311b29_14LHFreshAirFlow|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Discretes\\lbl272b15MprSovClosedEng3Position|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Discretes\\lbl272b29HPPRSOVClosed|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Data\\lbl274b29_14BASFlow|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Data\\lbl311b29_14RHFreshAirFlow|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Discretes\\lbl272b15MprSovClosedEng2Position|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Discretes\\lbl272b29HPPRSOVClosed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone100msecA429Data\\lbl114b29_17LeftInboardBrakeTemperature|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone100msecA429Data\\lbl116b29_17RightInboardBrakeTemperature|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone100msecA429Discretes\\lbl271b20ParkBrakeValveHandlePosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl005b28_17LeftOutboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl006b28_17LeftInboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl007b28_17RightInboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl040b28_17RightOutboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl051b28_17LeftBrakeControlValveCurrent|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl052b28_17RightBrakeControlValveCurrent|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl070b28_17LeftBrakePressure|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl072b28_17RightBrakePressure|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl113b28_17ShutoffValveCurrent|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl171b29_21LeftPilotBrakePedalPosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl172b29_21RightPilotBrakePedalPosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl173b29_21LeftCopilotBrakePedalPosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl174b29_21RightCopilotBrakePedalPosition|_ASCB_D\\BCUTWO\\BCUTWO1aA429\\bcutwo100msecA429Data\\lbl050b28_17ParkEmergencyBrakeAccumulatorPressure|_ASCB_D\\CPCSCAB\\CPCSCAB1aA429\\cpcscab200msecA429Data\\lbl204b28_13CabinPressureActual|_ASCB_D\\EEC\\EEC1aA429\\eec1000msecA429Discretes\\lbl273b24ThrustReverser|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl300b29_15N1Trimmed|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl344b29_15N2MechanicalSpeed|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl345b29_17ITT|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl346b29_15N1MechanicalSpeed|_ASCB_D\\EEC\\EEC1aA429\\eec200msecA429Data\\lbl134b29_17TLAPlusAutothrottleTLATrim|_ASCB_D\\EEC\\EEC1aA429\\eec50msecA429Data\\lbl133b29_17SelectedTLA|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl300b29_15N1Trimmed|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl344b29_15N2MechanicalSpeed|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl345b29_17ITT|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl346b29_15N1MechanicalSpeed|_ASCB_D\\EEC\\EEC3aA429\\eec200msecA429Data\\lbl134b29_17TLAPlusAutothrottleTLATrim|_ASCB_D\\EEC\\EEC3aA429\\eec50msecA429Data\\lbl133b29_17SelectedTLA|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl300b29_15N1Trimmed|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl344b29_15N2MechanicalSpeed|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl345b29_17ITT|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl346b29_15N1MechanicalSpeed|_ASCB_D\\EEC\\EEC5aA429\\eec200msecA429Data\\lbl134b29_17TLAPlusAutothrottleTLATrim|_ASCB_D\\EEC\\EEC5aA429\\eec50msecA429Data\\lbl133b29_17SelectedTLA|_ASCB_D\\FCS\\FCS1At\\atDisplayed\\atControlMode|_ASCB_D\\FCS\\FCS1At\\atStatus\\atEngaged|_ASCB_D\\FCS\\FCS1Fd\\fdModes\\fdActiveLatMode|_ASCB_D\\FCS\\FCS1Fd\\fdModes\\fdActiveVertMode|_ASCB_D\\FCS\\FCS1Fd\\fdPitRolCmds\\fdPitchCmd|_ASCB_D\\FCS\\FCS1Fd\\fdPitRolCmds\\fdRollCmd|_ASCB_D\\FMS\\FMS1FMA\\rate1000ms\\zeroFuelWeightCG|_ASCB_D\\FMS\\FMS1FMA\\rate100ms\\grossWeight|_ASCB_D\\FMS\\FMS1FMA\\rate100ms\\phaseOfFlight|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl167b28_14LeftWingOuterTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl172b28_14CenterCircuitTotalFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl177b28_14LeftWingMiddleTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl200b28_14LeftWingInnerTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl201b28_14RightWingOuterTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl202b28_14RightWingMiddleTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl203b28_14RightWingInnerTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl213b28_14LeftFuelUsedQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl214b28_14RightFuelUsedQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl215b28_14CenterFuelUsedQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl257b28_14LeftCircuitTotalFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl261b28_14RightCircuitTotalFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel100msecA429Data\\lbl345b28_17CenterFuelFlow|_ASCB_D\\FUEL\\FUEL1aA429\\fuel100msecA429Data\\lbl346b28_17RightFuelFlow|_ASCB_D\\FUEL\\FUEL1aA429\\fuel100msecA429Data\\lbl347b28_17LeftFuelFlow|_ASCB_D\\GGF\\GGF1GGA\\hsiData\\leftMnGearState|_ASCB_D\\GGF\\GGF1GGA\\hsiData\\noseGearState|_ASCB_D\\GGF\\GGF1GGA\\hsiData\\rightMnGearState|_ASCB_D\\GIOFOUR\\GIOFOUR1aAnalog\\gioFour50msecVersatileAnalogData\\hydSysBPress|_ASCB_D\\GIOFOUR\\GIOFOUR1aDiscrete\\gioFour50msecDiscretes\\airbrakePanelInboardRH|_ASCB_D\\GIOFOUR\\GIOFOUR1aDiscrete\\gioFour50msecDiscretes\\casov2FullClosedSW|_ASCB_D\\GIOONE\\GIOONE1aAnalog\\gioOne50msecVersatileAnalogData\\hydSysAPress|_ASCB_D\\GIOONE\\GIOONE1aAnalog\\gioOne50msecVersatileAnalogData\\oxyTemperatureSignal|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\airbrakePanelOutboardLH|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\backupSlatSwIndic|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\casov1FullClosedSW|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\casov3FullClosedSW|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\flapSlatLeverPosSF3|_ASCB_D\\GIOTHREE\\GIOTHREE1aDiscrete\\gioThree50msecDiscretes\\airbrakePanelInboardLH|_ASCB_D\\GIOTWO\\GIOTWO1aAnalog\\gioTwo50msecVersatileAnalogData\\hydSysCPress|_ASCB_D\\GIOTWO\\GIOTWO1aAnalog\\gioTwo50msecVersatileAnalogData\\oxyPressureSignal|_ASCB_D\\GIOTWO\\GIOTWO1aDiscrete\\gioTwo50msecDiscretes\\airbrakePanelOutboardRH|_ASCB_D\\GIOTWO\\GIOTWO1aDiscrete\\gioTwo50msecDiscretes\\flapSlatLeverPosSF1|_ASCB_D\\GIOTWO\\GIOTWO1aDiscrete\\gioTwo50msecDiscretes\\flapSlatLeverPosSF2|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\altitude|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\latitude|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\latitudeFine|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\longitude|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\longitudeFine|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl137b29_14HybridTrackAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl175b28_14HybridGroundSpeed|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl263b29_17HybridFlightPathAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl266b29_14HybridNSVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl267b29_14HybridEWVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl345b29_14HybridVerticalVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyLatAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyLongAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyNormAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyPitchRate|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyRollRate|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyYawRate|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\flightPathAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\inertialVerticalSpd|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\pitchAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\rollAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\trueHeading|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\ewVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\nsVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\windDirectionTrue|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\windSpeed|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b20LMGUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b21LMGDownlock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b26NLGUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b27NLGDownlock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl271b28RMGUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl271b29RMGDownlock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl363b19LMGDoorUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl364b25RMGDoorUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl365b28GearHandleDown|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl365b29GearHandleUp|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu50msecA429Data\\lbl376b29_17NosewheelAngle|_ASCB_D\\LGSCU\\LGSCU2aA429\\lgscu100msecA429Discretes\\lbl365b28GearHandleDown|_ASCB_D\\LGSCU\\LGSCU2aA429\\lgscu100msecA429Discretes\\lbl365b29GearHandleUp|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b11Throttle1IdleDiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b13Throttle2IdleDiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b15Throttle3IdleDiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b17Throttle1TODiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b19Throttle2TODiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b21Throttle3TODiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b27ABManualExtendCmd1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b28ABManualExtendCmd2|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl100b29_18LhAileronPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl101b29_18RhAileronPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl102b29_18LhElevatorPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl103b29_18RhElevatorPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl104b29_18LhSpoilerPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl105b29_18RhSpoilerPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl106b29_18PrimaryRudderPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl120b29_18PilotPitchControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl121b29_18PilotRollControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl123b29_18CopilotPitchControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl124b29_18CopilotRollControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl110b29_18HorizontalStabilizerPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl111b29_18LhInboardFlapPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl112b29_18RhInboardFlapPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl113b29_18LhInboardFlapPosition2_1|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl114b29_18RhInboardFlapPosition2_2|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl115b29_18CombinedFlapPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl127b29_18AirbrakesLeverPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl240b29_11PitchElevatorTrimOrder|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b11LhOutboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b12RhOutboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b13LhMiddleSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b14RhMiddleSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b15LhInboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b16RhInboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b17LhOutboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b18RhOutboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b19LhMiddleSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b20RhMiddleSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b21LhInboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b22RhInboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b11APEngagementStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b12PfcsNoseLandingGearWOWStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b13PfcsLhMainLandingGearWOWStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b14PfcsRhMainLandingGearWOWStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic50msecA429Data\\lbl122b29_18PilotYawControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic50msecA429Data\\lbl125b29_18CopilotYawControlPosition|_ASCB_D\\MRC\\MRC1Cluster\\cat3Nav100msec\\cat3GsDev|_ASCB_D\\MRC\\MRC1Cluster\\cat3Nav100msec\\cat3LocDev|_ASCB_D\\PPDBL\\PPDBL1aA429\\ppdbl200msecA429Data\\lbl002b28_17PointOfRegulationVoltage|_ASCB_D\\PPDBL\\PPDBL1aA429\\ppdbl200msecA429Data\\lbl006b28_18LoadCurrent|_ASCB_D\\PPDBR\\PPDBR1aA429\\ppdbr200msecA429Data\\lbl002b28_17PointOfRegulationVoltage|_ASCB_D\\PPDBR\\PPDBR1aA429\\ppdbr200msecA429Data\\lbl006b28_18LoadCurrent|_ASCB_D\\RADALT\\RADALT1aA429\\radalt50msec429\\radioHeight|             Trigger|Part|                date|\n+-------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------+-------------------------------------+------------------------------------------+-------------------------------------------+------------------------------------------+-----------------------------------------+-----------------------------------------------+-----------------------------------------+-------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------+--------------------------------------------------------------------+-------------------------------------------+-----------------------------------------+--------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------------------+--------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------+---------------------------------------------+-------------------------------------------------+----------------------------------------------+--------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------+--------------------------------------------------+--------------------------------------------------+--------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------+--------------------------------------------------------+-----------------------------------------------+----------------------------------------------+------------------------------------------------+-----------------------------------------------+-----------------------------------------------+------------------------------------------------------+----------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------+-----------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+--------------------------------------------------------------------------------+------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------+--------------------+----+--------------------+\n|          497|                                                         9.33593|                                                             2.90416|                                                     -0.253028|                                                2.93554|                                          894.468|                                           967.5|                                                         9.85546|                                                             3.07582|                                                     -0.169257|                                                3.51171|                                          894.304|                                         967.296|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        3.625|                                                                                        0|                                                                             0|                                                                                       71|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.7656|                                                               88.5468|                                                   603.5|                                                               68.9687|                                                                        15.3437|                                                        15.0312|                                                       69.7812|                                                               88.4375|                                                     613|                                                               69.2031|                                                                        14.9687|                                                        14.5312|                                                       69.8437|                                                               88.6406|                                                   619.5|                                                                69.375|                                                                        15.8437|                                                        15.4062|                                           3|                                    1|                                       103|                                         13|                                   3.92355|                                0.0851453|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3097|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3134|                                                                        1737.53|                                                                            0|                                                                        0|                                                                        0|                                      3290.37|                                       51.195|                                      1.17367e-05|                                     -0.878391|                                       9.47185e-05|                                                                -155.994|                                                                    219.5|                                                                      4.04294|                                                                -200.625|                                                                 -89.375|                                                                          1587|                                       0.00522994|                                          0.133556|                                       -0.00680922|                                         -0.214843|                                       -0.0107421|                                       0.0214843|                                           0.0172996|                                                  1577.5|                                        6.62526|                                     0.0396537|                                        -153.746|                                       -89.4843|                                       -200.687|                                              -42.1689|                                       9.16699|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.162342|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                -0.0878906|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                          -0.3125|                                                                          -0.125|                                                                              -0.25|                                                                           -0.0625|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                    0.00600433|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                        -0.125|                                                                          -0.125|                                     -0.00439403|                                       0.00112289|                                                                             28.507|                                                               118.377|                                                                            28.4834|                                                               254.931|                                                3004.87|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          498|                                                         9.33593|                                                             2.88081|                                                      -0.28324|                                                2.95898|                                          894.359|                                         967.484|                                                         9.85546|                                                             3.04011|                                                     -0.266761|                                                3.48242|                                          894.218|                                         967.234|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        3.625|                                                                                        0|                                                                             0|                                                                                       72|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               1|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.7968|                                                               88.4687|                                                     604|                                                               69.0156|                                                                        15.3437|                                                        15.0312|                                                       69.7812|                                                               88.4375|                                                     613|                                                               69.2031|                                                                        14.9687|                                                        14.5625|                                                       69.8437|                                                               88.6406|                                                   619.5|                                                                69.375|                                                                        15.8125|                                                        15.4375|                                           3|                                    1|                                       103|                                         13|                                   3.92629|                                 0.079652|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3097|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3295.62|                                      51.1947|                                      0.000169569|                                     -0.878584|                                         0.0001347|                                                                -155.994|                                                                    219.5|                                                                      4.04294|                                                                -200.625|                                                                 -89.375|                                                                          1587|                                       0.00671004|                                          0.133251|                                       -0.00673293|                                         -0.242187|                                       -0.0507812|                                       0.0268554|                                           0.0182609|                                                 1578.12|                                        6.60672|                                     0.0382804|                                        -153.744|                                          -89.5|                                       -200.718|                                              -41.5242|                                       9.20996|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.128165|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                -0.0878906|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                          -0.0625|                                                                         -0.0625|                                                                             -0.125|                                                                             0.125|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                    0.00576019|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                        -0.125|                                                                          -0.125|                                      -0.0313438|                                      -0.00571221|                                                                             28.507|                                                                116.16|                                                                            28.4834|                                                               254.488|                                                3004.87|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          499|                                                         9.33593|                                                             2.78056|                                                     -0.307959|                                                2.95898|                                          894.367|                                         967.601|                                                          9.7832|                                                             3.02775|                                                     -0.268134|                                                 3.4746|                                          894.179|                                         966.875|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        4.875|                                                                                        0|                                                                             0|                                                                                       72|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3142|                                                                             14.8032|                                                                     0|                                                       69.7968|                                                               88.4687|                                                     604|                                                               69.0156|                                                                        15.3437|                                                        15.0625|                                                       69.7968|                                                               88.4687|                                                     613|                                                               69.1875|                                                                        14.9687|                                                        14.5625|                                                       69.9062|                                                               88.4687|                                                     620|                                                               69.4062|                                                                        15.8125|                                                        15.4687|                                           3|                                    1|                                       103|                                         13|                                   3.91531|                                 0.079652|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3097|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3295.62|                                      51.1947|                                      0.000169569|                                     -0.878584|                                         0.0001347|                                                                -155.994|                                                                    219.5|                                                                      4.04294|                                                                -200.625|                                                                 -89.375|                                                                          1589|                                       0.00231551|                                           0.13055|                                        -0.0159034|                                         -0.232421|                                         0.189941|                                       0.0205078|                                           0.0151481|                                                 1578.12|                                         6.5923|                                     0.0396537|                                        -153.742|                                       -89.5156|                                       -200.734|                                              -41.8895|                                       9.18652|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                               0.0939873|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                -0.0878906|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                           -0.125|                                                                         -0.0625|                                                                             -0.125|                                                                             0.125|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                    0.00576019|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                        -0.125|                                                                           -0.25|                                      -0.0606371|                                       -0.0115708|                                                                             28.507|                                                                116.16|                                                                            28.4834|                                                               254.488|                                                3028.62|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          500|                                                         9.33593|                                                             2.70091|                                                     -0.292853|                                                2.95898|                                          894.156|                                         967.117|                                                          9.7832|                                                             2.87532|                                                     -0.257148|                                                 3.4746|                                          893.984|                                         966.804|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        4.875|                                                                                        0|                                                                             0|                                                                                       73|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             79|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.8437|                                                               88.4687|                                                     604|                                                               69.0468|                                                                         15.375|                                                        15.0625|                                                       69.8125|                                                               88.4218|                                                   613.5|                                                               69.2187|                                                                         14.875|                                                        14.5937|                                                       69.9687|                                                               88.5156|                                                     620|                                                               69.4687|                                                                        15.7812|                                                           15.5|                                           3|                                    1|                                       103|                                         13|                                   3.92629|                                0.0741588|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3096|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3300.87|                                      51.1945|                                      0.000155655|                                     -0.878584|                                       3.10329e-06|                                                                -155.989|                                                                  219.625|                                                                      4.08688|                                                                 -200.75|                                                                 -89.375|                                                                          1590|                                        0.0134696|                                          0.132533|                                        -0.0346412|                                         -0.219726|                                         0.163574|                                      -0.0146484|                                           0.0147514|                                                 1572.62|                                        6.55316|                                     0.0767325|                                         -153.74|                                       -89.5468|                                       -200.781|                                              -44.2804|                                       9.04296|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.128165|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                 -0.175781|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                           -0.125|                                                                         -0.0625|                                                                            -0.0625|                                                                            0.0625|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                     0.0097351|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                         -0.25|                                                                           -0.25|                                      -0.0805566|                                      -0.00961798|                                                                             28.507|                                                               111.726|                                                                            28.4834|                                                               258.035|                                                 3055.5|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          501|                                                         9.33593|                                                             2.77644|                                                     -0.294227|                                                 2.9414|                                          894.093|                                         967.062|                                                          9.7832|                                                             2.93712|                                                     -0.237922|                                                3.47851|                                          893.929|                                         966.726|                                                                    34|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                       35.25|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        4.875|                                                                                        0|                                                                             0|                                                                                       73|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.8593|                                                               88.4375|                                                   603.5|                                                               69.0625|                                                                         15.375|                                                        15.0937|                                                       69.8125|                                                               88.4218|                                                   613.5|                                                               69.2187|                                                                         14.875|                                                        14.5937|                                                       69.9687|                                                               88.5156|                                                     620|                                                               69.4687|                                                                        15.7812|                                                           15.5|                                           3|                                    1|                                       103|                                         13|                                   3.92629|                                0.0686656|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2328|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2249|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3096|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3300.87|                                      51.1945|                                      0.000155655|                                     -0.878584|                                       3.10329e-06|                                                                -155.989|                                                                  219.625|                                                                      4.08688|                                                                 -200.75|                                                                 -89.375|                                                                          1590|                                       0.00211715|                                          0.133815|                                        -0.0263099|                                         -0.138671|                                        0.0830078|                                      -0.0292968|                                            0.020153|                                                  1569.5|                                        6.53874|                                     0.0870322|                                        -153.739|                                       -89.5625|                                       -200.812|                                              -43.7255|                                       9.07617|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.128165|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                 -0.175781|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                          -0.0625|                                                                         -0.0625|                                                                             -0.125|                                                                            0.0625|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                     0.0097351|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                         -0.25|                                                                           -0.25|                                      -0.0805566|                                      -0.00629807|                                                                             28.507|                                                               111.726|                                                                            28.4834|                                                               258.035|                                                 3055.5|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 102400 bytes. Learn more about <strong>ZEPPELIN_INTERPRETER_OUTPUT_LIMIT</strong></div>"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0934<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/</a>"}]},"apps":[],"jobName":"paragraph_1693322783316_-1977482227","id":"20230126-152839_1972018152","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%pyspark\ndf.write.parquet(\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet\")","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"An error occurred while calling o83305.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\nTraceback (most recent call last):\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/readwriter.py\", line 804, in parquet\n    self._jwrite.parquet(path)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/protocol.py\", line 320, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o83305.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\n\n"}]},"apps":[],"jobName":"paragraph_1693322783330_-1993641681","id":"20230126-152912_1271219367","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%pyspark\nimport sys\nfrom pyspark import SparkContext, SparkConf\nimport pyspark.sql.functions as F\nfrom pyspark.sql import SparkSession \nfrom pyspark.sql.functions import pandas_udf, to_date, to_timestamp, substring, expr\nfrom pyspark.sql.types import StructType, StructField, IntegerType, StringType, FloatType, DateType, BooleanType, DoubleType, TimestampType, ArrayType, BinaryType\nfrom pyspark.sql.window import Window\nimport pandas as pd\nfrom datetime import datetime, timedelta\nimport subprocess, re\nimport os\nimport dateutil.parser as dparser","user":"e854129","dateUpdated":"2023-08-31T09:38:18+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1959<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1959/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1959/</a>"}]},"apps":[],"jobName":"paragraph_1693322783342_-1998258668","id":"20230126-153011_133686435","dateCreated":"2023-08-29T17:26:23+0200","dateStarted":"2023-08-31T09:38:18+0200","dateFinished":"2023-08-31T09:38:19+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%pyspark\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\n\ndef verify_file_extension(file_path, desired_extension):\n\t_, file_extension = os.path.splitext(file_path)\n\treturn file_extension.lower() == '.' + desired_extension.lower()\n\ndef extract_filenames_from_path_list(path_list):\n\tfilenames = [os.path.basename(path) for path in path_list]\n\treturn filenames\n\ndef identify_file_or_folder(path):\n\tif os.path.isfile(path):\n\t\treturn \"File\"\n\telif os.path.isdir(path):\n\t\treturn \"Folder\"\n\telse:\n\t\treturn \"Neither\"\n\ndef identify_extension(file_path):\n\t_, extension = os.path.splitext(file_path)\n\treturn extension.lower() if extension else None\n\ndef extract_filename_with_extension(file_path):\n\treturn os.path.basename(file_path)\n\ndef extract_filename_without_extension(file_path):\n\tfilename_with_extension = os.path.basename(file_path)\n\tfilename_without_extension, _ = os.path.splitext(filename_with_extension)\n\treturn filename_without_extension\n\n#def validate_file_path(file_path, desired_extension):\n\n\n#extraction du nom du fichier a partir du chemin complet\ndef extract_name(path):\n\tfor i in range (1, len(path)):\n\t\tif path[-i]=='/':\n\t\t\treturn (path[len(path)-i+1:])\n\n# prend en entree une liste de noms de fichiers et renvoie 2 liste : une avec la premiere moitie du nom, l'autre avec la deuxieme moitie\ndef divide_name(file_name_list):\n\tlist_first_half = []\n\tlist_second_half = []\n\t\n\tfor numero_fichier in range (0, len(file_name_list)):\n\t\tfor i in range (1, len(file_name_list[numero_fichier])):\n\t\t\tif file_name_list[numero_fichier][-i]=='_':\n\t\t\t\tlist_second_half.append(file_name_list[numero_fichier][len(file_name_list[numero_fichier])-i+1:])\n\t\t\t\tlist_first_half.append(file_name_list[numero_fichier][:len(file_name_list[numero_fichier])-i+1])\n\t\t\t\tbreak\n\t\t\t\t\n\treturn list_first_half, list_second_half\n\ndef list_sub_folder_adress(path):\n\tList_Sub_Folders_Adress = []\n\tfor dossier in path:\n\t\tnouveaux_dossiers = listdir(dossier)\n\t\tfor sous_dossier in nouveaux_dossiers:\n\t\t\tList_Sub_Folders_Adress.append(sous_dossier)\n\treturn List_Sub_Folders_Adress\n\n# Fonction permettant a partir d'une adresse de recuperer la liste des sous-dossiers qu'elle contient. Level represente le niveau des sous dossiers, 0 = l'adresse, 1 = les sous dossier, 2 = les sous sous dossiers... \ndef list_sub_folder_adress_rec(path_string, level):\n\tList_Sub_Folders_Adress = []\n\tif level<=0:\n\t\tList_Sub_Folders_Adress.append(path_string)\n\tif level==1:\n\t\tList_Sub_Folders_Adress = listdir(path_string)\n\telse:\n\t\tinit_folder = listdir(path_string)\n\t\tfor i in range (1, level):\n\t\t\tnew_folder = list_sub_folder_adress(init_folder)\n\t\t\tinit_folder = new_folder\n\t\tfor new_adress in init_folder:\n\t\t\tList_Sub_Folders_Adress.append(new_adress)\n\treturn List_Sub_Folders_Adress\n\n\ndef files_detected_in_New_raw_files_Dir(New_raw_files_folder_path):\n\t# level 1 investigate 1 level of subfolder and get the files\n\tNumber_of_subFolder_levels = 1\n\tList_of_new_files = list_sub_folder_adress_rec(New_raw_files_folder_path,  Number_of_subFolder_levels)\n\tNumber_of_new_files_detected = len(List_of_new_files)\n\treturn List_of_new_files\n\ndef strip_non_numeric_char_from_string(my_string):\n\tnon_numeric_string = re.sub(\"[^0-9]\", \"\", my_string)\n\treturn non_numeric_string\n\ndef get_date_from_ACMF_csv_file(path):\n\tfile_name = extract_name(path)\n\tfile_name_ending = file_name.split('_')[-1]\n\tfile_writing_date = dparser.parse(file_name_ending,fuzzy=True, dayfirst=False, yearfirst=True)\n\treturn file_writing_date\n\t\ndef get_date_as_numeric_string_from_ACMF_csv_file(file_name):\n\tfile_date = get_date_from_ACMF_csv_file(file_name)\n\tfile_date_as_numeric_string = strip_non_numeric_char_from_string(str(file_date))\n\treturn file_date_as_numeric_string\n\ndef get_aircraft_complete_ID_from_file_name(file_name):\n\tcomplete_ID = file_name.split('_')[-2]\n\treturn complete_ID\n\ndef get_aircraft_SN_only_digits_from_file_name(file_name):\n\tcomplete_ID = get_aircraft_complete_ID_from_file_name(file_name)\n\tSN_only_digits = complete_ID[-3:]\n\treturn SN_only_digits\n\ndef get_aircraft_SN_complete_from_file_name(file_name):\n\tSN_only_digits = get_aircraft_SN_only_digits_from_file_name(file_name)\n\tSN_only_complete = \"SN\" + SN_only_digits\n\treturn SN_only_complete\n\ndef get_aircraft_Model_ID_from_file_name(file_name):\n\tcomplete_ID = get_aircraft_complete_ID_from_file_name(file_name)\n\tModel_ID = complete_ID[:4]\n\treturn Model_ID\n\ndef get_date_from_ACMF_csv_file_name(file_name):\n\tfile_name_ending = file_name.split('_')[-1]\n\tfile_date_in_file_name = dparser.parse(file_name_ending,fuzzy=True, dayfirst=False, yearfirst=True)\n\treturn file_date_in_file_name\n\ndef get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name):\n\tfile_date = get_date_from_ACMF_csv_file_name(file_name)\n\tfile_date_as_numeric_string = strip_non_numeric_char_from_string(str(file_date))\n\treturn file_date_as_numeric_string\n\ndef get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name):\n\tfile_date_as_numeric_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name)\n\traw_file_date_year_string = \"Year_\" +  file_date_as_numeric_string[0:4]\n\traw_file_date_month_string = \"Month_\" +  file_date_as_numeric_string[4:6]\n\traw_file_date_day_string = \"Day_\" +  file_date_as_numeric_string[6:8]\n\treturn raw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string\n\ndef old_version_create_basic_log_df(file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder = False, copy_to_raw_dated_folder = False, valid_file_name = False, Flight_file_name = \"None\"):\n\tfields = [StructField(\"file_name_no_extension\", StringType(),False),\n\t  StructField(\"File_name_with_extension\", StringType(),False),\n\t  StructField(\"File_type\", StringType(),False),\n\t  StructField(\"File_date_as_TimestampType\", TimestampType(),False),\n\t  StructField(\"File_SN\", StringType(),False),\n\t  StructField(\"File_aircraft_model\", StringType(),False),\n\t  StructField(\"Raw_file_legacy_folder_path\", StringType(),False),\n\t  StructField(\"Raw_file_dated_folder_path\", StringType(),False),\n\t  StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),False),\n\t  StructField(\"Raw_file_dated_folder_copied\", BooleanType(),False),\n\t  StructField(\"Valid_file_name\", BooleanType(),False),\n\t  StructField(\"Flight_file_name\", StringType(),False),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder, copy_to_raw_dated_folder, valid_file_name, Flight_file_name]]\n\n\tdf = spark.createDataFrame(data, schema)\n\treturn df\n\ndef create_basic_log_df(file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder = False, copy_to_raw_dated_folder = False, valid_file_name = None, Flight_file_name = None):\n\tfields = [StructField(\"file_name_no_extension\", StringType(),True),\n\t  StructField(\"File_name_with_extension\", StringType(),True),\n\t  StructField(\"File_type\", StringType(),True),\n\t  StructField(\"File_date_as_TimestampType\", TimestampType(),True),\n\t  StructField(\"File_SN\", StringType(),True),\n\t  StructField(\"File_aircraft_model\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_dated_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),True),\n\t  StructField(\"Raw_file_dated_folder_copied\", BooleanType(),True),\n\t  StructField(\"Valid_file_name\", BooleanType(),True),\n\t  StructField(\"Flight_file_name\", StringType(),True),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder, copy_to_raw_dated_folder, valid_file_name, Flight_file_name]]\n\n\tdf = spark.createDataFrame(data, schema)\n\t# Add a column with the curreent_timestamp to trace the date of the last modification\n\tdf = df.withColumn(\"Update_Date\", F.current_timestamp()) \n\treturn df\n\n##################################################################\n# Call this function for a single SN subfolder\ndef log_files_in_New_raw_files(New_raw_files_Dir_path, Log_files_Folder_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_with_extension = extract_filename_with_extension(new_raw_file_path)\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\tfile_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension)\n\t\t\tfile_aircraft_model = get_aircraft_Model_ID_from_file_name(file_name_without_extension)\n\t\t\tfile_date_as_dateTime = get_date_from_ACMF_csv_file_name(file_name_without_extension)\n\t\t\tfile_date_as_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\traw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string = get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\tcopy_to_legacy_folder_path = legacy_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + file_name_with_extension\n\t\t\tcopy_to_dated_folder_path = dated_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + raw_file_date_year_string + \"/\" + raw_file_date_month_string + \"/\" + raw_file_date_day_string + \"/\" + file_name_with_extension\n\t\t\t# Create a log df with the previous informations\n\t\t\tlog_df = create_basic_log_df(file_name_without_extension, file_name_with_extension,file_date_as_dateTime, file_SN, file_aircraft_model, copy_to_legacy_folder_path, copy_to_dated_folder_path)\n\t\t\t# save the df\n\t\t\tlog_file_name = \"Log_Row_ACMF_\" + file_name_without_extension + \".csv\"\n\t\t\tlog_file_save_path = Log_files_Folder_path + \"/\" + log_file_name\n\t\t\tlog_df.coalesce(1).write.mode(\"overwrite\").csv(log_file_save_path)\n\ndef parquet_log_files_in_New_raw_files(New_raw_files_Dir_path, Log_files_Folder_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_with_extension = extract_filename_with_extension(new_raw_file_path)\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\tfile_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension)\n\t\t\tfile_aircraft_model = get_aircraft_Model_ID_from_file_name(file_name_without_extension)\n\t\t\tfile_date_as_dateTime = get_date_from_ACMF_csv_file_name(file_name_without_extension)\n\t\t\tfile_date_as_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\traw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string = get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\tcopy_to_legacy_folder_path = legacy_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + file_name_with_extension\n\t\t\tcopy_to_dated_folder_path = dated_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + raw_file_date_year_string + \"/\" + raw_file_date_month_string + \"/\" + raw_file_date_day_string + \"/\" + file_name_with_extension\n\t\t\t# Create a log df with the previous informations\n\t\t\tlog_df = create_basic_log_df(file_name_without_extension, file_name_with_extension,file_date_as_dateTime, file_SN, file_aircraft_model, copy_to_legacy_folder_path, copy_to_dated_folder_path)\n\t\t\t# save the df\n\t\t\tlog_file_name = \"Log_Row_ACMF_\" + file_name_without_extension + \".parquet\"\n\t\t\tlog_file_save_path = Log_files_Folder_path + \"/\" + log_file_name\n\t\t\tlog_df.write.mode(\"overwrite\").parquet(log_file_save_path)\n\n\ndef write_Log_Files(log_df, File_name_without_extension, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\", Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    log_files_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_files_Archive_name\n    # We write the log twice\n    # The file writen in the Index folder only have the most recent date -> use overwrite mode\n    log_df.write.mode(\"overwrite\").parquet(Log_files_Index_complete_path)\n    # The file writen in the archive folder keep trace of all changes -> use append mode\n    log_df.write.mode(\"append\").parquet(Log_files_Archive_complete_path)\n\ndef read_Log_file_index_from_file_name(File_name_without_extension, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\"):\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    \n    #fields = [StructField(\"file_name_no_extension\", StringType(),True), StructField(\"File_name_with_extension\", StringType(),True), StructField(\"File_type\", StringType(),True), StructField(\"File_date_as_TimestampType\", TimestampType(),True), StructField(\"File_SN\", StringType(),True), StructField(\"File_aircraft_model\", StringType(),True), StructField(\"Raw_file_legacy_folder_path\", StringType(),True), StructField(\"Raw_file_dated_folder_path\", StringType(),True), StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),True), StructField(\"Raw_file_dated_folder_copied\", BooleanType(),True),  StructField(\"Valid_file_name\", BooleanType(),True), StructField(\"Flight_file_name\", StringType(),True)]\n    #custom_schema = StructType(fields)\n\t\n    #df = spark.read.schema(custom_schema).parquet(Log_files_Index_complete_path)\n    df = spark.read.parquet(Log_files_Index_complete_path)\n    return df\n\ndef read_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    log_file_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_file_Archive_name\n\t\n    #df = spark.read.schema(custom_schema).parquet(Log_files_Index_complete_path)\n    df = spark.read.parquet(Log_files_Archive_complete_path)\n    #df = df.sort(\"Update_Date\")\n    sorted_df = df.orderBy(F.col(\"Update_Date\").desc())\n    return sorted_df\n    \ndef read_latest_update_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    sorted_bydate_log_df = read_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path)\n    # Step 3: Select the a single row, with the latest updated data\n    latest_update_df = sorted_bydate_log_df.limit(1)\n    return latest_update_df\n\ndef get_Log_file_index_parameters_from_file_name(File_name_without_extension, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\"):\n    df = read_Log_file_index_from_file_name(File_name_without_extension, Log_file_index_dir_path)\n    # Log_ACMF_Index file are supposed to always have a single row\n    row = df.first()\n    # Extract columns as parameters\n    parameters_dict = row.asDict()\n    return parameters_dict\n\t\ndef update_Log_df_with_new_value(log_df, column_name_string, new_value):\n    #updated_df = log_df.withColumn(column_name_string, when(col(column_name_string).isNotNull, col(column_name_string)).otherwise(lit(null)))\n    updated_df = log_df.withColumn(column_name_string, F.lit(new_value))\n    return updated_df\n    \ndef old_version_update_both_log_files(File_name_without_extension, new_values_per_column_dict, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\", Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    # Read the old df (the values in need of update)\n    old_log_df = read_Log_file_index_from_file_name(File_name_without_extension, Log_file_index_dir_path)\n    # Update the old_log_df by looping through the new values dictionary\n    new_log_df = old_log_df\n    for column_name  in new_values_per_column_dict.keys():\n        new_log_df = update_Log_df_with_new_value(new_log_df, column_name, new_values_per_column_dict[column_name])\n    # Update the result in the Update_Date column\n    new_log_df = new_log_df.withColumn(\"Update_Date\", F.current_timestamp())\n    # The path where to write the files\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    log_files_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_files_Archive_name\n    # We write the log twice\n    # The file writen in the Index folder only have the most recent date use overwrite mode\n    new_log_df.write.mode(\"overwrite\").parquet(Log_files_Index_complete_path)\n    # The file writen in the archive folder keep trace of all changes use append mode\n    new_log_df.write.mode(\"append\").parquet(Log_files_Archive_complete_path)\n\ndef update_both_log_files(File_name_without_extension, new_values_per_column_dict, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\", Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    # Read the previously most recent row of date from the archive as a new \n    old_log_df = read_latest_update_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path)\n    # Update the old_log_df by looping through the new values dictionary\n    new_log_df = old_log_df\n    for column_name  in new_values_per_column_dict.keys():\n        new_log_df = update_Log_df_with_new_value(new_log_df, column_name, new_values_per_column_dict[column_name])\n    # Update the result in the Update_Date column\n    new_log_df = new_log_df.withColumn(\"Update_Date\", F.current_timestamp())\n    # The path where to write the files\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    log_files_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_files_Archive_name\n    # We write the log twice\n    # The file writen in the Index folder only have the most recent date use overwrite mode\n    new_log_df.write.mode(\"overwrite\").parquet(Log_files_Index_complete_path)\n    # The file writen in the archive folder keep trace of all changes use append mode\n    new_log_df.write.mode(\"append\").parquet(Log_files_Archive_complete_path)\n\ndef initiate_log_files_from_New_raw_files(New_raw_files_Dir_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_with_extension = extract_filename_with_extension(new_raw_file_path)\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\tfile_type = \"Raw\"\n\t\t\tfile_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension)\n\t\t\tfile_aircraft_model = get_aircraft_Model_ID_from_file_name(file_name_without_extension)\n\t\t\tfile_date_as_dateTime = get_date_from_ACMF_csv_file_name(file_name_without_extension)\n\t\t\tfile_date_as_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\traw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string = get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\tRaw_file_legacy_folder_path = legacy_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + file_name_with_extension\n\t\t\tRaw_file_dated_folder_path = dated_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + raw_file_date_year_string + \"/\" + raw_file_date_month_string + \"/\" + raw_file_date_day_string + \"/\" + file_name_with_extension\n\t\t\t# Create a log df with the previous informations\n\t\t\tlog_df = create_basic_log_df(file_name_without_extension, file_name_with_extension, file_type, file_date_as_dateTime, file_SN, file_aircraft_model, Raw_file_legacy_folder_path, Raw_file_dated_folder_path)\n\t\t\t# save the df\n\t\t\twrite_Log_Files(log_df, file_name_without_extension)\n\n#def copy_new_raw_file_into_appropriate_folders(New_raw_files_Dir_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\ndef copy_new_raw_file_into_appropriate_folders(New_raw_files_Dir_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\t# The default values to update if the copy fail\n\t\t\tupdated_log_values_dict = {\"Raw_file_legacy_folder_copied\":False, \"Raw_file_dated_folder_copied\":False}\n\t\t\table_to_read_file_to_copy = False\n\t\t\ttry:\n\t\t\t    # Read the df to copy\n\t\t\t    df_to_copy = spark.read.csv(new_raw_file_path)\n\t\t\t    able_to_read_file_to_copy = True\n\t\t\texcept (IOError, ValueError) as Error_1_copy_new_raw_file_into_appropriate_folders:\n\t\t\t    able_to_read_file_to_copy = False\n\t\t\t#If the raw file could be red\n\t\t\tif able_to_read_file_to_copy:\n\t\t\t    log_file_infos_dict = get_Log_file_index_parameters_from_file_name(file_name_without_extension)\n\t\t\t    Raw_file_legacy_folder_path = log_file_infos_dict[\"Raw_file_legacy_folder_path\"]\n\t\t\t    Raw_file_dated_folder_path = log_file_infos_dict[\"Raw_file_dated_folder_path\"]\n\t\t\t    # Try writting the first copy\n\t\t\t    try:\n\t\t\t        df_to_copy.write.mode(\"ignore\").csv(Raw_file_legacy_folder_path)\n\t\t\t        updated_log_values_dict[\"Raw_file_legacy_folder_copied\"] = True\n\t\t\t    except (IOError, ValueError) as Error_2_copy_new_raw_file_into_appropriate_folders:\n\t\t\t        updated_log_values_dict[\"Raw_file_legacy_folder_copied\"] = False\n\t\t\t    # Try writting the second copy\n\t\t\t    try:\n\t\t\t        df_to_copy.write.mode(\"ignore\").csv(Raw_file_dated_folder_path)\n\t\t\t        updated_log_values_dict[\"Raw_file_dated_folder_copied\"] = True\n\t\t\t    except (IOError, ValueError) as Error_2_copy_new_raw_file_into_appropriate_folders:\n\t\t\t        updated_log_values_dict[\"Raw_file_dated_folder_copied\"] = False\n\t\t\t#Update both log files using the updated_log_values_dict\n\t\t\tupdate_both_log_files(file_name_without_extension, updated_log_values_dict)\n\t\t\t\ndef read_all_index_log_files_as_a_single_df(Log_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"):\n    index_log_file_df = spark.read.parquet(Log_files_Index_Dir_path)\n    return index_log_file_df\n\ndef read_all_archive_log_files_as_a_single_df(Log_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/*\"):\n    archive_log_file_df = spark.read.parquet(Log_files_Archive_Dir_path)\n    return archive_log_file_df","user":"e854129","dateUpdated":"2023-08-31T09:38:25+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1959<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1959/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1959/</a>"}]},"apps":[],"jobName":"paragraph_1693322783354_-1990563690","id":"20230825-153528_520502784","dateCreated":"2023-08-29T17:26:23+0200","dateStarted":"2023-08-31T09:38:25+0200","dateFinished":"2023-08-31T09:38:26+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"title":"STEP 1 : Initialise the log files for the test path","text":"%pyspark\n\n# Searching for newlly uploaded  files in the New_raw_files folder\nNew_raw_files_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/New_raw_files\"\nLog_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\"\nLog_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"\n\n#legacy_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/fichier_brut\"\nlegacy_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut\"\n#dated_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/fichier_brut_par_mois\"\ndated_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois\"\n\ninitiate_log_files_from_New_raw_files(New_raw_files_Dir_path, legacy_fichier_brut_Dir_path, dated_fichier_brut_Dir_path)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783366_-1908996923","id":"20230828-105703_1081172253","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"title":"STEP 2 : Copy raw file from New_raw_files_Dir and update the logs","text":"%pyspark\ncopy_new_raw_file_into_appropriate_folders(New_raw_files_Dir_path)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783378_-1901301945","id":"20230829-132800_206700600","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"title":"Read all log files from a folder (example all index Log files)","text":"%pyspark\n# If you read from the Index folder you will not be to overwrite files in the index folder\nLog_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"\nLog_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/*\"\n\nLog_file_df = spark.read.parquet(Log_files_Archive_Dir_path)\n\nLog_file_df.show(40, truncate=30)","dateUpdated":"2023-08-31T09:41:50+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------+------------------------------+---------+--------------------------+-------+-------------------+------------------------------+------------------------------+-----------------------------+----------------------------+---------------+----------------+-----------------------+\n|        file_name_no_extension|      File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|   Raw_file_legacy_folder_path|    Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|            Update_Date|\n+------------------------------+------------------------------+---------+--------------------------+-------+-------------------+------------------------------+------------------------------+-----------------------------+----------------------------+---------------+----------------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:43:12|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:13.284|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-26 22:32:54|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:41.673|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:12:09|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:23.504|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:39:21|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|  2023-08-29 09:44:32.9|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-26 22:38:00|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:43.369|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:50:00|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:15.659|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:07:03|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:21.741|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:46:35|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:14.502|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:29:08|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:29.316|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:58:33|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:18.613|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:26:12|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:06.554|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:41:04|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:33.792|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:53:25|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:16.859|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-26 22:27:48|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:39.836|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:44:28|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:34.957|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:54:39|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:38.606|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:13:51|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:24.093|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:25:44|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:28.092|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:31:18|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null| 2023-08-29 09:44:08.36|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:27:54|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:07.157|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:48:17|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:15.104|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-26 22:39:42|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:43.932|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:49:34|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:36.743|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:42:46|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:34.347|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:41:30|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:12.715|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:46:10|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null| 2023-08-29 09:44:35.53|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:35:56|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:31.639|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:22:48|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:05.387|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:38:06|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:11.288|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:14:19|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:02.385|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-26 22:41:23|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|  2023-08-29 09:44:44.5|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:21:06|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:04.815|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:16:01|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:02.934|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-26 22:43:05|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:45.314|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:52:57|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:37.888|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:17:15|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null| 2023-08-29 09:44:25.22|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:10:27|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null| 2023-08-29 09:44:22.91|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 12:36:24|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:10.649|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:00:15|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:19.179|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|      Raw|       2023-06-25 13:34:14|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                        false|                       false|           null|            null|2023-08-29 09:44:31.026|\n+------------------------------+------------------------------+---------+--------------------------+-------+-------------------+------------------------------+------------------------------+-----------------------------+----------------------------+---------------+----------------+-----------------------+\nonly showing top 40 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783390_-1905918932","id":"20230828-120212_1557945957","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"title":"Collect a single row from a df","text":"%pyspark\nprint(Log_file_df.collect()[0])","dateUpdated":"2023-08-29T17:26:23+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(file_name_no_extension='TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t', File_name_with_extension='TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', File_type='Raw', File_date_as_TimestampType=datetime.datetime(2023, 6, 25, 12, 43, 12), File_SN='SN449', File_aircraft_model='0580', Raw_file_legacy_folder_path='/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', Raw_file_dated_folder_path='/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Year_2023/Month_06/Day_25/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', Raw_file_legacy_folder_copied=False, Raw_file_dated_folder_copied=False, Valid_file_name=None, Flight_file_name=None, Update_Date=datetime.datetime(2023, 8, 29, 9, 44, 13, 284000))"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783401_-1924002130","id":"20230825-172220_468880430","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:72"},{"title":"Read most recent row of archive log from a specific file name","text":"%pyspark\nfile_name_searched = \"MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t\"\n\nlatest_update_Log_file_archive_df = read_latest_update_Log_file_archive_from_file_name(file_name_searched)\nlatest_update_Log_file_archive_df.show(40, truncate=16)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|     Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                         true|                        true|           null|            null|2023-08-29 13...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783413_-1916307152","id":"20230829-102244_471524309","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"title":"Read all rows of archive log from a specific file name","text":"%pyspark\nall_rows_from_Log_file_archive_df = read_Log_file_archive_from_file_name(file_name_searched)\nall_rows_from_Log_file_archive_df.show(40, truncate=16)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|     Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                         true|                        true|           null|            null|2023-08-29 13...|\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                        false|                       false|           null|            null|2023-08-29 13...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783426_-1932081857","id":"20230829-110249_169456362","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"title":"Read single row of index log from a specific file name","text":"%pyspark\nall_rows_from_Log_file_index_df = read_Log_file_index_from_file_name(file_name_searched)\nall_rows_from_Log_file_index_df.show(40, truncate=16)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|     Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                         true|                        true|           null|            null|2023-08-29 13...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783437_-1937853091","id":"20230829-110155_791683872","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"title":"STEP 3 : Serching for new flight","text":"%pyspark\n","dateUpdated":"2023-08-29T17:26:23+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693322783449_-1930158113","id":"20230829-110415_2127427821","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"text":"%pyspark\n\nindex_log_file_df = read_all_index_log_files_as_a_single_df(Log_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\")\nindex_log_file_df.show(40, truncate=15)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\nonly showing top 40 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783461_-1947087064","id":"20230829-140230_667761558","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"text":"%pyspark\ndef find_raw_files_potentially_sharing_same_flight(file_name_without_extension_to_analyse, Log_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"):\n    # First select all the data that will be used to query the index and reduce the number of potential files\n    reference_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension_to_analyse)\n    reference_date = get_date_from_ACMF_csv_file_name(file_name_without_extension_to_analyse)\n    reference_file_type = \"Raw\"\n    # 2nd read the df of all the log index file\n    index_log_file_df = read_all_index_log_files_as_a_single_df(Log_files_Index_Dir_path)\n    ","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693322783473_-1939392086","id":"20230829-141203_850536041","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"text":"%pyspark\ndef are_raw_files_part_of_same_flight(index_log_file_df):\n    ","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693322783484_-1943624324","id":"20230829-140634_215606381","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"text":"%pyspark\n \n#file_name_without_extension_to_analyse = \"MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133349t\"\nfile_name_without_extension_to_analyse = \"TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t\"\nLog_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"\n\n# First select all the data that will be used to query the index and reduce the number of potential files\nreference_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension_to_analyse)\nreference_date = get_date_from_ACMF_csv_file_name(file_name_without_extension_to_analyse)\nreference_file_type = \"Raw\"\n# 2nd read the df of all the log index file\nindex_log_file_df = read_all_index_log_files_as_a_single_df(Log_files_Index_Dir_path)\n\nprint(\"reference_SN = \", reference_SN)\nprint(\"reference_date = \", reference_date)\nprint(\"reference_file_type = \", reference_file_type)\n#print(\" = \", )\nindex_log_file_df.show(40, truncate=15)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reference_SN =  SN449\nreference_date =  2023-06-25 12:16:01\nreference_file_type =  Raw\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\nonly showing top 40 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783496_-1862057557","id":"20230829-144521_1853266930","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"text":"%pyspark\nindex_log_file_df.count()","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"108"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783508_-1854362579","id":"20230829-144848_202303383","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:81"},{"text":"%pyspark\n#index_log_file_filtered_df = index_log_file_df.filter((index_log_file_df.File_SN == reference_SN) & (index_log_file_df.File_type == reference_file_type) & (index_log_file_df.File_date_as_TimestampType == reference_date))\nindex_log_file_filtered_df = index_log_file_df.filter((index_log_file_df.File_SN == reference_SN) & (index_log_file_df.File_type == reference_file_type))\nindex_log_file_filtered_df.show(40, truncate=15)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\nonly showing top 40 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783519_-1857055822","id":"20230829-144939_582386344","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:82"},{"text":"%pyspark\nindex_log_file_filtered_df.count()","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"108"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783531_-1873984773","id":"20230829-164802_1548443611","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:83"},{"text":"%pyspark\ndef filter_df_with_stable_deltaT(index_log_file_prefiltered_df, date_selected, chosen_time_delta_in_seconds = 220):\n    deltaT = timedelta(seconds = chosen_time_delta_in_seconds)\n    initial_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= date_selected - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= date_selected + deltaT)\n    initial_date_filtered_df = index_log_file_prefiltered_df.filter(initial_date_filter_expression)\n    return initial_date_filtered_df\n    ","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783543_-1866289795","id":"20230829-145759_760084038","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:84"},{"text":"%pyspark\nchosen_time_delta_in_sec = 220\n\nfirst_date_filter_df = filter_df_with_stable_deltaT(index_log_file_filtered_df, reference_date, chosen_time_delta_in_sec)\nfirst_date_filter_df.show(40, truncate=15)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783555_-1883218747","id":"20230829-152817_1119657502","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:85"},{"text":"%pyspark\nchosen_time_delta_in_seconds = 220\ndeltaT = timedelta(seconds = chosen_time_delta_in_seconds)\nprint(deltaT)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"0:03:40"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783567_-1887835734","id":"20230829-153000_1557332734","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"text":"%pyspark\ndef filter_df_with_moving_deltaT(index_log_file_prefiltered_df, date_selected, chosen_time_delta_in_seconds = 220):\n    deltaT = timedelta(seconds = chosen_time_delta_in_seconds)\n    initial_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= date_selected - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= date_selected + deltaT)\n    initial_date_filtered_df = index_log_file_prefiltered_df.filter(initial_date_filter_expression)\n    \n    new_minimum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"min\"}).collect()[0][0]\n    new_maximum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"max\"}).collect()[0][0]\n    \n    new_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= new_minimum_date_value - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= new_maximum_date_value + deltaT)\n    new_rows_df = index_log_file_prefiltered_df.filter(new_date_filter_expression)\n    return new_rows_df","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783579_-1880140756","id":"20230829-153342_2057379262","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:87"},{"text":"%pyspark\nchosen_time_delta_in_sec = 220\n\nfirst_date_filter_df = filter_df_with_moving_deltaT(index_log_file_filtered_df, reference_date, chosen_time_delta_in_sec)\nfirst_date_filter_df.show(40, truncate=15)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783590_-1896684958","id":"20230829-155036_2029360410","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88"},{"text":"%pyspark\nfirst_date_filter_df.count()","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"22"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783602_-1888989980","id":"20230829-155104_1389809013","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:89"},{"text":"%pyspark\ndef filter_df_with_moving_deltaT(index_log_file_prefiltered_df, date_selected, chosen_time_delta_in_seconds = 220):\n    deltaT = timedelta(seconds = chosen_time_delta_in_seconds)\n    # Initially filter wintin a daterange of plus or minus deltaT arround the date_selected\n    initial_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= date_selected - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= date_selected + deltaT)\n    \n    initial_date_filtered_df = index_log_file_prefiltered_df.filter(initial_date_filter_expression)\n    initial_rows_count = initial_date_filtered_df.count()\n    previous_rows_count = 0\n    \n    # That operation will most likely result in a df with a larger number of rows. Find the new maximum and minimum date of the df and filter on those new values plus or minus deltaT\n    new_minimum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"min\"}).collect()[0][0]\n    new_maximum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"max\"}).collect()[0][0]\n    \n    new_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= new_minimum_date_value - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= new_maximum_date_value + deltaT)\n    new_rows_df = index_log_file_prefiltered_df.filter(new_date_filter_expression)\n    new_rows_count = new_rows_df.count()\n    \n    while new_rows_count !=  previous_rows_count:\n        previous_rows_count = new_rows_count\n        new_minimum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"min\"}).collect()[0][0]\n        new_maximum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"max\"}).collect()[0][0]\n        \n        new_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= new_minimum_date_value - deltaT) & \\\n                                         (F.col(\"File_date_as_TimestampType\") <= new_maximum_date_value + deltaT)\n        new_rows_df = index_log_file_prefiltered_df.filter(new_date_filter_expression)\n        new_rows_count = new_rows_df.count()\n    return new_rows_df","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783615_-1893991716","id":"20230829-155311_1958306364","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:90"},{"text":"%pyspark\nchosen_time_delta_in_sec = 220\n\nfirst_date_filter_df = filter_df_with_moving_deltaT(index_log_file_filtered_df, reference_date, chosen_time_delta_in_sec)\nfirst_date_filter_df.show(40, truncate=15)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783626_-1812040200","id":"20230829-161506_1163262878","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:91"},{"text":"%pyspark\nfirst_date_filter_df.count()","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"22"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783638_-1804345222","id":"20230829-161518_300426394","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:92"},{"text":"%pyspark\ndef filter_df_with_moving_deltaT(index_log_file_prefiltered_df, date_selected, chosen_time_delta_in_seconds = 220):\n    deltaT = timedelta(seconds = chosen_time_delta_in_seconds)\n    # Initially filter wintin a daterange of plus or minus deltaT arround the date_selected\n    initial_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= date_selected - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= date_selected + deltaT)\n    \n    initial_date_filtered_df = index_log_file_prefiltered_df.filter(initial_date_filter_expression)\n    initial_rows_count = initial_date_filtered_df.count()\n    previous_rows_count = 0\n    print(\"initial_rows_count = \", initial_rows_count)\n    \n    # That operation will most likely result in a df with a larger number of rows. Find the new maximum and minimum date of the df and filter on those new values plus or minus deltaT\n    new_minimum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"min\"}).collect()[0][0]\n    new_maximum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"max\"}).collect()[0][0]\n    print(\"initial new_minimum_date_value = \", new_minimum_date_value)\n    print(\"initial new_maximum_date_value = \", new_maximum_date_value)\n    \n    new_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= new_minimum_date_value - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= new_maximum_date_value + deltaT)\n    new_rows_df = index_log_file_prefiltered_df.filter(new_date_filter_expression)\n    new_rows_count = new_rows_df.count()\n    print(\"inital new_rows_count = \", new_rows_count)\n    \n    while new_rows_count !=  previous_rows_count:\n        print(\" Loop :\")\n        previous_rows_count = new_rows_count\n        print(\"previous_rows_count = \", previous_rows_count)\n        new_minimum_date_value = new_rows_df.agg({\"File_date_as_TimestampType\": \"min\"}).collect()[0][0]\n        new_maximum_date_value = new_rows_df.agg({\"File_date_as_TimestampType\": \"max\"}).collect()[0][0]\n        print(\"new_minimum_date_value = \", new_minimum_date_value)\n        print(\"new_maximum_date_value = \", new_maximum_date_value)\n        new_date_filter_expression_2 = (F.col(\"File_date_as_TimestampType\") >= new_minimum_date_value - deltaT) & \\\n                                         (F.col(\"File_date_as_TimestampType\") <= new_maximum_date_value + deltaT)\n        new_rows_df = index_log_file_prefiltered_df.filter(new_date_filter_expression_2)\n        new_rows_count = new_rows_df.count()\n        print(\"new_rows_count = \", new_rows_count)\n    return new_rows_df","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783651_-1821658923","id":"20230829-161620_1497412754","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:93"},{"text":"%pyspark\nchosen_time_delta_in_sec = 220\nprint(\"reference_SN = \", reference_SN)\nprint(\"reference_date = \", reference_date)\nprint(\"reference_file_type = \", reference_file_type)\nprint(\"##############################################\")\n\nfirst_date_filter_df = filter_df_with_moving_deltaT(index_log_file_filtered_df, reference_date, chosen_time_delta_in_sec)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"reference_SN =  SN449\nreference_date =  2023-06-25 12:16:01\nreference_file_type =  Raw\n##############################################\ninitial_rows_count =  5\ninitial new_minimum_date_value =  2023-06-25 12:12:37\ninitial new_maximum_date_value =  2023-06-25 12:19:24\ninital new_rows_count =  14\n Loop :\nprevious_rows_count =  14\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:22:48\nnew_rows_count =  16\n Loop :\nprevious_rows_count =  16\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:26:12\nnew_rows_count =  18\n Loop :\nprevious_rows_count =  18\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:29:37\nnew_rows_count =  20\n Loop :\nprevious_rows_count =  20\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:33:00\nnew_rows_count =  22\n Loop :\nprevious_rows_count =  22\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:36:24\nnew_rows_count =  24\n Loop :\nprevious_rows_count =  24\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:39:48\nnew_rows_count =  26\n Loop :\nprevious_rows_count =  26\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:43:12\nnew_rows_count =  28\n Loop :\nprevious_rows_count =  28\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:46:35\nnew_rows_count =  33\n Loop :\nprevious_rows_count =  33\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:50:00\nnew_rows_count =  37\n Loop :\nprevious_rows_count =  37\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:53:25\nnew_rows_count =  39\n Loop :\nprevious_rows_count =  39\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:56:49\nnew_rows_count =  47\n Loop :\nprevious_rows_count =  47\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:00:22\nnew_rows_count =  49\n Loop :\nprevious_rows_count =  49\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:03:39\nnew_rows_count =  51\n Loop :\nprevious_rows_count =  51\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:07:03\nnew_rows_count =  53\n Loop :\nprevious_rows_count =  53\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:10:27\nnew_rows_count =  56\n Loop :\nprevious_rows_count =  56\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:13:51\nnew_rows_count =  58\n Loop :\nprevious_rows_count =  58\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:17:15\nnew_rows_count =  60\n Loop :\nprevious_rows_count =  60\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:20:39\nnew_rows_count =  62\n Loop :\nprevious_rows_count =  62\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:24:02\nnew_rows_count =  64\n Loop :\nprevious_rows_count =  64\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:27:26\nnew_rows_count =  66\n Loop :\nprevious_rows_count =  66\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:30:50\nnew_rows_count =  74\n Loop :\nprevious_rows_count =  74\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:34:28\nnew_rows_count =  80\n Loop :\nprevious_rows_count =  80\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:38:02\nnew_rows_count =  85\n Loop :\nprevious_rows_count =  85\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:41:04\nnew_rows_count =  89\n Loop :\nprevious_rows_count =  89\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:44:28\nnew_rows_count =  92\n Loop :\nprevious_rows_count =  92\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:47:52\nnew_rows_count =  94\n Loop :\nprevious_rows_count =  94\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:51:16\nnew_rows_count =  96\n Loop :\nprevious_rows_count =  96\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:54:39\nnew_rows_count =  96"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783662_-1825891161","id":"20230829-163028_1552142478","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:94"},{"text":"%pyspark\nchosen_time_delta_in_sec = 220\n\nfirst_date_filter_df = filter_df_with_moving_deltaT(index_log_file_filtered_df, reference_date, chosen_time_delta_in_sec)\nfirst_date_filter_df.show(108, truncate=15)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"initial_rows_count =  5\ninitial new_minimum_date_value =  2023-06-25 12:12:37\ninitial new_maximum_date_value =  2023-06-25 12:19:24\ninital new_rows_count =  14\n Loop :\nprevious_rows_count =  14\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:22:48\nnew_rows_count =  16\n Loop :\nprevious_rows_count =  16\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:26:12\nnew_rows_count =  18\n Loop :\nprevious_rows_count =  18\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:29:37\nnew_rows_count =  20\n Loop :\nprevious_rows_count =  20\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:33:00\nnew_rows_count =  22\n Loop :\nprevious_rows_count =  22\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:36:24\nnew_rows_count =  24\n Loop :\nprevious_rows_count =  24\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:39:48\nnew_rows_count =  26\n Loop :\nprevious_rows_count =  26\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:43:12\nnew_rows_count =  28\n Loop :\nprevious_rows_count =  28\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:46:35\nnew_rows_count =  33\n Loop :\nprevious_rows_count =  33\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:50:00\nnew_rows_count =  37\n Loop :\nprevious_rows_count =  37\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:53:25\nnew_rows_count =  39\n Loop :\nprevious_rows_count =  39\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 12:56:49\nnew_rows_count =  47\n Loop :\nprevious_rows_count =  47\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:00:22\nnew_rows_count =  49\n Loop :\nprevious_rows_count =  49\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:03:39\nnew_rows_count =  51\n Loop :\nprevious_rows_count =  51\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:07:03\nnew_rows_count =  53\n Loop :\nprevious_rows_count =  53\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:10:27\nnew_rows_count =  56\n Loop :\nprevious_rows_count =  56\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:13:51\nnew_rows_count =  58\n Loop :\nprevious_rows_count =  58\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:17:15\nnew_rows_count =  60\n Loop :\nprevious_rows_count =  60\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:20:39\nnew_rows_count =  62\n Loop :\nprevious_rows_count =  62\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:24:02\nnew_rows_count =  64\n Loop :\nprevious_rows_count =  64\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:27:26\nnew_rows_count =  66\n Loop :\nprevious_rows_count =  66\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:30:50\nnew_rows_count =  74\n Loop :\nprevious_rows_count =  74\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:34:28\nnew_rows_count =  80\n Loop :\nprevious_rows_count =  80\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:38:02\nnew_rows_count =  85\n Loop :\nprevious_rows_count =  85\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:41:04\nnew_rows_count =  89\n Loop :\nprevious_rows_count =  89\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:44:28\nnew_rows_count =  92\n Loop :\nprevious_rows_count =  92\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:47:52\nnew_rows_count =  94\n Loop :\nprevious_rows_count =  94\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:51:16\nnew_rows_count =  96\n Loop :\nprevious_rows_count =  96\nnew_minimum_date_value =  2023-06-25 12:09:33\nnew_maximum_date_value =  2023-06-25 13:54:39\nnew_rows_count =  96\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783674_-1818196183","id":"20230829-163106_421992571","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"text":"%pyspark\nfirst_date_filter_df.count()","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"96"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783686_-1835125134","id":"20230829-165717_1958557187","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"text":"%pyspark\ndiff_df = index_log_file_filtered_df.subtract(first_date_filter_df)\ndiff_df.show(108, truncate=15)\n","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-26 2...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783698_-1827430156","id":"20230829-165731_1249135788","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:97"},{"text":"%pyspark\ndiff_df.show(108, truncate=60)","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------------------------------------+------------------------------------------------------------+---------+--------------------------+-------+-------------------+------------------------------------------------------------+------------------------------------------------------------+-----------------------------+----------------------------+---------------+----------------+-----------------------+\n|                                      file_name_no_extension|                                    File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|                                 Raw_file_legacy_folder_path|                                  Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|            Update_Date|\n+------------------------------------------------------------+------------------------------------------------------------+---------+--------------------------+-------+-------------------+------------------------------------------------------------+------------------------------------------------------------+-----------------------------+----------------------------+---------------+----------------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|      Raw|       2023-06-26 22:32:54|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:24.974|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|      Raw|       2023-06-26 22:38:00|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:29.859|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224...|      Raw|       2023-06-26 22:43:05|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:34.663|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|      Raw|       2023-06-26 22:36:18|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:28.245|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|      Raw|       2023-06-26 22:34:36|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:26.619|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|      Raw|       2023-06-26 22:31:13|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:23.389|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223...|      Raw|       2023-06-26 22:39:42|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:31.501|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222...|      Raw|       2023-06-26 22:27:48|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:19.391|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222...|      Raw|       2023-06-26 22:29:31|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:21.737|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224...|      Raw|       2023-06-26 22:44:47|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:36.232|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224...|      Raw|       2023-06-26 22:41:23|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:33.026|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222...|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222...|      Raw|       2023-06-26 22:26:06|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TR...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois...|                         true|                        true|           null|            null|2023-08-29 13:33:17.683|\n+------------------------------------------------------------+------------------------------------------------------------+---------+--------------------------+-------+-------------------+------------------------------------------------------------+------------------------------------------------------------+-----------------------------+----------------------------+---------------+----------------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783710_-1832047143","id":"20230829-170229_1015414821","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:98"},{"text":"%pyspark\ndiff_df_2 = index_log_file_filtered_df.subtract(diff_df)\ndiff_df_2.show(108, truncate=15)\n","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|    Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|      Raw|           2023-06-25 1...|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|           null|            null|2023-08-29 1...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+---------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693322783721_-1850130341","id":"20230829-170315_548709519","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:99"},{"text":"%pyspark\n","dateUpdated":"2023-08-29T17:26:23+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693322783733_-1842435363","id":"20230829-170440_134726164","dateCreated":"2023-08-29T17:26:23+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100"}],"name":"Prestation/Cedric_Schlosser/0_Pretraitement/preprocess_new_files_V2_4","id":"2J8ZXAVG1","angularObjects":{"2E9RNJTWH:e854129:":[],"2DPT2KY4G:e854129:":[],"2DMZD3RC8:e854129:":[],"2DR8NJJ56:e854129:":[],"2HBEPS2W4:e854129:":[],"2C4U48MY3_spark2:e854129:":[],"2CHS8UYQQ:e854129:":[],"2CK8A9MEG:shared_process":[],"2DTHQK84C:e854129:2J8ZXAVG1":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[],"2HEW5MG2H:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}