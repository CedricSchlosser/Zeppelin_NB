{"paragraphs":[{"text":"%md\n#Step 1 :\n##Import new files on HDFS \n#### Unzip freshly received data with the tool provided for matlab in: \n    N:\\DA\\SOC\\NP\\ORG\\DGT\\UNIX\\SCIENTIFIQUE\\CSC\\PROJET\\IRYS2-TREND\\02-ANALYSES\\02_SYSTEMES\\matlab-v011500-d20200721\\matlab\n### Then launch trend monitoring and click on check for new files. If there are new files to process, the tool will take them and sort them in the correct folder on the newtwork N:\\\n#### To synchronise local folder from the N:\\ with the big data datalake, write this command line in a CMD interpreter (write cmd in search bar then press enter) : \n    python N:\\DA\\SOC\\NP\\ORG\\DGT\\POLE-SYSTEME\\PRESTATION\\DTS_Cedric_Schlosser\\Importation\\webhdfs-master@cb177a1893d\\importation_acmf_new_version.py \n#### Enter password LDAP password, press enter and wait for the end","dateUpdated":"2023-09-05T11:22:45+0200","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step 1 :</h1>\n<h2>Import new files on HDFS</h2>\n<h4>Unzip freshly received data with the tool provided for matlab in:</h4>\n<pre><code>N:\\DA\\SOC\\NP\\ORG\\DGT\\UNIX\\SCIENTIFIQUE\\CSC\\PROJET\\IRYS2-TREND\\02-ANALYSES\\02_SYSTEMES\\matlab-v011500-d20200721\\matlab\n</code></pre>\n<h3>Then launch trend monitoring and click on check for new files. If there are new files to process, the tool will take them and sort them in the correct folder on the newtwork N:\\</h3>\n<h4>To synchronise local folder from the N:\\ with the big data datalake, write this command line in a CMD interpreter (write cmd in search bar then press enter) :</h4>\n<pre><code>python N:\\DA\\SOC\\NP\\ORG\\DGT\\POLE-SYSTEME\\PRESTATION\\DTS_Cedric_Schlosser\\Importation\\webhdfs-master@cb177a1893d\\importation_acmf_new_version.py \n</code></pre>\n<h4>Enter password LDAP password, press enter and wait for the end</h4>\n"}]},"apps":[],"jobName":"paragraph_1693905765006_-1940469255","id":"20221102-110041_543643774","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:54"},{"text":"%md \n#Step 2 :\n## Preprocessing of the newly imported data\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Step 2 :</h1>\n<h2>Preprocessing of the newly imported data</h2>\n"}]},"apps":[],"jobName":"paragraph_1693905765029_-1950857475","id":"20221102-110305_990680666","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:55"},{"title":"Nombre de vols avant prétraitement","text":"%pyspark\nimport subprocess, re\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\n\nfrom datetime import datetime\nstart = datetime.now()\nprint('Nombre de rapport vol avant pretraitement le', start)\n\nSN_vol = listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2')\nfor sn in SN_vol:\n    print(sn[-5:], len(listdir(sn)))","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Nombre de rapport vol avant pretraitement le 2023-06-29 13:49:13.061320\nSN267 519\nSN268 1113\nSN269 1125\nSN270 1094\nSN412 1486\nSN425 1737\nSN449 553\nSN455 563\nSN466 511"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1713<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1713/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1713/</a>"}]},"apps":[],"jobName":"paragraph_1693905765046_-1943547246","id":"20221102-112448_1589718539","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:56"},{"title":"Lancement du pretraitement","text":"%sh\nexport SPARK_MAJOR_VERSION=2\n\nspark-submit --deploy-mode cluster --master yarn --executor-cores 32 --driver-memory 25g --executor-memory 100g --conf spark.storage.memoryFraction=0.6 --queue dev /da/sc/np/home/data/e854129/spark_submit/new_files/Pretraitement_new_files_V2.0.0.py","dateUpdated":"2023-09-05T11:22:45+0200","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"INCOMPLETE","msg":[{"type":"TEXT","data":"SPARK_MAJOR_VERSION is set to 2, using Spark2\n23/09/04 17:24:17 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\n23/09/04 17:24:18 WARN DomainSocketFactory: The short-circuit local reads feature cannot be used because libhadoop cannot be loaded.\n23/09/04 17:24:18 INFO RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/09/04 17:24:18 INFO Client: Requesting a new application from cluster with 4 NodeManagers\n23/09/04 17:24:18 INFO Client: Verifying our application has not requested more than the maximum memory capability of the cluster (460000 MB per container)\n23/09/04 17:24:18 INFO Client: Will allocate AM container, with 28160 MB memory including 2560 MB overhead\n23/09/04 17:24:18 INFO Client: Setting up container launch context for our AM\n23/09/04 17:24:18 INFO Client: Setting up the launch environment for our AM container\n23/09/04 17:24:18 INFO Client: Preparing resources for our AM container\n23/09/04 17:24:20 INFO Client: Use hdfs cache file as spark.yarn.archive for HDP, hdfsCacheFile:hdfs://hdfs.isilon.dassault-avion.fr:8020/hdp/apps/2.6.5.0-292/spark2/spark2-hdp-yarn-archive.tar.gz\n23/09/04 17:24:20 INFO Client: Source and destination file systems are the same. Not copying hdfs://hdfs.isilon.dassault-avion.fr:8020/hdp/apps/2.6.5.0-292/spark2/spark2-hdp-yarn-archive.tar.gz\n23/09/04 17:24:20 INFO Client: Uploading resource file:/da/sc/np/home/data/e854129/spark_submit/new_files/Pretraitement_new_files_V2.0.0.py -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1976/Pretraitement_new_files_V2.0.0.py\n23/09/04 17:24:20 INFO Client: Uploading resource file:/usr/hdp/current/spark2-client/python/lib/pyspark.zip -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1976/pyspark.zip\n23/09/04 17:24:20 INFO Client: Uploading resource file:/usr/hdp/current/spark2-client/python/lib/py4j-0.10.6-src.zip -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1976/py4j-0.10.6-src.zip\n23/09/04 17:24:21 INFO Client: Uploading resource file:/tmp/spark-f2359b65-dc24-40bc-ab9e-60088e4f5bef/__spark_conf__6808559070086158956.zip -> hdfs://hdfs.isilon.dassault-avion.fr:8020/user/e854129/.sparkStaging/application_1661169780396_1976/__spark_conf__.zip\n23/09/04 17:24:21 WARN Client: spark.yarn.am.extraJavaOptions will not take effect in cluster mode\n23/09/04 17:24:21 INFO SecurityManager: Changing view acls to: e854129\n23/09/04 17:24:21 INFO SecurityManager: Changing modify acls to: e854129\n23/09/04 17:24:21 INFO SecurityManager: Changing view acls groups to: \n23/09/04 17:24:21 INFO SecurityManager: Changing modify acls groups to: \n23/09/04 17:24:21 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(e854129); groups with view permissions: Set(); users  with modify permissions: Set(e854129); groups with modify permissions: Set()\n23/09/04 17:24:21 INFO Client: Submitting application application_1661169780396_1976 to ResourceManager\n23/09/04 17:24:21 INFO YarnClientImpl: Submitted application application_1661169780396_1976\n23/09/04 17:24:22 INFO Client: Application report for application_1661169780396_1976 (state: ACCEPTED)\n23/09/04 17:24:22 INFO Client: \n\t client token: N/A\n\t diagnostics: AM container is launched, waiting for AM container to Register with RM\n\t ApplicationMaster host: N/A\n\t ApplicationMaster RPC port: -1\n\t queue: dev\n\t start time: 1693841067681\n\t final status: UNDEFINED\n\t tracking URL: http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1976/\n\t user: e854129\n23/09/04 17:24:23 INFO Client: Application report for application_1661169780396_1976 (state: ACCEPTED)\n23/09/04 17:24:24 INFO Client: Application report for application_1661169780396_1976 (state: ACCEPTED)\n23/09/04 17:24:25 INFO Client: Application report for application_1661169780396_1976 (state: ACCEPTED)\n23/09/04 17:24:26 INFO Client: Application report for application_1661169780396_1976 (state: ACCEPTED)\n23/09/04 17:24:27 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:27 INFO Client: \n\t client token: N/A\n\t diagnostics: N/A\n\t ApplicationMaster host: 192.200.242.14\n\t ApplicationMaster RPC port: 0\n\t queue: dev\n\t start time: 1693841067681\n\t final status: UNDEFINED\n\t tracking URL: http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1976/\n\t user: e854129\n23/09/04 17:24:28 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:29 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:30 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:31 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:32 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:33 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:34 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:35 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:36 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:37 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:38 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:39 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:40 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:41 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:42 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:43 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:44 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:45 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:46 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:47 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:48 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:49 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:50 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:51 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:52 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:53 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:54 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:55 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:56 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:57 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:58 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:24:59 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:00 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:01 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:02 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:03 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:04 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:05 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:06 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:07 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:08 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:09 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:10 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:11 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:12 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:13 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:14 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n23/09/04 17:25:15 INFO Client: Application report for application_1661169780396_1976 (state: RUNNING)\n"},{"type":"TEXT","data":"Paragraph received a SIGTERM\nExitValue: 143"}]},"apps":[],"jobName":"paragraph_1693905765062_-1962015193","id":"20221102-111209_936936743","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:57"},{"title":"Vérification du déroulement ","text":"%sh\r\nyarn application -list \r\nyarn application -appStates RUNNING -list | grep \"applicationName\"","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":true,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"23/09/05 11:18:06 INFO client.RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/09/05 11:18:06 INFO client.AHSProxy: Connecting to Application History server at dalbigm03.dassault-avion.fr/192.200.242.3:10200\nTotal number of applications (application-types: [] and states: [SUBMITTED, ACCEPTED, RUNNING]):2\n                Application-Id\t    Application-Name\t    Application-Type\t      User\t     Queue\t             State\t       Final-State\t       Progress\t                       Tracking-URL\napplication_1661169780396_1980\t   livy-session-8226\t               SPARK\t   e854129\t       dev\t           RUNNING\t         UNDEFINED\t            10%\thttp://dalbigc01.dassault-avion.fr:39241\napplication_1661169780396_1602\tThrift JDBC/ODBC Server\t               SPARK\t      hive\t   default\t           RUNNING\t         UNDEFINED\t            10%\thttp://dalbigm01.dassault-avion.fr:4040\n23/09/05 11:18:07 INFO client.RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/09/05 11:18:07 INFO client.AHSProxy: Connecting to Application History server at dalbigm03.dassault-avion.fr/192.200.242.3:10200\n"},{"type":"TEXT","data":"ExitValue: 1"}]},"apps":[],"jobName":"paragraph_1693905765076_-1956628709","id":"20221102-113314_719818459","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:58"},{"title":"Arret d'un spark submit","text":"%sh\r\nyarn application -kill application_1661169780396_1976\r\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"tableHide":true,"editorSetting":{"editOnDblClick":false,"language":"sh"},"colWidth":12,"editorMode":"ace/mode/sh","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"23/09/05 11:18:00 INFO client.RMProxy: Connecting to ResourceManager at dalbigm02.dassault-avion.fr/192.200.242.2:8050\n23/09/05 11:18:00 INFO client.AHSProxy: Connecting to Application History server at dalbigm03.dassault-avion.fr/192.200.242.3:10200\nKilling application application_1661169780396_1976\n23/09/05 11:18:01 INFO impl.YarnClientImpl: Killed application application_1661169780396_1976\n"}]},"apps":[],"jobName":"paragraph_1693905765090_-1972788162","id":"20221103-143237_568908965","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:59"},{"title":"A lancer après fin du pretraitement","text":"%pyspark\nfrom datetime import datetime\nimport subprocess, re\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\nstop = datetime.now()\nprint('Nombre de rapport apres pretraitement le', stop)\n\nSN_vol = listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2')\nfor sn in SN_vol:\n    print(sn[-5:], len(listdir(sn)))\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Nombre de rapport apres pretraitement le 2023-06-30 09:17:09.157713\nSN267 520\nSN268 1114\nSN269 1167\nSN270 1125\nSN412 1515\nSN425 1801\nSN449 598\nSN455 600\nSN466 551"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1718<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1718/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1718/</a>"}]},"apps":[],"jobName":"paragraph_1693905765103_-1977789898","id":"20221102-113303_402800297","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:60"},{"title":"Essai direct (Code de Louis Carmier)","text":"%pyspark\nimport sys\nfrom pyspark import SparkContext, SparkConf\nfrom pyspark.sql import SparkSession \n\nfrom pyspark.sql.types import StructType\nfrom pyspark.sql.types import StructField\nfrom pyspark.sql.types import StringType\n\nfrom pyspark.sql.functions import pandas_udf\n\nimport pandas as pd\n\nfrom datetime import datetime\nfrom datetime import timedelta\n\nimport subprocess, re\n\nfrom pyspark.sql.window import Window\nfrom pyspark.sql.types import IntegerType\n\nimport pyspark.sql.functions as F\n\n#En entree un rdd et le numero de ligneF\n#En sortie une ligne du rdd\ndef GetSpecificRow(rdd, id):\n\treturn rdd.zipWithIndex().filter(lambda x: x[1]==id)\n\n#En entree un rdd associe a un fichier acmf\n#En sortie les colonnes du ichier ACMF\ndef get_header(rdd):\n\theaderRow = GetSpecificRow(rdd,6).map(lambda x: x[0]).map(lambda x: x.split(',')) #ici les donnees sont separees par des virgules\n\theader = headerRow.first()\n\theader = ['other' if column == ' ' else column for column in header]\n\treturn header\n\n#En entree une liste de noms de fichiers appartenant a un meme vol\n#En sortie un rdd contenant l'ensemble des fichiers d un meme vol concatenes.\ndef create_join_rdd(vol):\n\tc=0\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n   \n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\trdd2.collect()\n\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header\n\t\n#En entree un rdd et un header (label des colonnes)\n#En sortie une dataframe  objet qui permet des traitements par colonnes alors que rdd par ligne\ndef data_frame(rdd, header):\n\tschema = StructType([StructField(column, StringType(), True) for column in header])\n\tdf = spark.createDataFrame(rdd, schema)\n\tdf=df.toDF(*(c.replace(' ', '_') for c in df.columns))\n\tdf=df.toDF(*(c.replace('(', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace(')', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace('.', '_') for c in df.columns))\n\treturn df\n\t\n#En entree un rdd\n#En sortie l heure de debut d enregistrement\ndef trigger_time(rdd):\n\tTriggerTimeRow = GetSpecificRow(rdd,3).map(lambda x: x[0]).map(lambda x: x.split(' '))\n\tTriggerTime = ' '.join(TriggerTimeRow.first()[1:])\n\treturn TriggerTime\n\n#En entree une dataframe\n#en sortie la meme dataframe adjointe dun vecteur date\ndef insert_date(df):\n\t@pandas_udf(StringType())\n\tdef pandas_insert_date(trigger: pd.Series, frame: pd.Series) -> pd.Series:\n\t\ttrig=pd.Series([datetime.strptime(TriggerTime, \"%d %b %Y %H:%M:%S\") for TriggerTime in trigger])\n\t\tdelta=pd.Series([timedelta(milliseconds=int(ms)*100) for ms in frame])\n\t\tdate=trig+delta\n\t\treturn pd.Series([d.strftime(\"%d %m %Y %H:%M:%S.%f\") for d in date])\n\t\t\n\tdf=df.withColumn('date', pandas_insert_date(df['Trigger'], df['Frame_100_ms_']))\n\t\n\treturn df\n\t\n#retourne la liste des colonnes doublons (pour information avec leur nom d origine), le nouveau header avec les noms modifies, et une liste contenant le nom des colonnes doublons renommees\ndef detect_doublon(header):\n\tcolonnes=[]\n\tliste_doublon=[]\n\tliste_tot_doublons=[]\n\tc=0\n\tnew_header=[]\n\t\n\tfor col in header:\n\t\tif col in colonnes:\n\t\t\tif col in liste_doublon:\n\t\t\t\tc+=1\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\t\n\t\t\telse:\n\t\t\t\tliste_doublon.append(col)\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\telse:\n\t\t\tnew_header.append(col)\n\t\t\tcolonnes.append(col)\n\treturn liste_doublon, new_header, liste_tot_doublons\n\t\n#suppression des colonnes doublons    \ndef suppr_doublon(df, new_header, liste_tot_doublons):\n\tschema = StructType([StructField(column, StringType(), True) for column in new_header])\n\tcsv=df.rdd\n\tdf=spark.createDataFrame(csv, schema)\n\tfor col in liste_tot_doublons:\n\t\tdf=df.drop(df[col])\n\treturn df\n\t\n#en entree les fichiers appartenant a un meme vol\n#creation de la dataframe corrigee avec adjonction du vecteur temps\n#en sortie la dataframe corrigee\ndef create_df_vol(vol):\n\trdd,header=create_join_rdd(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date(df)\n\t\n\treturn df\n\t\n#les fonctions suivantes sont utiles dans le cas ou l on traite un fichier seul, qui n a pas pu etre lie a un vol.\ndef insert_date_seul(df, TriggerTime):\n\t@pandas_udf(StringType())\n\tdef pandas_insert_date(series: pd.Series) -> pd.Series:\n\t\tdate=datetime.strptime(TriggerTime, \"%d %b %Y %H:%M:%S\")\n\t\treturn pd.Series([(date+timedelta(milliseconds=int(ms)*100)).strftime(\"%d %m %Y %H:%M:%S.%f\") for ms in series])\n\t\n\tdf=df.withColumn('date', pandas_insert_date(df['Frame_100_ms_']))\n\t\n\treturn df\n\t\n#creation dune dataframe a parir dun fichier seul\ndef create_df(path):\n\trdd_brut = sc.textFile(path)\n\tTriggerTime=trigger_time(rdd_brut)\n\theader=get_header(rdd_brut)\n\trdd = rdd_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_seul(df, TriggerTime)\n\n\treturn df  \n\t\ndef create_df_slow(path):\n\trdd_brut = sc.textFile(path)\n\tTriggerTime=trigger_time(rdd_brut)\n\theader=get_header(rdd_brut)\n\trdd = rdd_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tdf=data_frame(rdd, header)\n\tdf = df.withColumn('Trigger', F.lit(TriggerTime))\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n \n\tdf=insert_date_udf(df)\n\t\n\treturn df\n\t\n#en entree le chemin vers un dossier\n#en sortie une la liste des fichiers dans le dossier\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\n\t\n#extraction du nom du fichier a partir du chemin complet\ndef extract_name(path):\n\tfor i in range (1, len(path)):\n\t\tif path[-i]=='/':\n\t\t\treturn (path[len(path)-i+1:-4])\n\t\t\t\n#extraction de la date d enregistrement\ndef id_date(path):\n\treturn(extract_name(path)[-15:])\n\t\n#identite de lavion et date\ndef id(path):\n\treturn(extract_name(path)[-23:])\n\t\n#Detection de fichiers appartenant a un meme vol\n#Le defaut est corrige\ndef isSameFlight(t1,t2):\n\ttry:\n\t\tt1 = datetime.strptime(t1,\"%Y%m%d%H%M%S\")\n\t\tt2 = datetime.strptime(t2,\"%Y%m%d%H%M%S\")\n\t\tif t1 > t2:\n\t\t\tdelta= t1-t2\n\t\telse:\n\t\t\tdelta=t2-t1\n\t\t\t\n\t\tif delta<timedelta(seconds=220):\n\t\t\treturn True\n\t\telse:\n\t\t\treturn False\n\texcept:\n\t\treturn False\n\t\t\n#version plus efficace de get_vols\ndef get_vols_perfo(liste_fichiers):\n\tif liste_fichiers==[]:\n\t\treturn []\n\telse:\n\t\tvol=[liste_fichiers[0]]\n\t\tL_vols=[]\n\t\tfor i in range(len(liste_fichiers)-1):\n\t\t\tp1=liste_fichiers[i]\n\t\t\tp2=liste_fichiers[i+1]\n\t\t\tif isSameFlight(id_date(p1)[:-1], id_date(p2)[:-1]):\n\t\t\t\ttry:\n\t\t\t\t\tif datetime.strptime(id_date(p2)[:-1], \"%Y%m%d%H%M%S\")  < datetime.strptime(id_date(vol[0])[:-1], \"%Y%m%d%H%M%S\"):\n\t\t\t\t\t\tvol.insert(0, p2)\n\t\t\t\t\tif datetime.strptime(id_date(p2)[:-1], \"%Y%m%d%H%M%S\")  > datetime.strptime(id_date(vol[-1])[:-1], \"%Y%m%d%H%M%S\"):\n\t\t\t\t\t\tvol.append(p2)\n\t\t\t\t\telse:\n\t\t\t\t\t\tvol.insert(len(vol)-2, p2)\n\t\t\t\texcept:\n\t\t\t\t\tprint(p1,p2)\n\t\t\telse:\n\t\t\t\tL_vols.append(vol)\n\t\t\t\tvol=[p2]\n\t\tL_vols.append(vol)\n\t\treturn L_vols\n\t\t\n#suppression des lignes ou la jointure est decalee\ndef fill(df):\n\tdf=df.replace(' ', None)\n\tdf=df.dropna(subset=df.columns[2:10])\n\t\n\treturn df\n\ndef fill2(df):\n\tfor c in df.columns[:-3]:\n\t\tdf = df.withColumn(c, F.regexp_replace(c, ' ', ''))\n\treturn df.dropna()\n\t\ndef isSameFlight_perfo2(t,vol):\n\ttry:\n\t\td=datetime.strptime(id_date(vol[0])[:-1], \"%Y%m%d%H%M%S\")\n\t\tf=datetime.strptime(id_date(vol[-1])[:-1], \"%Y%m%d%H%M%S\")\n\t\tT=datetime.strptime(t[:-1], \"%Y%m%d%H%M%S\")\n\t\tif T>=d and T<=f: \n\t\t\treturn True\n\t\telse: \n\t\t\treturn False\n\texcept:\n\t\tprint(id_date(vol[0]), id_date(vol[-1]))\n\t\t\n#distinciton entre fichiers irys et fichiers perfos\ndef nom_vol(path):\n\tif 'IRYS2' in path:\n\t\treturn('IRYS2_')\n\tif 'PERFOS' in path:\n\t\treturn('PERFOS_')\n\t\t\t\t\t\n#detection d un fichier vol\ndef is_Irys(path):\n\treturn 'IRYS2' in path or 'PERFOS' in path\n\t\n#detection de tous les fichiers vols et systeme\ndef get_files(files):\n\tsystems = []\n\tflights = []\n\tfor file in files:\n\t\tif is_Irys(file):\n\t\t\tflights.append(file)\n\t\telse:\n\t\t\tsystems.append(file)\n\treturn flights, systems\n\t\t\n\n#extraction nom du fichier systeme\ndef nom_syst(path):\n\treturn(extract_name(path)[:-24])\n\n#envoi de fichiers sur l hdfs\ndef envoi(df, nom, destination):\n\tdf.write.mode(\"overwrite\").parquet(destination+nom+'.parquet')\n\ndef decalage(df):\n\n\t@pandas_udf(StringType())\n\tdef pandas_del_na(series: pd.Series) -> pd.Series:\n\t\tt=series.size\n\t\tseries=series.dropna()\n\t\ttna=series.size\n\t\treturn pd.concat([series, pd.Series([None for i in range(t-tna)])])\n\t\t\n\tdf=df.replace(' ', None)\n\tfor c in df.columns:\n\t\tdf=df.withColumn(c, pandas_del_na(F.col(c)))\n\t\t\n\treturn df\n\n#system correspond au nom du rapport systeme a filtrer\ndef find_rename_send_system_report(L_vols, L_system, destination, system):\n\tif L_system==[] or L_vols==[]:\n\t\tNone\n\telse:\n\t\tL=[]\n\t\tfor p in L_system:\n\t\t\ttry:\n\t\t\t\tsys_split = p.split('_')[5]\n\t\t\t\tif system == sys_split:\n\t\t\t\t\tL.append(p)\n\t\t\texcept:\n\t\t\t\tpass\n\t\tfor syst in L:\n\t\t\tfound=False\n\t\t\tfor vol in L_vols:\n\t\t\t\tif isSameFlight_perfo2(id_date(syst),vol) and not found:\n\t\t\t\t\ttry:\n\t\t\t\t\t\tfound=True\n\t\t\t\t\t\tdf_syst=create_df(syst).repartition(1)\n\t\t\t\t\t\tdf_syst=decalage(df_syst)\n\t\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\t\tenvoi(df_syst, extract_name(syst)+'_'+id_date(vol[0]), destination)\n\t\t\t\t\texcept:\n\t\t\t\t\t\tpass\n\t\t\t\t\t\t\n#Recuperation des nouveaux fichiers Irys Perfo                    \ndef get_new_irys_syst(SN):\n\tancienSyst = listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_systeme/')\n\tlast=datetime.strptime('20101225153010', \"%Y%m%d%H%M%S\")\n\tfor syst in ancienSyst:\n\t\ttry:\n\t\t\tancienVols=listdir(syst + '/' + SN[-5:])\n\t\t\tfor vol in ancienVols:\n\t\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\t\tif last<date:\n\t\t\t\t\tlast=date\n\t\t\t\n\t\t\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/' + SN[-5:]))\n\t\t\t\n\t\t\tnouveauxIrys=[]\n\t\t\tfor irys in tousIrys:\n\t\t\t\ttry:\n\t\t\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\t\tif date>last:\n\t\t\t\t\t\tnouveauxIrys.append(irys)\n\t\t\t\texcept:\n\t\t\t\t\tprint(irys)        \n\t\t\t\n\t\texcept:\n\t\t\tpass\n\t\t\n\treturn nouveauxIrys\n\t\ndef get_new_irys_vol(SN):\n\tancienVols=listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'+SN)\n\ttry:\n\t\tlast=datetime.strptime(ancienVols[0][-23:-9], \"%Y%m%d%H%M%S\")\n\texcept:\n\t\tlast=datetime.strptime(ancienVols[3][-23:-9], \"%Y%m%d%H%M%S\")\n\tfor vol in ancienVols:\n\t\ttry:\n\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\tif last<date:\n\t\t\t\tlast=date\n\t\texcept:\n\t\t\tNone\n\t\t\t\n\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+SN))\n\t\n\tnouveauxIrys=[]\n\tfor irys in tousIrys:\n\t\ttry:\n\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\tif date>last:\n\t\t\t\tnouveauxIrys.append(irys)\n\t\texcept:\n\t\t\tNone\n\n\treturn nouveauxIrys\n\t\t\ndef get_new_irys_manuel(SN, date_str):\n\t\t\n\tlast = datetime.strptime(date_str, \"%Y%m%d%H%M%S\")\n\t\n\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+SN))\n\t\n\tnouveauxIrys=[]\n\tfor irys in tousIrys:\n\t\ttry:\n\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\tif date>last:\n\t\t\t\tnouveauxIrys.append(irys)\n\t\texcept:\n\t\t\tNone\n\n\treturn nouveauxIrys\n\t\ndef get_new_files(SN, all_files=False):\n\t\n\tancienVols=listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/' + SN)\n\n\ttousIrys, tousSyst = get_files(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+ SN))\n\n\t\t\n\t#Getting date of last flight\n\tif (ancienVols == []) or (all_files) :\n\t\treturn tousIrys, tousSyst\n\telse:\n\t\tlast = None\n\t\ti=0\n\t\twhile last==None:\n\t\t\ttry:\n\t\t\t\tlast=datetime.strptime(ancienVols[i][-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\texcept:\n\t\t\t\tpass\n\t\t\ti+=1\n\t\t  \n\t\tfor vol in ancienVols:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\t\tif last<date:\n\t\t\t\t\tlast=date\n\t\t\texcept:\n\t\t\t\tpass\n\t\tlast = last - timedelta(days=0) # modifiel le Delta pour ne pas toucher au fichier de Louis, pas de droits d ecriture\n\t\t\n\t\t\n\t\t\n\t\tnouveauxIrys=[]\n\t\tfor irys in tousIrys:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(id_date(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\tif date>last:\n\t\t\t\t\tnouveauxIrys.append(irys)\n\t\t\texcept:\n\t\t\t\tNone\n\t\t\n\t\tnouveauxSyst=[]\n\t\tfor syst in tousSyst:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(id_date(syst)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\tif date>last:\n\t\t\t\t\tnouveauxSyst.append(syst)\n\t\t\texcept:\n\t\t\t\tNone\n\t\treturn nouveauxIrys, nouveauxSyst\n\t\n\t\n\t\n#Retourne la liste des systemes presents dans la liste des systemes                    \ndef get_system_identifier(L_systems):\n\tsystems = []\n\tfor path in L_systems:    \n\t\tif '.csv' in path:\n\t\t\tp = path.split('_')\n\t\t\tif ('TRD' in p[1]) | ('MUX' in p[1]):\n\t\t\t\tif (p[5] not in systems) & (p[5] != 'IRYS2') & (p[5] != 'PERFOS'):\n\t\t\t\t\tsystems.append(p[5])\n\t\t\telse:\n\t\t\t\tif (p[4] not in systems) & ('P1153' in p[1]):\n\t\t\t\t\tsystems.append(p[4])\n\treturn systems \n\ndef insert_date_udf(df):\n\tdef insert_date_simple(trigger, frame):\n\t\ttrig = datetime.strptime(trigger, \"%d %b %Y %H:%M:%S\")\n\t\tdelta = timedelta(milliseconds=int(frame)*100)\n\t\tdate = trig + delta\n\t\treturn date.strftime(\"%d %m %Y %H:%M:%S.%f\")\n\tinsert_date_udf = F.udf(insert_date_simple, StringType())\n\t\n\tdf=df.withColumn('date', insert_date_udf(df['Trigger'], df['Frame_100_ms_']))\n\treturn df\n\t\ndef create_df_vol_slow(vol):\n\trdd,header=create_join_rdd_debug(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_udf(df)\n\t\n\treturn df\n\t\ndef create_join_rdd_debug(vol):\n\t\n\tc=0\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tlength0 = rdd1.count()\n\t\n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\tif rdd2.count() != length0:\n\t\t\trdd=sc.union(rdds)\n\t\t\treturn rdd,header\n\t\telse:\n\t\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\t\trdd2.collect()\n\t\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header\n\t\ndef find_rename_send_system_report_all_files(L_vols, L_system, destination, system):\n\tif L_system==[] or L_vols==[]:\n\t\tNone\n\telse:\n\t\tL=[]\n\t\tfor p in L_system:\n\t\t\ttry:\n\t\t\t\tsys_split = p.split('_')[5]\n\t\t\t\tif system == sys_split:\n\t\t\t\t\tL.append(p)\n\t\t\texcept:\n\t\t\t\tpass\n\t\tfor syst in L:\n\t\t\tfound=False\n\t\t\tfor vol in L_vols:\n\t\t\t\tif isSameFlight_perfo2(id_date(syst),vol):\n\t\t\t\t\ttry:\n\t\t\t\t\t\tfound=True\n\t\t\t\t\t\tdf_syst=create_df_slow(syst).repartition(1)\n\t\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\t\tversion = syst.split('/')[8]\n\t\t\t\t\t\tenvoi(df_syst, extract_name(syst)+'_'+id_date(vol[0]), destination + version + '/')\n\t\t\t\t\t\tbreak\n\t\t\t\t\texcept:\n\t\t\t\t\t\tbreak\n\t\t\t\t\n\t\t\tif not found:\n\t\t\t\ttry:\n\t\t\t\t\tdf_syst=create_df_slow(syst).repartition(1)\n\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\tversion = syst.split('/')[8]\n\t\t\t\t\tenvoi(df_syst, extract_name(syst)+'_X', destination + version + '/')\n\t\t\t\texcept:\n\t\t\t\t\tpass\n\n#concatenation et envoi des fichiers sur l hdfs\ndef concatenate_send(L_vols, destination):\n\tseptx = ['SN267', 'SN268', 'SN269', 'SN270']\n\t\n\tif L_vols==[]:\n\t\tNone\n\telse:\n\t\tfor vol in L_vols:\n\t\t\tif len(vol)>1:\n\t\t\t\t\tdf=create_df_vol_slow(vol)\n\t\t\t\t\tdf= df.drop('other')\n\t\t\t\t\tdf=fill2(df)\n\t\t\t\t\tdf=df.repartition('Part')\n\t\t\t\t\tversion = vol[0].split('/')[8]\n\t\t\t\t\tp = nom_vol(vol[0])+id(vol[0])\n\t\t\t\t\t#Lorsque l'ACMF est extrait du CMC le nom et numero avion n'est pas forcement ecrit\n\t\t\t\t\tif '__' in p:\n\t\t\t\t\t\t\n\t\t\t\t\t\tif version in septx:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0420' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0580' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\telse:\n\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+id(vol[0]), destination + version + '/')\n\n\t\t\t\t\t\n\t\t\telse:\n\t\t\t\ttry:\n\t\t\t\t\tdf=create_df_slow(vol[0])\n\t\t\t\t\tdf= df.drop('other')\n\t\t\t\t\tdf=fill2(df)\n\t\t\t\t\tdf=df.withColumn('Part', F.lit('0'))\n\t\t\t\t\tp = nom_vol(vol[0])+id(vol[0])\n\t\t\t\t\tversion = vol[0].split('/')[8]\n\t\t\t\t\tif '__' in p:\n\t\t\t\t\t\tif version in septx:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0420' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0580' + version[-3:] +id(vol[0]), destination + version + '/')\n\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+id(vol[0]), destination + version + '/')\n\t\t\t\texcept:\n\t\t\t\t\tprint('Bug 2')\n\n#Envoi des nouveaux fichiers systemes\ndef write_systems_files_datalake(input_path):\n\t\n\t#inputSN = listdir(input_path)\n\t#A MODIFIER ICI POUR NE PAS METTRE LA PRIO SUR 268\n\tinputSN = ['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN412']\n# \tinputSN = ['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN267', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN268', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN269', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN270', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN412', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN425', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN449', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN455', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466']\n\n\t\n\tfor SN in inputSN:\n\n\t\t\tif not '.xlsx' in SN:\n\t\t\t\toutput_destination_vol = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'\n\t\t\t\tL_vols, L_syst = get_new_files(SN[-5:], all_files=False)\n\t\t\t\t\n\t\t\t\t#MODIF ICI\n\t\t\t\tnew_vols = get_vols_perfo(L_vols)\n\t\t\t\t\n\t\t\t\tconcatenate_send(new_vols, output_destination_vol)\n\t\t\t\t\n\t\t\t\tsystems = get_system_identifier(L_syst)\n\n\t\t\t\tif systems != []:\n\t\t\t\t\tfor system in systems:\n\t\t\t\t\t\toutput_destination_syst = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_systeme_2/' + system + '/'\n\t\t\t\t\t\tfind_rename_send_system_report_all_files(new_vols, L_syst, output_destination_syst, system)\n\t\t\t\t\t\t\nwrite_systems_files_datalake('/datalake/prod/c2/ddd/crm/acmf/fichier_brut')","dateUpdated":"2023-09-05T11:22:45+0200","config":{"tableHide":false,"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0947<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0947/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0947/</a>"}]},"apps":[],"jobName":"paragraph_1693905765115_-1970094920","id":"20221104-150256_54577721","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:61"},{"text":"%pyspark\nSN = '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466'\n\noutput_destination_vol = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'\nL_vols, L_syst = get_new_files(SN[-5:], all_files=False)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0929<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/</a>"}]},"apps":[],"jobName":"paragraph_1693905765127_-1888528153","id":"20230126-140602_1668236806","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:62"},{"text":"%pyspark\nnew_vols = get_vols_perfo(L_vols)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0929<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0929/</a>"}]},"apps":[],"jobName":"paragraph_1693905765139_-1880833175","id":"20230126-140701_186133162","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:63"},{"text":"%pyspark\nprint(new_vols[0])","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155424t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155606t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155747t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128155930t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160112t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160253t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160435t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160617t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160759t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128160942t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161124t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161306t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161449t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161632t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161814t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128161957t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162139t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162321t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162503t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162645t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128162827t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163008t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163150t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163332t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163514t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163656t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128163838t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164020t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164203t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164345t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164527t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164710t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128164852t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165034t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165216t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165358t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165539t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165721t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128165903t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170045t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170228t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170410t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170552t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170734t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128170917t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171059t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171242t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171426t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171609t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171751t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128171932t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128172114t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128172256t.csv', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20221128172438t.csv']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0934<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/</a>"}]},"apps":[],"jobName":"paragraph_1693905765152_-1899685871","id":"20230126-140824_1782834653","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:64"},{"text":"%pyspark\nconcatenate_send([new_vols[1]], output_destination_vol)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"An error occurred while calling o83250.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\nTraceback (most recent call last):\n  File \"<stdin>\", line 601, in concatenate_send\n  File \"<stdin>\", line 304, in envoi\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/readwriter.py\", line 804, in parquet\n    self._jwrite.parquet(path)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/protocol.py\", line 320, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o83250.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221129170858t.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\n\n"}]},"apps":[],"jobName":"paragraph_1693905765164_-1904302858","id":"20230126-141121_1875415749","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:65"},{"text":"%pyspark\ndf = spark.read.parquet(\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424t.parquet\")\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0934<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/</a>"}]},"apps":[],"jobName":"paragraph_1693905765176_-1896607880","id":"20230126-142229_1215656770","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:66"},{"text":"%pyspark\ndf.show()","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------+-------------------------------------+------------------------------------------+-------------------------------------------+------------------------------------------+-----------------------------------------+-----------------------------------------------+-----------------------------------------+-------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------+--------------------------------------------------------------------+-------------------------------------------+-----------------------------------------+--------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------------------+--------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------+---------------------------------------------+-------------------------------------------------+----------------------------------------------+--------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------+--------------------------------------------------+--------------------------------------------------+--------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------+--------------------------------------------------------+-----------------------------------------------+----------------------------------------------+------------------------------------------------+-----------------------------------------------+-----------------------------------------------+------------------------------------------------------+----------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------+-----------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+--------------------------------------------------------------------------------+------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------+--------------------+----+--------------------+\n|Frame_100_ms_|_ASCB_D\\ADS\\ADS1aADA\\airData1000msecA429Data\\totalAirTemperature|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\lbl241b28_12AngleOfAttackAircraft|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\lbl250b28_12AngleofSideslip|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\staticAirTemperature|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\staticPressure|_ASCB_D\\ADS\\ADS1aADA\\airData50msec\\totalPressure|_ASCB_D\\ADS\\ADS2aADA\\airData1000msecA429Data\\totalAirTemperature|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\lbl241b28_12AngleOfAttackAircraft|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\lbl250b28_12AngleofSideslip|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\staticAirTemperature|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\staticPressure|_ASCB_D\\ADS\\ADS2aADA\\airData50msec\\totalPressure|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Data\\lbl274b29_14BASFlow|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl270b22BrakeHeatingMode|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl270b23SDuctAntiIceMode|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl270b24WingAntiIceMode|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl272b15MprsovEng1ClosedPositionSwitch|_ASCB_D\\AMMONE\\AMMONE1aA429\\ammone1000msecA429Discretes\\lbl272b29HprSovClosed|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Data\\lbl274b29_14BASFlow|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Data\\lbl311b29_14LHFreshAirFlow|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Discretes\\lbl272b15MprSovClosedEng3Position|_ASCB_D\\AMMTHREE\\AMMTHREE1aA429\\ammthree1000msecA429Discretes\\lbl272b29HPPRSOVClosed|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Data\\lbl274b29_14BASFlow|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Data\\lbl311b29_14RHFreshAirFlow|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Discretes\\lbl272b15MprSovClosedEng2Position|_ASCB_D\\AMMTWO\\AMMTWO1aA429\\ammtwo1000msecA429Discretes\\lbl272b29HPPRSOVClosed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone100msecA429Data\\lbl114b29_17LeftInboardBrakeTemperature|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone100msecA429Data\\lbl116b29_17RightInboardBrakeTemperature|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone100msecA429Discretes\\lbl271b20ParkBrakeValveHandlePosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl005b28_17LeftOutboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl006b28_17LeftInboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl007b28_17RightInboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl040b28_17RightOutboardWheelSpeed|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl051b28_17LeftBrakeControlValveCurrent|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl052b28_17RightBrakeControlValveCurrent|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl070b28_17LeftBrakePressure|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone12msecA429Data\\lbl072b28_17RightBrakePressure|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl113b28_17ShutoffValveCurrent|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl171b29_21LeftPilotBrakePedalPosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl172b29_21RightPilotBrakePedalPosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl173b29_21LeftCopilotBrakePedalPosition|_ASCB_D\\BCUONE\\BCUONE1aA429\\bcuone50msecA429Data\\lbl174b29_21RightCopilotBrakePedalPosition|_ASCB_D\\BCUTWO\\BCUTWO1aA429\\bcutwo100msecA429Data\\lbl050b28_17ParkEmergencyBrakeAccumulatorPressure|_ASCB_D\\CPCSCAB\\CPCSCAB1aA429\\cpcscab200msecA429Data\\lbl204b28_13CabinPressureActual|_ASCB_D\\EEC\\EEC1aA429\\eec1000msecA429Discretes\\lbl273b24ThrustReverser|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl300b29_15N1Trimmed|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl344b29_15N2MechanicalSpeed|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl345b29_17ITT|_ASCB_D\\EEC\\EEC1aA429\\eec100msecA429Data\\lbl346b29_15N1MechanicalSpeed|_ASCB_D\\EEC\\EEC1aA429\\eec200msecA429Data\\lbl134b29_17TLAPlusAutothrottleTLATrim|_ASCB_D\\EEC\\EEC1aA429\\eec50msecA429Data\\lbl133b29_17SelectedTLA|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl300b29_15N1Trimmed|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl344b29_15N2MechanicalSpeed|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl345b29_17ITT|_ASCB_D\\EEC\\EEC3aA429\\eec100msecA429Data\\lbl346b29_15N1MechanicalSpeed|_ASCB_D\\EEC\\EEC3aA429\\eec200msecA429Data\\lbl134b29_17TLAPlusAutothrottleTLATrim|_ASCB_D\\EEC\\EEC3aA429\\eec50msecA429Data\\lbl133b29_17SelectedTLA|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl300b29_15N1Trimmed|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl344b29_15N2MechanicalSpeed|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl345b29_17ITT|_ASCB_D\\EEC\\EEC5aA429\\eec100msecA429Data\\lbl346b29_15N1MechanicalSpeed|_ASCB_D\\EEC\\EEC5aA429\\eec200msecA429Data\\lbl134b29_17TLAPlusAutothrottleTLATrim|_ASCB_D\\EEC\\EEC5aA429\\eec50msecA429Data\\lbl133b29_17SelectedTLA|_ASCB_D\\FCS\\FCS1At\\atDisplayed\\atControlMode|_ASCB_D\\FCS\\FCS1At\\atStatus\\atEngaged|_ASCB_D\\FCS\\FCS1Fd\\fdModes\\fdActiveLatMode|_ASCB_D\\FCS\\FCS1Fd\\fdModes\\fdActiveVertMode|_ASCB_D\\FCS\\FCS1Fd\\fdPitRolCmds\\fdPitchCmd|_ASCB_D\\FCS\\FCS1Fd\\fdPitRolCmds\\fdRollCmd|_ASCB_D\\FMS\\FMS1FMA\\rate1000ms\\zeroFuelWeightCG|_ASCB_D\\FMS\\FMS1FMA\\rate100ms\\grossWeight|_ASCB_D\\FMS\\FMS1FMA\\rate100ms\\phaseOfFlight|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl167b28_14LeftWingOuterTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl172b28_14CenterCircuitTotalFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl177b28_14LeftWingMiddleTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl200b28_14LeftWingInnerTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl201b28_14RightWingOuterTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl202b28_14RightWingMiddleTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl203b28_14RightWingInnerTankFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl213b28_14LeftFuelUsedQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl214b28_14RightFuelUsedQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl215b28_14CenterFuelUsedQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl257b28_14LeftCircuitTotalFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel1000msecA429Data\\lbl261b28_14RightCircuitTotalFuelQuantity|_ASCB_D\\FUEL\\FUEL1aA429\\fuel100msecA429Data\\lbl345b28_17CenterFuelFlow|_ASCB_D\\FUEL\\FUEL1aA429\\fuel100msecA429Data\\lbl346b28_17RightFuelFlow|_ASCB_D\\FUEL\\FUEL1aA429\\fuel100msecA429Data\\lbl347b28_17LeftFuelFlow|_ASCB_D\\GGF\\GGF1GGA\\hsiData\\leftMnGearState|_ASCB_D\\GGF\\GGF1GGA\\hsiData\\noseGearState|_ASCB_D\\GGF\\GGF1GGA\\hsiData\\rightMnGearState|_ASCB_D\\GIOFOUR\\GIOFOUR1aAnalog\\gioFour50msecVersatileAnalogData\\hydSysBPress|_ASCB_D\\GIOFOUR\\GIOFOUR1aDiscrete\\gioFour50msecDiscretes\\airbrakePanelInboardRH|_ASCB_D\\GIOFOUR\\GIOFOUR1aDiscrete\\gioFour50msecDiscretes\\casov2FullClosedSW|_ASCB_D\\GIOONE\\GIOONE1aAnalog\\gioOne50msecVersatileAnalogData\\hydSysAPress|_ASCB_D\\GIOONE\\GIOONE1aAnalog\\gioOne50msecVersatileAnalogData\\oxyTemperatureSignal|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\airbrakePanelOutboardLH|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\backupSlatSwIndic|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\casov1FullClosedSW|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\casov3FullClosedSW|_ASCB_D\\GIOONE\\GIOONE1aDiscrete\\gioOne50msecDiscretes\\flapSlatLeverPosSF3|_ASCB_D\\GIOTHREE\\GIOTHREE1aDiscrete\\gioThree50msecDiscretes\\airbrakePanelInboardLH|_ASCB_D\\GIOTWO\\GIOTWO1aAnalog\\gioTwo50msecVersatileAnalogData\\hydSysCPress|_ASCB_D\\GIOTWO\\GIOTWO1aAnalog\\gioTwo50msecVersatileAnalogData\\oxyPressureSignal|_ASCB_D\\GIOTWO\\GIOTWO1aDiscrete\\gioTwo50msecDiscretes\\airbrakePanelOutboardRH|_ASCB_D\\GIOTWO\\GIOTWO1aDiscrete\\gioTwo50msecDiscretes\\flapSlatLeverPosSF1|_ASCB_D\\GIOTWO\\GIOTWO1aDiscrete\\gioTwo50msecDiscretes\\flapSlatLeverPosSF2|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\altitude|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\latitude|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\latitudeFine|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\longitude|_ASCB_D\\GPS\\GPS1aGps429\\gps50msec429\\longitudeFine|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl137b29_14HybridTrackAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl175b28_14HybridGroundSpeed|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl263b29_17HybridFlightPathAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl266b29_14HybridNSVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl267b29_14HybridEWVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs100msecHybrid429\\lbl345b29_14HybridVerticalVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyLatAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyLongAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyNormAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyPitchRate|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyRollRate|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\bodyYawRate|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\flightPathAccel|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\inertialVerticalSpd|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\pitchAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\rollAngle|_ASCB_D\\IRS\\IRS1aIrs429\\irs12msec429\\trueHeading|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\ewVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\nsVelocity|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\windDirectionTrue|_ASCB_D\\IRS\\IRS1aIrs429\\irs50msec429\\windSpeed|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b20LMGUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b21LMGDownlock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b26NLGUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl270b27NLGDownlock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl271b28RMGUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl271b29RMGDownlock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl363b19LMGDoorUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl364b25RMGDoorUplock|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl365b28GearHandleDown|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu100msecA429Discretes\\lbl365b29GearHandleUp|_ASCB_D\\LGSCU\\LGSCU1aA429\\lgscu50msecA429Data\\lbl376b29_17NosewheelAngle|_ASCB_D\\LGSCU\\LGSCU2aA429\\lgscu100msecA429Discretes\\lbl365b28GearHandleDown|_ASCB_D\\LGSCU\\LGSCU2aA429\\lgscu100msecA429Discretes\\lbl365b29GearHandleUp|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b11Throttle1IdleDiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b13Throttle2IdleDiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b15Throttle3IdleDiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b17Throttle1TODiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b19Throttle2TODiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b21Throttle3TODiscrete1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b27ABManualExtendCmd1|_ASCB_D\\MAIC\\MAIC1aA429\\maic1000msecCMCData\\lbl117b28ABManualExtendCmd2|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl100b29_18LhAileronPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl101b29_18RhAileronPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl102b29_18LhElevatorPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl103b29_18RhElevatorPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl104b29_18LhSpoilerPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl105b29_18RhSpoilerPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl106b29_18PrimaryRudderPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl120b29_18PilotPitchControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl121b29_18PilotRollControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl123b29_18CopilotPitchControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic100msecA429Data\\lbl124b29_18CopilotRollControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl110b29_18HorizontalStabilizerPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl111b29_18LhInboardFlapPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl112b29_18RhInboardFlapPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl113b29_18LhInboardFlapPosition2_1|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl114b29_18RhInboardFlapPosition2_2|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl115b29_18CombinedFlapPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl127b29_18AirbrakesLeverPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Data\\lbl240b29_11PitchElevatorTrimOrder|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b11LhOutboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b12RhOutboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b13LhMiddleSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b14RhMiddleSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b15LhInboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b16RhInboardSlatExtension|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b17LhOutboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b18RhOutboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b19LhMiddleSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b20RhMiddleSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b21LhInboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl116b22RhInboardSlatRetraction|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b11APEngagementStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b12PfcsNoseLandingGearWOWStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b13PfcsLhMainLandingGearWOWStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic200msecA429Discretes\\lbl277b14PfcsRhMainLandingGearWOWStatus|_ASCB_D\\MAIC\\MAIC1aA429\\maic50msecA429Data\\lbl122b29_18PilotYawControlPosition|_ASCB_D\\MAIC\\MAIC1aA429\\maic50msecA429Data\\lbl125b29_18CopilotYawControlPosition|_ASCB_D\\MRC\\MRC1Cluster\\cat3Nav100msec\\cat3GsDev|_ASCB_D\\MRC\\MRC1Cluster\\cat3Nav100msec\\cat3LocDev|_ASCB_D\\PPDBL\\PPDBL1aA429\\ppdbl200msecA429Data\\lbl002b28_17PointOfRegulationVoltage|_ASCB_D\\PPDBL\\PPDBL1aA429\\ppdbl200msecA429Data\\lbl006b28_18LoadCurrent|_ASCB_D\\PPDBR\\PPDBR1aA429\\ppdbr200msecA429Data\\lbl002b28_17PointOfRegulationVoltage|_ASCB_D\\PPDBR\\PPDBR1aA429\\ppdbr200msecA429Data\\lbl006b28_18LoadCurrent|_ASCB_D\\RADALT\\RADALT1aA429\\radalt50msec429\\radioHeight|             Trigger|Part|                date|\n+-------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------+--------------------------------------------------------------------+--------------------------------------------------------------+-------------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+----------------------------------------------------------------------------+-----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+-----------------------------------------------------------------------------------------+------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------------------+------------------------------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------------------------+----------------------------------------------------------------------+--------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------+--------------------------------------------+-------------------------------------+------------------------------------------+-------------------------------------------+------------------------------------------+-----------------------------------------+-----------------------------------------------+-----------------------------------------+-------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+---------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------+---------------------------------------------------------------------+--------------------------------------------------------------------+-------------------------------------------+-----------------------------------------+--------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------------+---------------------------------------------------------------------------+--------------------------------------------------------------------------+----------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------+---------------------------------------------+-------------------------------------------------+----------------------------------------------+--------------------------------------------------+------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------+------------------------------------------------------------------------------+-------------------------------------------------+--------------------------------------------------+--------------------------------------------------+--------------------------------------------------+-------------------------------------------------+------------------------------------------------+----------------------------------------------------+--------------------------------------------------------+-----------------------------------------------+----------------------------------------------+------------------------------------------------+-----------------------------------------------+-----------------------------------------------+------------------------------------------------------+----------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+----------------------------------------------------------------------+------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+---------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------+-----------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+--------------------------------------------------------------------------+--------------------------------------------------------------------------+-------------------------------------------------------------------------+-------------------------------------------------------------------------+-----------------------------------------------------------------------------+---------------------------------------------------------------------------------+--------------------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+------------------------------------------------------------------------------------+-----------------------------------------------------------------------------+-----------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------+------------------------------------------------------------------------------+------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+-------------------------------------------------------------------------------+-------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+----------------------------------------------------------------------------------+----------------------------------------------------------------------------------+--------------------------------------------------------------------------------+--------------------------------------------------------------------------------+---------------------------------------------------------------------------------+---------------------------------------------------------------------------------+----------------------------------------------------------------------------+--------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+----------------------------------------------------------------------------------------+------------------------------------------------------------------------------+--------------------------------------------------------------------------------+------------------------------------------------+-------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------------------------------------------------------------+----------------------------------------------------------------------+-------------------------------------------------------+--------------------+----+--------------------+\n|          497|                                                         9.33593|                                                             2.90416|                                                     -0.253028|                                                2.93554|                                          894.468|                                           967.5|                                                         9.85546|                                                             3.07582|                                                     -0.169257|                                                3.51171|                                          894.304|                                         967.296|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        3.625|                                                                                        0|                                                                             0|                                                                                       71|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.7656|                                                               88.5468|                                                   603.5|                                                               68.9687|                                                                        15.3437|                                                        15.0312|                                                       69.7812|                                                               88.4375|                                                     613|                                                               69.2031|                                                                        14.9687|                                                        14.5312|                                                       69.8437|                                                               88.6406|                                                   619.5|                                                                69.375|                                                                        15.8437|                                                        15.4062|                                           3|                                    1|                                       103|                                         13|                                   3.92355|                                0.0851453|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3097|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3134|                                                                        1737.53|                                                                            0|                                                                        0|                                                                        0|                                      3290.37|                                       51.195|                                      1.17367e-05|                                     -0.878391|                                       9.47185e-05|                                                                -155.994|                                                                    219.5|                                                                      4.04294|                                                                -200.625|                                                                 -89.375|                                                                          1587|                                       0.00522994|                                          0.133556|                                       -0.00680922|                                         -0.214843|                                       -0.0107421|                                       0.0214843|                                           0.0172996|                                                  1577.5|                                        6.62526|                                     0.0396537|                                        -153.746|                                       -89.4843|                                       -200.687|                                              -42.1689|                                       9.16699|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.162342|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                -0.0878906|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                          -0.3125|                                                                          -0.125|                                                                              -0.25|                                                                           -0.0625|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                    0.00600433|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                        -0.125|                                                                          -0.125|                                     -0.00439403|                                       0.00112289|                                                                             28.507|                                                               118.377|                                                                            28.4834|                                                               254.931|                                                3004.87|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          498|                                                         9.33593|                                                             2.88081|                                                      -0.28324|                                                2.95898|                                          894.359|                                         967.484|                                                         9.85546|                                                             3.04011|                                                     -0.266761|                                                3.48242|                                          894.218|                                         967.234|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        3.625|                                                                                        0|                                                                             0|                                                                                       72|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               1|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.7968|                                                               88.4687|                                                     604|                                                               69.0156|                                                                        15.3437|                                                        15.0312|                                                       69.7812|                                                               88.4375|                                                     613|                                                               69.2031|                                                                        14.9687|                                                        14.5625|                                                       69.8437|                                                               88.6406|                                                   619.5|                                                                69.375|                                                                        15.8125|                                                        15.4375|                                           3|                                    1|                                       103|                                         13|                                   3.92629|                                 0.079652|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3097|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3295.62|                                      51.1947|                                      0.000169569|                                     -0.878584|                                         0.0001347|                                                                -155.994|                                                                    219.5|                                                                      4.04294|                                                                -200.625|                                                                 -89.375|                                                                          1587|                                       0.00671004|                                          0.133251|                                       -0.00673293|                                         -0.242187|                                       -0.0507812|                                       0.0268554|                                           0.0182609|                                                 1578.12|                                        6.60672|                                     0.0382804|                                        -153.744|                                          -89.5|                                       -200.718|                                              -41.5242|                                       9.20996|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.128165|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                -0.0878906|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                          -0.0625|                                                                         -0.0625|                                                                             -0.125|                                                                             0.125|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                    0.00576019|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                        -0.125|                                                                          -0.125|                                      -0.0313438|                                      -0.00571221|                                                                             28.507|                                                                116.16|                                                                            28.4834|                                                               254.488|                                                3004.87|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          499|                                                         9.33593|                                                             2.78056|                                                     -0.307959|                                                2.95898|                                          894.367|                                         967.601|                                                          9.7832|                                                             3.02775|                                                     -0.268134|                                                 3.4746|                                          894.179|                                         966.875|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        4.875|                                                                                        0|                                                                             0|                                                                                       72|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3142|                                                                             14.8032|                                                                     0|                                                       69.7968|                                                               88.4687|                                                     604|                                                               69.0156|                                                                        15.3437|                                                        15.0625|                                                       69.7968|                                                               88.4687|                                                     613|                                                               69.1875|                                                                        14.9687|                                                        14.5625|                                                       69.9062|                                                               88.4687|                                                     620|                                                               69.4062|                                                                        15.8125|                                                        15.4687|                                           3|                                    1|                                       103|                                         13|                                   3.91531|                                 0.079652|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3097|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3295.62|                                      51.1947|                                      0.000169569|                                     -0.878584|                                         0.0001347|                                                                -155.994|                                                                    219.5|                                                                      4.04294|                                                                -200.625|                                                                 -89.375|                                                                          1589|                                       0.00231551|                                           0.13055|                                        -0.0159034|                                         -0.232421|                                         0.189941|                                       0.0205078|                                           0.0151481|                                                 1578.12|                                         6.5923|                                     0.0396537|                                        -153.742|                                       -89.5156|                                       -200.734|                                              -41.8895|                                       9.18652|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                               0.0939873|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                -0.0878906|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                           -0.125|                                                                         -0.0625|                                                                             -0.125|                                                                             0.125|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                    0.00576019|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                        -0.125|                                                                           -0.25|                                      -0.0606371|                                       -0.0115708|                                                                             28.507|                                                                116.16|                                                                            28.4834|                                                               254.488|                                                3028.62|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          500|                                                         9.33593|                                                             2.70091|                                                     -0.292853|                                                2.95898|                                          894.156|                                         967.117|                                                          9.7832|                                                             2.87532|                                                     -0.257148|                                                 3.4746|                                          893.984|                                         966.804|                                                                  32.5|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                          35|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        4.875|                                                                                        0|                                                                             0|                                                                                       73|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             79|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.8437|                                                               88.4687|                                                     604|                                                               69.0468|                                                                         15.375|                                                        15.0625|                                                       69.8125|                                                               88.4218|                                                   613.5|                                                               69.2187|                                                                         14.875|                                                        14.5937|                                                       69.9687|                                                               88.5156|                                                     620|                                                               69.4687|                                                                        15.7812|                                                           15.5|                                           3|                                    1|                                       103|                                         13|                                   3.92629|                                0.0741588|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2322|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2248|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3096|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3300.87|                                      51.1945|                                      0.000155655|                                     -0.878584|                                       3.10329e-06|                                                                -155.989|                                                                  219.625|                                                                      4.08688|                                                                 -200.75|                                                                 -89.375|                                                                          1590|                                        0.0134696|                                          0.132533|                                        -0.0346412|                                         -0.219726|                                         0.163574|                                      -0.0146484|                                           0.0147514|                                                 1572.62|                                        6.55316|                                     0.0767325|                                         -153.74|                                       -89.5468|                                       -200.781|                                              -44.2804|                                       9.04296|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.128165|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                 -0.175781|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                           -0.125|                                                                         -0.0625|                                                                            -0.0625|                                                                            0.0625|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                     0.0097351|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                         -0.25|                                                                           -0.25|                                      -0.0805566|                                      -0.00961798|                                                                             28.507|                                                               111.726|                                                                            28.4834|                                                               258.035|                                                 3055.5|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|\n|          501|                                                         9.33593|                                                             2.77644|                                                     -0.294227|                                                 2.9414|                                          894.093|                                         967.062|                                                          9.7832|                                                             2.93712|                                                     -0.237922|                                                3.47851|                                          893.929|                                         966.726|                                                                    34|                                                                                0|                                                                                1|                                                                               1|                                                                                              0|                                                                            1|                                                                       35.25|                                                                              15.25|                                                                                              0|                                                                                   1|                                                                  35.5|                                                                        4.875|                                                                                        0|                                                                             0|                                                                                       73|                                                                                        53|                                                                                           0|                                                                                  0|                                                                                 0|                                                                                  0|                                                                                   0|                                                                                      0.9|                                                                                       0.9|                                                                            69|                                                                             80|                                                                               0|                                                                                      -1|                                                                                        0|                                                                                        -1|                                                                                          0|                                                                                               3143|                                                                             14.8032|                                                                     0|                                                       69.8593|                                                               88.4375|                                                   603.5|                                                               69.0625|                                                                         15.375|                                                        15.0937|                                                       69.8125|                                                               88.4218|                                                   613.5|                                                               69.2187|                                                                         14.875|                                                        14.5937|                                                       69.9687|                                                               88.5156|                                                     620|                                                               69.4687|                                                                        15.7812|                                                           15.5|                                           3|                                    1|                                       103|                                         13|                                   3.92629|                                0.0686656|                                            340|                                    44111|                                          0|                                                                                     0|                                                                                   2328|                                                                                      0|                                                                                    26|                                                                                      0|                                                                                       0|                                                                                     29|                                                                          113|                                                                           119|                                                                            120|                                                                                 2249|                                                                                  2239|                                                                  1272|                                                                 1290|                                                                1268|                                          0|                                        0|                                           0|                                                                         3096|                                                                              0|                                                                          0|                                                                      3071|                                                                           21.3137|                                                                            0|                                                                      0|                                                                       0|                                                                       1|                                                                        0|                                                                                 0|                                                                      3133|                                                                        1737.23|                                                                            0|                                                                        0|                                                                        0|                                      3300.87|                                      51.1945|                                      0.000155655|                                     -0.878584|                                       3.10329e-06|                                                                -155.989|                                                                  219.625|                                                                      4.08688|                                                                 -200.75|                                                                 -89.375|                                                                          1590|                                       0.00211715|                                          0.133815|                                        -0.0263099|                                         -0.138671|                                        0.0830078|                                      -0.0292968|                                            0.020153|                                                  1569.5|                                        6.53874|                                     0.0870322|                                        -153.739|                                       -89.5625|                                       -200.812|                                              -43.7255|                                       9.07617|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                     1|                                                                       0|                                                                         1|                                                                         1|                                                                          0|                                                                        1|                                                                0.128165|                                                                          0|                                                                        1|                                                                          0|                                                                          0|                                                                          0|                                                                        0|                                                                        0|                                                                        0|                                                                      1|                                                                      1|                                                               -0.0878906|                                                                0.0878906|                                                                 -0.175781|                                                                 -0.175781|                                                                        0|                                                                        0|                                                                   -0.0878906|                                                                          -0.0625|                                                                         -0.0625|                                                                             -0.125|                                                                            0.0625|                                                                            -1.75781|                                                                     0.175781|                                                                     0.175781|                                                                       0.0878906|                                                                       0.0878906|                                                                    0.175781|                                                                             0|                                                                     0.0097351|                                                                                0|                                                                                0|                                                                              0|                                                                              0|                                                                               0|                                                                               0|                                                                                 1|                                                                                 1|                                                                               1|                                                                               1|                                                                                1|                                                                                1|                                                                           1|                                                                                     0|                                                                                       0|                                                                                       0|                                                                         -0.25|                                                                           -0.25|                                      -0.0805566|                                      -0.00629807|                                                                             28.507|                                                               111.726|                                                                            28.4834|                                                               258.035|                                                 3055.5|28 NOV 2022 16:19:57|  16|28 11 2022 16:20:...|"},{"type":"HTML","data":"<div class=\"result-alert alert-warning\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button><strong>Output is truncated</strong> to 102400 bytes. Learn more about <strong>ZEPPELIN_INTERPRETER_OUTPUT_LIMIT</strong></div>"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_0934<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_0934/</a>"}]},"apps":[],"jobName":"paragraph_1693905765188_-1913536832","id":"20230126-152839_1972018152","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:67"},{"text":"%pyspark\ndf.write.parquet(\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet\")","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"An error occurred while calling o83305.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\nTraceback (most recent call last):\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/readwriter.py\", line 804, in parquet\n    self._jwrite.parquet(path)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_0934/container_e96_1661169780396_0934_01_000001/py4j-0.10.6-src.zip/py4j/protocol.py\", line 320, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o83305.parquet.\n: org.apache.hadoop.security.AccessControlException: Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\n\tat sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\n\tat sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\n\tat java.lang.reflect.Constructor.newInstance(Constructor.java:423)\n\tat org.apache.hadoop.ipc.RemoteException.instantiateException(RemoteException.java:106)\n\tat org.apache.hadoop.ipc.RemoteException.unwrapRemoteException(RemoteException.java:73)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3101)\n\tat org.apache.hadoop.hdfs.DFSClient.mkdirs(DFSClient.java:3069)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1181)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem$25.doCall(DistributedFileSystem.java:1177)\n\tat org.apache.hadoop.fs.FileSystemLinkResolver.resolve(FileSystemLinkResolver.java:81)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirsInternal(DistributedFileSystem.java:1195)\n\tat org.apache.hadoop.hdfs.DistributedFileSystem.mkdirs(DistributedFileSystem.java:1169)\n\tat org.apache.hadoop.fs.FileSystem.mkdirs(FileSystem.java:1925)\n\tat org.apache.hadoop.mapreduce.lib.output.FileOutputCommitter.setupJob(FileOutputCommitter.java:343)\n\tat org.apache.spark.internal.io.HadoopMapReduceCommitProtocol.setupJob(HadoopMapReduceCommitProtocol.scala:162)\n\tat org.apache.spark.sql.execution.datasources.FileFormatWriter$.write(FileFormatWriter.scala:176)\n\tat org.apache.spark.sql.execution.datasources.InsertIntoHadoopFsRelationCommand.run(InsertIntoHadoopFsRelationCommand.scala:154)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult$lzycompute(commands.scala:104)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.sideEffectResult(commands.scala:102)\n\tat org.apache.spark.sql.execution.command.DataWritingCommandExec.doExecute(commands.scala:122)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:131)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$execute$1.apply(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.SparkPlan$$anonfun$executeQuery$1.apply(SparkPlan.scala:155)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.sql.execution.SparkPlan.executeQuery(SparkPlan.scala:152)\n\tat org.apache.spark.sql.execution.SparkPlan.execute(SparkPlan.scala:127)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd$lzycompute(QueryExecution.scala:80)\n\tat org.apache.spark.sql.execution.QueryExecution.toRdd(QueryExecution.scala:80)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter$$anonfun$runCommand$1.apply(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.DataFrameWriter.runCommand(DataFrameWriter.scala:654)\n\tat org.apache.spark.sql.DataFrameWriter.saveToV1Source(DataFrameWriter.scala:273)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:267)\n\tat org.apache.spark.sql.DataFrameWriter.save(DataFrameWriter.scala:225)\n\tat org.apache.spark.sql.DataFrameWriter.parquet(DataFrameWriter.scala:547)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.AccessControlException): Permission denied: user=e854129, access=WRITE, path=\"/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/SN466/IRYS2_0580466_20221128155424ttest.parquet/_temporary/0\"\n\tat org.apache.hadoop.ipc.Client.getRpcResponse(Client.java:1554)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1498)\n\tat org.apache.hadoop.ipc.Client.call(Client.java:1398)\n\tat org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:233)\n\tat com.sun.proxy.$Proxy10.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.mkdirs(ClientNamenodeProtocolTranslatorPB.java:610)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:290)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:202)\n\tat org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:184)\n\tat com.sun.proxy.$Proxy11.mkdirs(Unknown Source)\n\tat org.apache.hadoop.hdfs.DFSClient.primitiveMkdir(DFSClient.java:3099)\n\t... 41 more\n\n"}]},"apps":[],"jobName":"paragraph_1693905765201_-1906226603","id":"20230126-152912_1271219367","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:68"},{"text":"%md \n#Preprocecing new raw ACMF csv files VERSION 2 :\n## Preprocessing of the newly imported data (Search new raw files in \"/datalake/prod/c2/ddd/crm/acmf/New_raw_files\")\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"tableHide":false,"editorSetting":{"editOnDblClick":true,"language":"markdown"},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<h1>Preprocecing new raw ACMF csv files VERSION 2 :</h1>\n<h2>Preprocessing of the newly imported data (Search new raw files in &ldquo;/datalake/prod/c2/ddd/crm/acmf/New_raw_files&rdquo;)</h2>\n"}]},"apps":[],"jobName":"paragraph_1693905765214_-1909689343","id":"20230831-095449_480931599","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:69"},{"text":"%pyspark\nimport sys\nfrom pyspark import SparkContext, SparkConf\nimport pyspark.sql.functions as F\nfrom pyspark.sql import SparkSession \nfrom pyspark.sql.functions import pandas_udf, to_date, to_timestamp, substring, expr\nfrom pyspark.sql.types import StructType, StructField, IntegerType, StringType, FloatType, DateType, BooleanType, DoubleType, TimestampType, ArrayType, BinaryType\nfrom pyspark.sql.window import Window\nimport pandas as pd\nfrom datetime import datetime, timedelta\nimport subprocess, re\nimport os\nimport dateutil.parser as dparser","user":"e854129","dateUpdated":"2023-09-06T09:42:18+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693905765226_-1926618294","id":"20230126-153011_133686435","dateCreated":"2023-09-05T11:22:45+0200","dateStarted":"2023-09-06T09:42:19+0200","dateFinished":"2023-09-06T09:42:20+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:70"},{"text":"%pyspark\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\n\ndef verify_file_extension(file_path, desired_extension):\n\t_, file_extension = os.path.splitext(file_path)\n\treturn file_extension.lower() == '.' + desired_extension.lower()\n\ndef extract_filenames_from_path_list(path_list):\n\tfilenames = [os.path.basename(path) for path in path_list]\n\treturn filenames\n\ndef identify_file_or_folder(path):\n\tif os.path.isfile(path):\n\t\treturn \"File\"\n\telif os.path.isdir(path):\n\t\treturn \"Folder\"\n\telse:\n\t\treturn \"Neither\"\n\ndef identify_extension(file_path):\n\t_, extension = os.path.splitext(file_path)\n\treturn extension.lower() if extension else None\n\ndef extract_filename_with_extension(file_path):\n\treturn os.path.basename(file_path)\n\ndef extract_filename_without_extension(file_path):\n\tfilename_with_extension = os.path.basename(file_path)\n\tfilename_without_extension, _ = os.path.splitext(filename_with_extension)\n\treturn filename_without_extension\n\n#def validate_file_path(file_path, desired_extension):\n\n\n#extraction du nom du fichier a partir du chemin complet\ndef extract_name(path):\n\tfor i in range (1, len(path)):\n\t\tif path[-i]=='/':\n\t\t\treturn (path[len(path)-i+1:])\n\n# prend en entree une liste de noms de fichiers et renvoie 2 liste : une avec la premiere moitie du nom, l'autre avec la deuxieme moitie\ndef divide_name(file_name_list):\n\tlist_first_half = []\n\tlist_second_half = []\n\t\n\tfor numero_fichier in range (0, len(file_name_list)):\n\t\tfor i in range (1, len(file_name_list[numero_fichier])):\n\t\t\tif file_name_list[numero_fichier][-i]=='_':\n\t\t\t\tlist_second_half.append(file_name_list[numero_fichier][len(file_name_list[numero_fichier])-i+1:])\n\t\t\t\tlist_first_half.append(file_name_list[numero_fichier][:len(file_name_list[numero_fichier])-i+1])\n\t\t\t\tbreak\n\t\t\t\t\n\treturn list_first_half, list_second_half\n\ndef list_sub_folder_adress(path):\n\tList_Sub_Folders_Adress = []\n\tfor dossier in path:\n\t\tnouveaux_dossiers = listdir(dossier)\n\t\tfor sous_dossier in nouveaux_dossiers:\n\t\t\tList_Sub_Folders_Adress.append(sous_dossier)\n\treturn List_Sub_Folders_Adress\n\n# Fonction permettant a partir d'une adresse de recuperer la liste des sous-dossiers qu'elle contient. Level represente le niveau des sous dossiers, 0 = l'adresse, 1 = les sous dossier, 2 = les sous sous dossiers... \ndef list_sub_folder_adress_rec(path_string, level):\n\tList_Sub_Folders_Adress = []\n\tif level<=0:\n\t\tList_Sub_Folders_Adress.append(path_string)\n\tif level==1:\n\t\tList_Sub_Folders_Adress = listdir(path_string)\n\telse:\n\t\tinit_folder = listdir(path_string)\n\t\tfor i in range (1, level):\n\t\t\tnew_folder = list_sub_folder_adress(init_folder)\n\t\t\tinit_folder = new_folder\n\t\tfor new_adress in init_folder:\n\t\t\tList_Sub_Folders_Adress.append(new_adress)\n\treturn List_Sub_Folders_Adress\n\n\ndef files_detected_in_New_raw_files_Dir(New_raw_files_folder_path):\n\t# level 1 investigate 1 level of subfolder and get the files\n\tNumber_of_subFolder_levels = 1\n\tList_of_new_files = list_sub_folder_adress_rec(New_raw_files_folder_path,  Number_of_subFolder_levels)\n\tNumber_of_new_files_detected = len(List_of_new_files)\n\treturn List_of_new_files\n\ndef strip_non_numeric_char_from_string(my_string):\n\tnon_numeric_string = re.sub(\"[^0-9]\", \"\", my_string)\n\treturn non_numeric_string\n\ndef get_date_from_ACMF_csv_file(path):\n\tfile_name = extract_name(path)\n\tfile_name_ending = file_name.split('_')[-1]\n\tfile_writing_date = dparser.parse(file_name_ending,fuzzy=True, dayfirst=False, yearfirst=True)\n\treturn file_writing_date\n\t\ndef get_date_as_numeric_string_from_ACMF_csv_file(file_name):\n\tfile_date = get_date_from_ACMF_csv_file(file_name)\n\tfile_date_as_numeric_string = strip_non_numeric_char_from_string(str(file_date))\n\treturn file_date_as_numeric_string\n\ndef get_aircraft_complete_ID_from_file_name(file_name):\n\tcomplete_ID = file_name.split('_')[-2]\n\treturn complete_ID\n\ndef get_aircraft_SN_only_digits_from_file_name(file_name):\n\tcomplete_ID = get_aircraft_complete_ID_from_file_name(file_name)\n\tSN_only_digits = complete_ID[-3:]\n\treturn SN_only_digits\n\ndef get_aircraft_SN_complete_from_file_name(file_name):\n\tSN_only_digits = get_aircraft_SN_only_digits_from_file_name(file_name)\n\tSN_only_complete = \"SN\" + SN_only_digits\n\treturn SN_only_complete\n\ndef get_aircraft_Model_ID_from_file_name(file_name):\n\tcomplete_ID = get_aircraft_complete_ID_from_file_name(file_name)\n\tModel_ID = complete_ID[:4]\n\treturn Model_ID\n\ndef get_date_from_ACMF_csv_file_name(file_name):\n\tfile_name_ending = file_name.split('_')[-1]\n\tfile_date_in_file_name = dparser.parse(file_name_ending,fuzzy=True, dayfirst=False, yearfirst=True)\n\treturn file_date_in_file_name\n\ndef get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name):\n\tfile_date = get_date_from_ACMF_csv_file_name(file_name)\n\tfile_date_as_numeric_string = strip_non_numeric_char_from_string(str(file_date))\n\treturn file_date_as_numeric_string\n\ndef get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name):\n\tfile_date_as_numeric_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name)\n\traw_file_date_year_string = \"Year_\" +  file_date_as_numeric_string[0:4]\n\traw_file_date_month_string = \"Month_\" +  file_date_as_numeric_string[4:6]\n\traw_file_date_day_string = \"Day_\" +  file_date_as_numeric_string[6:8]\n\treturn raw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string\n\ndef old_version_create_basic_log_df(file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder = False, copy_to_raw_dated_folder = False, valid_file_name = False, Flight_file_name = \"None\"):\n\tfields = [StructField(\"file_name_no_extension\", StringType(),False),\n\t  StructField(\"File_name_with_extension\", StringType(),False),\n\t  StructField(\"File_type\", StringType(),False),\n\t  StructField(\"File_date_as_TimestampType\", TimestampType(),False),\n\t  StructField(\"File_SN\", StringType(),False),\n\t  StructField(\"File_aircraft_model\", StringType(),False),\n\t  StructField(\"Raw_file_legacy_folder_path\", StringType(),False),\n\t  StructField(\"Raw_file_dated_folder_path\", StringType(),False),\n\t  StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),False),\n\t  StructField(\"Raw_file_dated_folder_copied\", BooleanType(),False),\n\t  StructField(\"Valid_file_name\", BooleanType(),False),\n\t  StructField(\"Flight_file_name\", StringType(),False),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder, copy_to_raw_dated_folder, valid_file_name, Flight_file_name]]\n\n\tdf = spark.createDataFrame(data, schema)\n\treturn df\n\ndef old_version_2_create_basic_log_df(file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder = False, copy_to_raw_dated_folder = False, valid_file_name = None, Flight_file_name = None):\n\tfields = [StructField(\"file_name_no_extension\", StringType(),True),\n\t  StructField(\"File_name_with_extension\", StringType(),True),\n\t  StructField(\"File_type\", StringType(),True),\n\t  StructField(\"File_date_as_TimestampType\", TimestampType(),True),\n\t  StructField(\"File_SN\", StringType(),True),\n\t  StructField(\"File_aircraft_model\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_dated_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),True),\n\t  StructField(\"Raw_file_dated_folder_copied\", BooleanType(),True),\n\t  StructField(\"Valid_file_name\", BooleanType(),True),\n\t  StructField(\"Flight_file_name\", StringType(),True),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder, copy_to_raw_dated_folder, valid_file_name, Flight_file_name]]\n\n\tdf = spark.createDataFrame(data, schema)\n\t# Add a column with the curreent_timestamp to trace the date of the last modification\n\tdf = df.withColumn(\"Update_Date\", F.current_timestamp()) \n\treturn df\n\t\ndef old_version_3_create_basic_log_df(file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder = None, copy_to_raw_dated_folder = None, valid_file_name = None, Flight_file_name = None, TRD_start_file_name = None, MUX_start_file_name = None, IRYS2_in_file_name = None, PERFOS_in_file_name = None, FAIL_in_file_name = None, Is_Vol = None, IRYS2_or_PERFOS = None, Is_System = None, System_Name = None):\n\tfields = [StructField(\"file_name_no_extension\", StringType(),True),\n\t  StructField(\"File_name_with_extension\", StringType(),True),\n\t  StructField(\"File_type\", StringType(),True),\n\t  StructField(\"File_date_as_TimestampType\", TimestampType(),True),\n\t  StructField(\"File_SN\", StringType(),True),\n\t  StructField(\"File_aircraft_model\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_dated_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),True),\n\t  StructField(\"Raw_file_dated_folder_copied\", BooleanType(),True),\n\t  StructField(\"Valid_file_name\", BooleanType(),True),\n\t  StructField(\"Flight_file_name\", StringType(),True),\n\t  StructField(\"TRD_starts_file_name\", BooleanType(),True),\n\t  StructField(\"MUX_starts_file_name\", BooleanType(),True),\n\t  StructField(\"IRYS2_in_file_name\", BooleanType(),True),\n\t  StructField(\"PERFOS_in_file_name\", BooleanType(),True),\n\t  StructField(\"FAIL_in_file_name\", BooleanType(),True),\n\t  StructField(\"Is_Vol\", BooleanType(),True),\n\t  StructField(\"IRYS2_or_PERFOS\", StringType(),True),\n\t  StructField(\"Is_System\", BooleanType(),True),\n\t  StructField(\"System_Name\", StringType(),True),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[file_name_without_extension, file_name_with_extension, file_type, file_date_as_Timestamp, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder, copy_to_raw_dated_folder, valid_file_name, Flight_file_name, TRD_start_file_name, MUX_start_file_name, IRYS2_in_file_name, PERFOS_in_file_name, FAIL_in_file_name, Is_Vol, IRYS2_or_PERFOS, Is_System, System_Name]]\n\n\tdf = spark.createDataFrame(data, schema)\n\t# Add a column with the curreent_timestamp to trace the date of the last modification\n\tdf = df.withColumn(\"Update_Date\", F.current_timestamp()) \n\treturn df\n\n##################################################################\n# Call this function for a single SN subfolder\ndef log_files_in_New_raw_files(New_raw_files_Dir_path, Log_files_Folder_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_with_extension = extract_filename_with_extension(new_raw_file_path)\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\tfile_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension)\n\t\t\tfile_aircraft_model = get_aircraft_Model_ID_from_file_name(file_name_without_extension)\n\t\t\tfile_date_as_dateTime = get_date_from_ACMF_csv_file_name(file_name_without_extension)\n\t\t\tfile_date_as_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\traw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string = get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\tcopy_to_legacy_folder_path = legacy_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + file_name_with_extension\n\t\t\tcopy_to_dated_folder_path = dated_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + raw_file_date_year_string + \"/\" + raw_file_date_month_string + \"/\" + raw_file_date_day_string + \"/\" + file_name_with_extension\n\t\t\t# Create a log df with the previous informations\n\t\t\tlog_df = create_basic_log_df(file_name_without_extension, file_name_with_extension,file_date_as_dateTime, file_SN, file_aircraft_model, copy_to_legacy_folder_path, copy_to_dated_folder_path)\n\t\t\t# save the df\n\t\t\tlog_file_name = \"Log_Row_ACMF_\" + file_name_without_extension + \".csv\"\n\t\t\tlog_file_save_path = Log_files_Folder_path + \"/\" + log_file_name\n\t\t\tlog_df.coalesce(1).write.mode(\"overwrite\").csv(log_file_save_path)\n\ndef parquet_log_files_in_New_raw_files(New_raw_files_Dir_path, Log_files_Folder_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_with_extension = extract_filename_with_extension(new_raw_file_path)\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\tfile_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension)\n\t\t\tfile_aircraft_model = get_aircraft_Model_ID_from_file_name(file_name_without_extension)\n\t\t\tfile_date_as_dateTime = get_date_from_ACMF_csv_file_name(file_name_without_extension)\n\t\t\tfile_date_as_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\traw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string = get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\tcopy_to_legacy_folder_path = legacy_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + file_name_with_extension\n\t\t\tcopy_to_dated_folder_path = dated_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + raw_file_date_year_string + \"/\" + raw_file_date_month_string + \"/\" + raw_file_date_day_string + \"/\" + file_name_with_extension\n\t\t\t# Create a log df with the previous informations\n\t\t\tlog_df = create_basic_log_df(file_name_without_extension, file_name_with_extension,file_date_as_dateTime, file_SN, file_aircraft_model, copy_to_legacy_folder_path, copy_to_dated_folder_path)\n\t\t\t# save the df\n\t\t\tlog_file_name = \"Log_Row_ACMF_\" + file_name_without_extension + \".parquet\"\n\t\t\tlog_file_save_path = Log_files_Folder_path + \"/\" + log_file_name\n\t\t\tlog_df.write.mode(\"overwrite\").parquet(log_file_save_path)\n\n\ndef write_Log_Files(log_df, File_name_without_extension, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\", Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    log_files_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_files_Archive_name\n    # We write the log twice\n    # The file writen in the Index folder only have the most recent date -> use overwrite mode\n    log_df.write.mode(\"overwrite\").parquet(Log_files_Index_complete_path)\n    # The file writen in the archive folder keep trace of all changes -> use append mode\n    log_df.write.mode(\"append\").parquet(Log_files_Archive_complete_path)\n\ndef read_Log_file_index_from_file_name(File_name_without_extension, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\"):\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    \n    #fields = [StructField(\"file_name_no_extension\", StringType(),True), StructField(\"File_name_with_extension\", StringType(),True), StructField(\"File_type\", StringType(),True), StructField(\"File_date_as_TimestampType\", TimestampType(),True), StructField(\"File_SN\", StringType(),True), StructField(\"File_aircraft_model\", StringType(),True), StructField(\"Raw_file_legacy_folder_path\", StringType(),True), StructField(\"Raw_file_dated_folder_path\", StringType(),True), StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),True), StructField(\"Raw_file_dated_folder_copied\", BooleanType(),True),  StructField(\"Valid_file_name\", BooleanType(),True), StructField(\"Flight_file_name\", StringType(),True)]\n    #custom_schema = StructType(fields)\n\t\n    #df = spark.read.schema(custom_schema).parquet(Log_files_Index_complete_path)\n    df = spark.read.parquet(Log_files_Index_complete_path)\n    return df\n\ndef read_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    log_file_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_file_Archive_name\n\t\n    #df = spark.read.schema(custom_schema).parquet(Log_files_Index_complete_path)\n    df = spark.read.parquet(Log_files_Archive_complete_path)\n    #df = df.sort(\"Update_Date\")\n    sorted_df = df.orderBy(F.col(\"Update_Date\").desc())\n    return sorted_df\n    \ndef read_latest_update_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    sorted_bydate_log_df = read_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path)\n    # Step 3: Select the a single row, with the latest updated data\n    latest_update_df = sorted_bydate_log_df.limit(1)\n    return latest_update_df\n\ndef get_Log_file_index_parameters_from_file_name(File_name_without_extension, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\"):\n    df = read_Log_file_index_from_file_name(File_name_without_extension, Log_file_index_dir_path)\n    # Log_ACMF_Index file are supposed to always have a single row\n    row = df.first()\n    # Extract columns as parameters\n    parameters_dict = row.asDict()\n    return parameters_dict\n\t\ndef update_Log_df_with_new_value(log_df, column_name_string, new_value):\n    #updated_df = log_df.withColumn(column_name_string, when(col(column_name_string).isNotNull, col(column_name_string)).otherwise(lit(null)))\n    updated_df = log_df.withColumn(column_name_string, F.lit(new_value))\n    return updated_df\n    \ndef old_version_update_both_log_files(File_name_without_extension, new_values_per_column_dict, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\", Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    # Read the old df (the values in need of update)\n    old_log_df = read_Log_file_index_from_file_name(File_name_without_extension, Log_file_index_dir_path)\n    # Update the old_log_df by looping through the new values dictionary\n    new_log_df = old_log_df\n    for column_name  in new_values_per_column_dict.keys():\n        new_log_df = update_Log_df_with_new_value(new_log_df, column_name, new_values_per_column_dict[column_name])\n    # Update the result in the Update_Date column\n    new_log_df = new_log_df.withColumn(\"Update_Date\", F.current_timestamp())\n    # The path where to write the files\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    log_files_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_files_Archive_name\n    # We write the log twice\n    # The file writen in the Index folder only have the most recent date use overwrite mode\n    new_log_df.write.mode(\"overwrite\").parquet(Log_files_Index_complete_path)\n    # The file writen in the archive folder keep trace of all changes use append mode\n    new_log_df.write.mode(\"append\").parquet(Log_files_Archive_complete_path)\n\ndef update_both_log_files(File_name_without_extension, new_values_per_column_dict, Log_file_index_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\", Log_file_archive_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"):\n    # Read the previously most recent row of date from the archive as a new \n    old_log_df = read_latest_update_Log_file_archive_from_file_name(File_name_without_extension, Log_file_archive_dir_path)\n    # Update the old_log_df by looping through the new values dictionary\n    new_log_df = old_log_df\n    for column_name  in new_values_per_column_dict.keys():\n        new_log_df = update_Log_df_with_new_value(new_log_df, column_name, new_values_per_column_dict[column_name])\n    # Update the result in the Update_Date column\n    new_log_df = new_log_df.withColumn(\"Update_Date\", F.current_timestamp())\n    # The path where to write the files\n    log_file_Index_name = \"Log_ACMF_Index_\" + File_name_without_extension + \".parquet\"\n    log_files_Archive_name = \"Log_ACMF_Archive_\" + File_name_without_extension + \".parquet\"\n    Log_files_Index_complete_path = Log_file_index_dir_path + \"/\" + log_file_Index_name\n    Log_files_Archive_complete_path = Log_file_archive_dir_path + \"/\" + log_files_Archive_name\n    # We write the log twice\n    # The file writen in the Index folder only have the most recent date use overwrite mode\n    new_log_df.write.mode(\"overwrite\").parquet(Log_files_Index_complete_path)\n    # The file writen in the archive folder keep trace of all changes use append mode\n    new_log_df.write.mode(\"append\").parquet(Log_files_Archive_complete_path)\n\ndef old_version_1_initiate_log_files_from_New_raw_files(New_raw_files_Dir_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_with_extension = extract_filename_with_extension(new_raw_file_path)\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\tfile_type = \"Raw\"\n\t\t\tfile_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension)\n\t\t\tfile_aircraft_model = get_aircraft_Model_ID_from_file_name(file_name_without_extension)\n\t\t\tfile_date_as_dateTime = get_date_from_ACMF_csv_file_name(file_name_without_extension)\n\t\t\tfile_date_as_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\traw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string = get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\tRaw_file_legacy_folder_path = legacy_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + file_name_with_extension\n\t\t\tRaw_file_dated_folder_path = dated_fichier_brut_Folder_path + \"/\" + file_SN + \"/\" + raw_file_date_year_string + \"/\" + raw_file_date_month_string + \"/\" + raw_file_date_day_string + \"/\" + file_name_with_extension\n\t\t\t# Create a log df with the previous informations\n\t\t\tlog_df = create_basic_log_df(file_name_without_extension, file_name_with_extension, file_type, file_date_as_dateTime, file_SN, file_aircraft_model, Raw_file_legacy_folder_path, Raw_file_dated_folder_path)\n\t\t\t# save the df\n\t\t\twrite_Log_Files(log_df, file_name_without_extension)\n\n#def copy_new_raw_file_into_appropriate_folders(New_raw_files_Dir_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\ndef old_version_2_copy_new_raw_file_into_appropriate_folders(New_raw_files_Dir_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\t# The default values to update if the copy fail\n\t\t\tupdated_log_values_dict = {\"Raw_file_legacy_folder_copied\":False, \"Raw_file_dated_folder_copied\":False}\n\t\t\table_to_read_file_to_copy = False\n\t\t\tCopies_count = 0\n\t\t\ttry:\n\t\t\t    # Read the df to copy\n\t\t\t    df_to_copy = spark.read.csv(new_raw_file_path)\n\t\t\t    able_to_read_file_to_copy = True\n\t\t\texcept (IOError, ValueError, IllegalArgumentException) as Error_1_copy_new_raw_file_into_appropriate_folders:\n\t\t\t    able_to_read_file_to_copy = False\n\t\t\t#If the raw file could be red\n\t\t\tif able_to_read_file_to_copy:\n\t\t\t    log_file_infos_dict = get_Log_file_index_parameters_from_file_name(file_name_without_extension)\n\t\t\t    Raw_file_legacy_folder_path = log_file_infos_dict[\"Raw_file_legacy_folder_path\"]\n\t\t\t    Raw_file_dated_folder_path = log_file_infos_dict[\"Raw_file_dated_folder_path\"]\n\t\t\t    # Try writting the first copy\n\t\t\t    try:\n\t\t\t        df_to_copy.coalesce(1).write.mode(\"ignore\").csv(Raw_file_legacy_folder_path)\n\t\t\t        updated_log_values_dict[\"Raw_file_legacy_folder_copied\"] = True\n\t\t\t        Copies_count += 1\n\t\t\t    except (IOError, ValueError, IllegalArgumentException) as Error_2_copy_new_raw_file_into_appropriate_folders:\n\t\t\t        updated_log_values_dict[\"Raw_file_legacy_folder_copied\"] = False\n\t\t\t    # Try writting the second copy\n\t\t\t    try:\n\t\t\t        df_to_copy.coalesce(1).write.mode(\"ignore\").csv(Raw_file_dated_folder_path)\n\t\t\t        updated_log_values_dict[\"Raw_file_dated_folder_copied\"] = True\n\t\t\t        Copies_count += 1\n\t\t\t    except (IOError, ValueError, IllegalArgumentException) as Error_3_copy_new_raw_file_into_appropriate_folders:\n\t\t\t        updated_log_values_dict[\"Raw_file_dated_folder_copied\"] = False\n\t\t\t#Update both log files using the updated_log_values_dict\n\t\t\tupdate_both_log_files(file_name_without_extension, updated_log_values_dict)\n\t\t\tif Copies_count == 2:\n\t\t\t    # If all the copies have been made successfully\n\t\t\t    path_to_deleate = new_raw_file_path\n\t\t\t    #Use subprocess to run the HDFS command to delete the file or folder\n\t\t\t    # Be cautious when using this method as it directly interacts with HDFS.\n\t\t\t    subprocess.run([\"hadoop\", \"dfs\", \"-rm\", \"-r\", path_to_deleate])\n\t\t\t\ndef read_all_index_log_files_as_a_single_df(Log_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"):\n    index_log_file_df = spark.read.parquet(Log_files_Index_Dir_path)\n    return index_log_file_df\n\ndef read_all_archive_log_files_as_a_single_df(Log_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/*\"):\n    archive_log_file_df = spark.read.parquet(Log_files_Archive_Dir_path)\n    return archive_log_file_df\n    \ndef filter_raw_files_potentially_sharing_same_flight(reference_file_type, reference_SN, reference_date, maximum_deltaT, Log_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"):\n    # read the df of all the log index file\n    index_log_file_df = read_all_index_log_files_as_a_single_df(Log_files_Index_Dir_path)\n    \n    raw_SN_dateRange_filter_expression = (F.col(\"File_type\") == reference_file_type) & \\\n                                        (F.col(\"File_SN\") == reference_SN) & \\\n                                        (F.col(\"File_date_as_TimestampType\") >= reference_date - maximum_deltaT) & \\\n                                        (F.col(\"File_date_as_TimestampType\") <= reference_date + maximum_deltaT)\n    index_log_file_prefiltered_df = index_log_file_df.filter(raw_SN_dateRange_filter_expression)\n    return index_log_file_prefiltered_df\n    \n# Take as input a df made of index Log files (prefiltered do get all raw files of a specific SN (? within a date range of 24h around the date of the file selected ?)), the date extracted from the name of the selected file, and an interval of time deltaT\n# By default deltaT is 220 second, the value used in the previous version by Louis Carmier. This value is somewayh arbitrary and need to be picked carfully. If deltaT is too low the number of vol/flight identified will be too high, and on the oposite a deltaT too high will group raw files that should not and the number of flight identified will be too low\ndef filter_df_with_moving_deltaT(index_log_file_prefiltered_df, date_selected, chosen_time_delta_in_seconds = 220):\n    deltaT = timedelta(seconds = chosen_time_delta_in_seconds)\n    # Initially filter wintin a daterange of plus or minus deltaT arround the date_selected\n    initial_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= date_selected - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= date_selected + deltaT)\n    \n    initial_date_filtered_df = index_log_file_prefiltered_df.filter(initial_date_filter_expression)\n    initial_rows_count = initial_date_filtered_df.count()\n    previous_rows_count = 0\n    # That previous operation will most likely result in a df with a larger number of rows. Find the new maximum and minimum date of the df and filter on those new values plus or minus deltaT\n    new_minimum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"min\"}).collect()[0][0]\n    new_maximum_date_value = initial_date_filtered_df.agg({\"File_date_as_TimestampType\": \"max\"}).collect()[0][0]\n    new_date_filter_expression = (F.col(\"File_date_as_TimestampType\") >= new_minimum_date_value - deltaT) & \\\n                                     (F.col(\"File_date_as_TimestampType\") <= new_maximum_date_value + deltaT)\n    new_rows_df = index_log_file_prefiltered_df.filter(new_date_filter_expression)\n    new_rows_count = new_rows_df.count()\n    \n    while new_rows_count !=  previous_rows_count:\n        previous_rows_count = new_rows_count\n        new_minimum_date_value = new_rows_df.agg({\"File_date_as_TimestampType\": \"min\"}).collect()[0][0]\n        new_maximum_date_value = new_rows_df.agg({\"File_date_as_TimestampType\": \"max\"}).collect()[0][0]\n        new_date_filter_expression_2 = (F.col(\"File_date_as_TimestampType\") >= new_minimum_date_value - deltaT) & \\\n                                         (F.col(\"File_date_as_TimestampType\") <= new_maximum_date_value + deltaT)\n        new_rows_df = index_log_file_prefiltered_df.filter(new_date_filter_expression_2)\n        new_rows_count = new_rows_df.count()\n    return new_rows_df\n\ndef find_files_sharing_the_same_flight_as_rawFileName(file_name_without_extension_to_analyse, Log_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\", chosen_maximum_time_delta_in_hours = 36, chosen_rolling_time_delta_in_seconds = 220, file_type = \"Raw\"):\n    # First STEP : select all the data that will be used to query the index and reduce the number of potential files\n    reference_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension_to_analyse)\n    reference_date = get_date_from_ACMF_csv_file_name(file_name_without_extension_to_analyse)\n    reference_file_type = file_type\n    # The maximum time delta we apply initially to limit the number of potential file. By default 36h before and after the date writen in the file name give us a fairly large margin. This value can certainly be optimised for faster computing\n    maximum_deltaT = timedelta(hours = chosen_maximum_time_delta_in_hours)\n    \n    # 2nd STEP :  read the df of all the log index file and apply a first filter on file_type, SN and date\n    index_log_file_prefiltered_df = filter_raw_files_potentially_sharing_same_flight(reference_file_type, reference_SN, reference_date, maximum_deltaT, Log_files_Index_Dir_path)\n    \n    # 3rd STEP : apply a second filter with a rolling time delta on the previous df to get a new df listing all the files sharing the same flight (theorically, without cross checking values with the FHDB it's not possible to be 100 percent sure of the result)\n    share_flight_df = filter_df_with_moving_deltaT(index_log_file_prefiltered_df, reference_date, chosen_rolling_time_delta_in_seconds)\n    return share_flight_df\n\n############################################################################################################################################################################################\n###############                            Extract infos from raw file, check for validity of the file name and crate the Log files                              ###########################\n############################################################################################################################################################################################\n    \ndef nom_vol(path):\n\t# nom_vol return either 'IRYS2_' (if 'IRYS2_' is found in the path even if 'PERFOS_' is also present) or 'PERFOS_'\n\tif 'IRYS2' in path:\n\t\treturn('IRYS2_')\n\tif 'PERFOS' in path:\n\t\treturn('PERFOS_')\n\ndef Is_IRYS2_in_file_name(path):\n    if 'IRYS2' in path:\n        return True\n    else:\n        return False\n        \ndef Is_PERFOS_in_file_name(path):\n    if 'PERFOS' in path:\n        return True\n    else:\n        return False\n\ndef Is_FAIL_in_file_name(path):\n    if 'FAIL' in path:\n        return True\n    else:\n        return False\n        \ndef Is_TRD_begining_file_name(file_name):\n    bool_start_with_TRD = file_name.startswith(\"TRD\")\n    return bool_start_with_TRD\n\ndef Is_MUX_begining_file_name(file_name):\n    bool_start_with_MUX = file_name.startswith(\"MUX\")\n    return bool_start_with_MUX\n\ndef is_file_part_of_Vol(file_name):\n    if Is_IRYS2_in_file_name(file_name) or Is_PERFOS_in_file_name(file_name):\n        return True\n    else:\n        return False\n    \ndef check_if_file_name_start_with_failure_code(input_string):\n    # Check if the length is 4 or 5 characters\n    if len(input_string) not in (4, 5):\n        return False\n    # Check if the string starts with 'P' or 'p'\n    if not input_string[0] in ('P', 'p'):\n        return False\n    # Check if the rest of the string contains only numeric characters\n    if not re.match(r'^\\d+$', input_string[1:]):\n        return False\n    return True\n    \ndef find_system_in_file_name(file_name, known_system_list = [\"AB\", \"ADS\", \"AI\", \"APU\", \"BCS\", \"BLEED\", \"CAS\", \"CASOV\", \"CPCS\", \"ECS\", \"ELEC\", \"FLAP\", \"FUEL\", \"HPPRSOV\", \"HUD\", \"LGCS\", \"O2\", \"TPMS\", \"TR\"]):\n    System_name_list = known_system_list\n    System_name = \"UnidentifiedSystemName\"\n    potential_system_name_list = []\n    # Verification that the file is not IRYS2 or PERFOS\n    if not is_file_part_of_Vol(file_name):\n        split_file_name_list = file_name.split('_')\n        # If the file start with TRD or MUX but is not a Vol\n        if Is_TRD_begining_file_name(file_name) or Is_MUX_begining_file_name(file_name):\n            potential_system_name_list.append(split_file_name_list[4])\n        if check_if_file_name_start_with_failure_code(split_file_name_list[0]):\n            potential_system_name_list.append(split_file_name_list[3])\n            potential_system_name_list.append(split_file_name_list[4])\n        if potential_system_name_list != []:\n            for potential_system in potential_system_name_list:\n                if potential_system in System_name_list:\n                    System_name = potential_system\n    return System_name\n\ndef is_file_part_of_System(file_name, known_system_list = [\"AB\", \"ADS\", \"AI\", \"APU\", \"BCS\", \"BLEED\", \"CAS\", \"CASOV\", \"CPCS\", \"ECS\", \"ELEC\", \"FLAP\", \"FUEL\", \"HPPRSOV\", \"HUD\", \"LGCS\", \"O2\", \"TPMS\", \"TR\"]):\n    if not is_file_part_of_Vol(file_name):\n        sytem_name = find_system_in_file_name(file_name, known_system_list)\n        if sytem_name != \"UnidentifiedSystemName\":\n            return True\n    else:\n        return False\n\ndef get_all_infos_from_file_path(file_path):\n    file_name_with_extension = extract_filename_with_extension(file_path)\n    file_name_without_extension = extract_filename_without_extension(file_path)\n    file_extension = identify_extension(file_path)\n    file_complete_ID = get_aircraft_complete_ID_from_file_name(file_name_without_extension)\n    file_SN = get_aircraft_SN_complete_from_file_name(file_name_without_extension)\n    file_aircraft_model = get_aircraft_Model_ID_from_file_name(file_name_without_extension)\n    file_date_as_dateTime = get_date_from_ACMF_csv_file_name(file_name_without_extension)\n    file_date_as_string = get_date_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n    IRYS2_in_file_name = Is_IRYS2_in_file_name(file_name_without_extension)\n    PERFOS_in_file_name = Is_PERFOS_in_file_name(file_name_without_extension)\n    FAIL_in_file_name = Is_FAIL_in_file_name(file_name_without_extension)\n    TRD_begining_file_name = Is_TRD_begining_file_name(file_name_without_extension)\n    MUX_begining_file_name = Is_MUX_begining_file_name(file_name_without_extension)\n    \n    file_part_of_Vol = is_file_part_of_Vol(file_name_without_extension)\n    IRYS2_or_PERFOS = None\n    if file_part_of_Vol:\n        IRYS2_or_PERFOS = nom_vol(file_name_without_extension)\n    \n    file_part_of_System = is_file_part_of_System(file_name_without_extension)\n    file_system_name = None\n    if file_part_of_System:\n        file_system_name = find_system_in_file_name(file_name_without_extension)\n    return file_name_with_extension, file_name_without_extension, file_extension, file_complete_ID, file_SN, file_aircraft_model, file_date_as_dateTime, file_date_as_string, IRYS2_in_file_name, PERFOS_in_file_name, FAIL_in_file_name, TRD_begining_file_name, MUX_begining_file_name, file_part_of_Vol, IRYS2_or_PERFOS, file_part_of_System, file_system_name\n    \ndef is_file_name_valid(file_path):\n    file_valid = False\n    try:\n        file_name_with_extension, file_name_without_extension, file_extension, file_complete_ID, file_SN, file_aircraft_model, file_date_as_dateTime, file_date_as_string, IRYS2_in_file_name, PERFOS_in_file_name, FAIL_in_file_name, TRD_begining_file_name, MUX_begining_file_name, file_part_of_Vol, IRYS2_or_PERFOS, file_part_of_System, file_system_name = get_all_infos_from_file_path(file_path)\n        if ((file_part_of_Vol == True) and (file_part_of_System == False)) or ((file_part_of_Vol == False) and (file_part_of_System == True)):\n            file_valid = True\n        return file_valid\n    except (IOError, ValueError) as Error_1_is_file_name_valid:\n        current_error_name = \"Error_1_is_file_name_valid\"\n        current_error_message = str(Error_1_is_file_name_valid)\n        current_data_processed = file_path\n        log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n        return file_valid\n\n\n\n############################################################################################################################################################################################\n###############                            Extract infos from raw file, check for validity of the file name and crate the Log files                              ###########################\n############################################################################################################################################################################################\n\n\ndef create_basic_log_df(file_name_without_extension, file_name_with_extension, file_extension, file_type, valid_file_name, file_date_as_Timestamp = None, file_date_as_string = None, file_complete_ID = None, file_SN = None, file_aircraft_model = None, file_legacy_folder_path = None, file_dated_folder_path = None, copy_to_raw_legacy_folder = None, copy_to_raw_dated_folder = None, Flight_file_name = None, TRD_start_file_name = None, MUX_start_file_name = None, IRYS2_in_file_name = None, PERFOS_in_file_name = None, FAIL_in_file_name = None, Is_Vol = None, IRYS2_or_PERFOS = None, Is_System = None, System_Name = None):\n\tfields = [StructField(\"file_name_no_extension\", StringType(),True),\n\t  StructField(\"File_name_with_extension\", StringType(),True),\n\t  StructField(\"File_extension\", StringType(),True),\n\t  StructField(\"File_type\", StringType(),True),\n\t  StructField(\"Valid_file_name\", BooleanType(),True),\n\t  StructField(\"File_date_as_TimestampType\", TimestampType(),True),\n\t  StructField(\"File_date_as_String\", StringType(),True),\n\t  StructField(\"File_complete_ID\", StringType(),True),\n\t  StructField(\"File_SN\", StringType(),True),\n\t  StructField(\"File_aircraft_model\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_dated_folder_path\", StringType(),True),\n\t  StructField(\"Raw_file_legacy_folder_copied\", BooleanType(),True),\n\t  StructField(\"Raw_file_dated_folder_copied\", BooleanType(),True),\n\t  StructField(\"Flight_file_name\", StringType(),True),\n\t  StructField(\"TRD_starts_file_name\", BooleanType(),True),\n\t  StructField(\"MUX_starts_file_name\", BooleanType(),True),\n\t  StructField(\"IRYS2_in_file_name\", BooleanType(),True),\n\t  StructField(\"PERFOS_in_file_name\", BooleanType(),True),\n\t  StructField(\"FAIL_in_file_name\", BooleanType(),True),\n\t  StructField(\"Is_Vol\", BooleanType(),True),\n\t  StructField(\"IRYS2_or_PERFOS\", StringType(),True),\n\t  StructField(\"Is_System\", BooleanType(),True),\n\t  StructField(\"System_Name\", StringType(),True),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[file_name_without_extension, file_name_with_extension, file_extension, file_type, valid_file_name, file_date_as_Timestamp, file_date_as_string, file_complete_ID, file_SN, file_aircraft_model, file_legacy_folder_path, file_dated_folder_path, copy_to_raw_legacy_folder, copy_to_raw_dated_folder, Flight_file_name, TRD_start_file_name, MUX_start_file_name, IRYS2_in_file_name, PERFOS_in_file_name, FAIL_in_file_name, Is_Vol, IRYS2_or_PERFOS, Is_System, System_Name]]\n\n\tdf = spark.createDataFrame(data, schema)\n\t# Add a column with the curreent_timestamp to trace the date of the last modification\n\tdf = df.withColumn(\"Update_Date\", F.current_timestamp()) \n\treturn df\n\n\n############################################################################################################################################################################################\n###############                            Create error log files and logs error messages                              ###########################\n############################################################################################################################################################################################    \n\t\ndef initiate_log_files_from_New_raw_files(New_raw_files_Dir_path, legacy_fichier_brut_Folder_path, dated_fichier_brut_Folder_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_with_extension = extract_filename_with_extension(new_raw_file_path)\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\tfile_extension = identify_extension(new_raw_file_path)\n\t\t\tfile_type = \"Raw\"\n\t\t\t# Find if the file name is a valid format:\n\t\t\tvalid_file_name = is_file_name_valid(new_raw_file_path)\n\t\t\tif valid_file_name:\n\t\t\t    file_name_with_extension, file_name_without_extension, file_extension, file_full_ID, file_SN_plus_num, file_ac_model, file_date_as_dateTime, file_date_as_str, IRYS2_in_fileName, PERFOS_in_fileName, FAIL_in_fileName, TRD_begining_file_name, MUX_begining_file_name, file_part_of_Vol, IRYS2orPERFOS, file_part_of_System, file_system_name = get_all_infos_from_file_path(new_raw_file_path)\n\t\t\t    raw_file_date_year_string, raw_file_date_month_string, raw_file_date_day_string = get_year_month_day_as_numeric_string_from_ACMF_csv_filee_name(file_name_without_extension)\n\t\t\t    Raw_file_legacy_folder_path = legacy_fichier_brut_Folder_path + \"/\" + file_SN_plus_num + \"/\" + file_name_with_extension\n\t\t\t    Raw_file_dated_folder_path = dated_fichier_brut_Folder_path + \"/\" + file_SN_plus_num + \"/\" + raw_file_date_year_string + \"/\" + raw_file_date_month_string + \"/\" + raw_file_date_day_string + \"/\" + file_name_with_extension\n\t\t\t    \n\t\t\t    log_df = create_basic_log_df(file_name_without_extension, file_name_with_extension, file_extension, file_type, valid_file_name, file_date_as_Timestamp = file_date_as_dateTime, file_date_as_string = file_date_as_str, file_complete_ID = file_full_ID, file_SN = file_SN_plus_num, file_aircraft_model = file_ac_model, file_legacy_folder_path = Raw_file_legacy_folder_path, file_dated_folder_path = Raw_file_dated_folder_path, copy_to_raw_legacy_folder = None, copy_to_raw_dated_folder = None, Flight_file_name = None, TRD_start_file_name = TRD_begining_file_name, MUX_start_file_name = MUX_begining_file_name, IRYS2_in_file_name = IRYS2_in_fileName, PERFOS_in_file_name = PERFOS_in_fileName, FAIL_in_file_name = FAIL_in_fileName, Is_Vol = file_part_of_Vol, IRYS2_or_PERFOS = IRYS2orPERFOS, Is_System = file_part_of_System, System_Name = file_system_name)\n\t\t\t    # save the df\n\t\t\t    write_Log_Files(log_df, file_name_without_extension)\n\t\t\telse:\n\t\t\t    # Create a log df filled mostly with the default None value since the file name is not recognized\n\t\t\t    invalid_file_name_log_df = create_basic_log_df(file_name_without_extension, file_name_with_extension, file_extension, file_type, valid_file_name)\n\t\t\t    # save the df\n\t\t\t    write_Log_Files(invalid_file_name_log_df, file_name_without_extension)\n\t\t\t    \n\ndef create_basic_error_log_df(error_name, data_curently_processed = None, error_message = None):\n\tfields = [StructField(\"Error_Name\", StringType(),True),\n\t  StructField(\"Data_curently_processed\", StringType(),True),\n\t  StructField(\"Error_Message\", StringType(),True),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[error_name, data_curently_processed, error_message]]\n\n\tdf = spark.createDataFrame(data, schema)\n\t# Add a column with the curreent_timestamp to trace the date of the last modification\n\tdf = df.withColumn(\"Update_Date\", F.current_timestamp()) \n\treturn df\n\ndef write_Error_Log_File(error_log_df, error_log_file_name, error_log_file_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\"):\n    error_log_file_complete_path = error_log_file_dir_path + \"/\" + error_log_file_name\n    error_log_df.write.mode(\"overwrite\").parquet(error_log_file_complete_path)\n\ndef log_error_message(Error_Name, Data_Curently_Processed = None, Error_Message = None, Error_Log_File_Dir_Path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\"):\n    basic_error_log_name_string = \"Error_Log_\"\n    current_time = spark.sql(\"SELECT current_timestamp() as current_time\").collect()[0][\"current_time\"]\n    current_time_str = strip_non_numeric_char_from_string(str(current_time))\n    Error_Log_File_Name = basic_error_log_name_string + current_time_str + \".parquet\"\n    \n    # Create the basic df for the log file\n    Error_Log_df = create_basic_error_log_df(Error_Name, Data_Curently_Processed, Error_Message)\n    \n    # Save the error log\n    write_Error_Log_File(Error_Log_df, Error_Log_File_Name, Error_Log_File_Dir_Path)\n\n\n############################################################################################################################################################################################\n###############                            Use hdfs subprocess to copy files                             ###########################\n############################################################################################################################################################################################ \n\n        \ndef hdfs_check_if_dir_exist_and_create_it_if_not(full_path):\n    directory_that_need_to_exist_path = os.path.dirname(full_path)\n    # If the parent directory do not exist\n    if hdfs_check_if_file_exist(directory_that_need_to_exist_path) == False:\n        mkdir_command = [\"hdfs\", \"dfs\", \"-mkdir\", \"-p\", directory_that_need_to_exist_path]\n        grant_all_permission_command_recursive = [\"hdfs\", \"dfs\", \"-chmod\", \"-R\", \"777\", directory_that_need_to_exist_path]\n        try:\n            subprocess.run(mkdir_command, check=True)\n            subprocess.run(grant_all_permission_command_recursive, check=True)\n        except subprocess.CalledProcessError as Error_1_hdfs_check_if_dir_exist_and_create_it_if_not:\n            current_error_name = \"Error_1_hdfs_check_if_dir_exist_and_create_it_if_not\"\n            current_error_message = str(Error_1_hdfs_check_if_dir_exist_and_create_it_if_not)\n            current_data_processed = full_path\n            log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n    else:\n        pass\n\ndef hdfs_check_if_file_exist(file_path):\n    test_command = [\"hdfs\", \"dfs\", \"-test\", \"-e\", file_path]\n    try:\n        subprocess.run(test_command, check=True)\n        return True\n        # You can perform your copy operation or other tasks here if the file exists.\n    except subprocess.CalledProcessError as Error_1_hdfs_check_if_file_exist:\n        #current_error_name = \"Error_1_hdfs_check_if_file_exist\"\n        #current_error_message = str(Error_1_hdfs_check_if_file_exist)\n        #current_data_processed = file_path\n        #log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n        return False\n    \ndef hdfs_copy_file_from_source_to_destination(source_file_path, destination_file_path):\n    # Check if the destination_file_path do not exist, if it does skip the function\n    if hdfs_check_if_file_exist(destination_file_path) == False:\n        # Use subprocess to copy the file, the permission are changed, , ownership of the file is not preserved and attributed to yarn\n        copy_command = [\"hadoop\", \"dfs\", \"-cp\", source_file_path, destination_file_path]\n        # Then to change the permissions\n        grant_all_permission_command = [\"hadoop\", \"dfs\", \"-chmod\", \"777\", destination_file_path]\n        try:\n            subprocess.run(copy_command, check=True)\n            subprocess.run(grant_all_permission_command, check=True)\n            #print(\"File copied successfully.\")\n        except subprocess.CalledProcessError as Error_1_hdfs_copy_file_from_source_to_destination:\n            current_error_name = \"Error_1_hdfs_copy_file_from_source_to_destination\"\n            current_error_message = str(Error_1_hdfs_copy_file_from_source_to_destination)\n            current_data_processed = source_file_path\n            log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n    else:\n        pass\n        \n        \n        \n        \ndef hdfs_move_file_from_source_to_destination(source_file_path, destination_file_path):\n    # Check if the destination_file_path do not exist, if it does skip the function\n    if hdfs_check_if_file_exist(destination_file_path) == False:\n        # Use subprocess to move the file\n        move_command = [\"hadoop\", \"dfs\", \"-mv\", source_file_path, destination_file_path]\n        # Then to change the permissions\n        #grant_all_permission_command = [\"hadoop\", \"dfs\", \"-chmod\", \"777\", file_to_change_path]\n        try:\n            subprocess.run(copy_command, check=True)\n            #subprocess.run(grant_all_permission_command, check=True)\n            #print(\"File moved successfully.\")\n        except subprocess.CalledProcessError as Error_1_hdfs_move_file_from_source_to_destination:\n            current_error_name = \"Error_1_hdfs_move_file_from_source_to_destination\"\n            current_error_message = str(Error_1_hdfs_move_file_from_source_to_destination)\n            current_data_processed = source_file_path\n            log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n    else:\n        pass\n\n\ndef copy_new_raw_file_into_appropriate_folders(New_raw_files_Dir_path):\n\tRecently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\t# The default values to update if the copy fail\n\t\t\tupdated_log_values_dict = {\"Raw_file_legacy_folder_copied\":False, \"Raw_file_dated_folder_copied\":False}\n\t\t\table_to_read_file_to_copy = False\n\t\t\tFiles_into_the_right_folder = 0\n\t\t\ttry:\n\t\t\t    # Read the df to copy\n\t\t\t    df_to_copy = spark.read.csv(new_raw_file_path)\n\t\t\t    able_to_read_file_to_copy = True\n\t\t\texcept (IOError, ValueError, IllegalArgumentException) as Error_1_copy_new_raw_file_into_appropriate_folders:\n\t\t\t    able_to_read_file_to_copy = False\n\t\t\t    \n\t\t\t    current_error_name = \"Error_1_copy_new_raw_file_into_appropriate_folders\"\n\t\t\t    current_error_message = str(Error_1_copy_new_raw_file_into_appropriate_folders)\n\t\t\t    log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n            \n\t\t\t#If the raw file could be red\n\t\t\tif able_to_read_file_to_copy == True:\n\t\t\t    log_file_infos_dict = get_Log_file_index_parameters_from_file_name(file_name_without_extension)\n\t\t\t    Raw_file_legacy_folder_path = log_file_infos_dict[\"Raw_file_legacy_folder_path\"]\n\t\t\t    Raw_file_dated_folder_path = log_file_infos_dict[\"Raw_file_dated_folder_path\"]\n\t\t\t    #Verify that the dir already exist and if not create it\n\t\t\t    #hdfs_check_if_dir_exist_and_create_it_if_not(Raw_file_dated_folder_path)\n\t\t\t    #hdfs_check_if_dir_exist_and_create_it_if_not(Raw_file_legacy_folder_path)\n\t\t\t    # Try writting the first copy to the dated folder\n\t\t\t    try:\n\t\t\t        #df_to_copy.coalesce(1).write.mode(\"ignore\").csv(Raw_file_legacy_folder_path)\n\t\t\t        #Verify that the dir already exist and if not create it\n\t\t\t        #hdfs_check_if_dir_exist_and_create_it_if_not(Raw_file_dated_folder_path)\n\t\t\t        hdfs_copy_file_from_source_to_destination(new_raw_file_path, Raw_file_dated_folder_path)\n\t\t\t        updated_log_values_dict[\"Raw_file_legacy_folder_copied\"] = True\n\t\t\t        Files_into_the_right_folder += 1\n\t\t\t    except (IOError, ValueError, IllegalArgumentException) as Error_2_copy_new_raw_file_into_appropriate_folders:\n\t\t\t        updated_log_values_dict[\"Raw_file_legacy_folder_copied\"] = False\n\t\t\t        \n\t\t\t        current_error_name = \"Error_2_copy_new_raw_file_into_appropriate_folders\"\n\t\t\t        current_error_message = str(Error_2_copy_new_raw_file_into_appropriate_folders)\n\t\t\t        current_data_processed = source_file_path\n\t\t\t        log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n            \n\t\t\t    # Try moving the file form the New_raw_files_Dir_path to the legacy folder\n\t\t\t    try:\n\t\t\t        # If the file was succefully copied in the dated folder we can move the file to the legacy folder\n\t\t\t        if Files_into_the_right_folder == 1:\n\t\t\t            #df_to_copy.coalesce(1).write.mode(\"ignore\").csv(Raw_file_dated_folder_path)\n\t\t\t            #Verify that the dir already exist and if not create it\n\t\t\t            #hdfs_check_if_dir_exist_and_create_it_if_not(Raw_file_legacy_folder_path)\n\t\t\t            hdfs_move_file_from_source_to_destination(new_raw_file_path, Raw_file_legacy_folder_path)\n\t\t\t            updated_log_values_dict[\"Raw_file_dated_folder_copied\"] = True\n\t\t\t            Files_into_the_right_folder += 1\n\t\t\t        else : \n\t\t\t            updated_log_values_dict[\"Raw_file_dated_folder_copied\"] = False\n\t\t\t    except (IOError, ValueError, IllegalArgumentException) as Error_3_copy_new_raw_file_into_appropriate_folders:\n\t\t\t        updated_log_values_dict[\"Raw_file_dated_folder_copied\"] = False\n\t\t\t        \n\t\t\t        current_error_name = \"Error_3_copy_new_raw_file_into_appropriate_folders\"\n\t\t\t        current_error_message = str(Error_3_copy_new_raw_file_into_appropriate_folders)\n\t\t\t        current_data_processed = source_file_path\n\t\t\t        log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n            \n\t\t\t#Update both log files using the updated_log_values_dict\n\t\t\tupdate_both_log_files(file_name_without_extension, updated_log_values_dict)\n\t\t\t# If the file in New_raw_files_Dir_path still exist and both files are present in the legacy and dated dir (ex if the file was already present in the legacy dir so the file could not be moved) THEN delete the file\n\t\t\tis_file_stil_present_in_New_raw_files_Dir_path = hdfs_check_if_file_exist(new_raw_file_path)\n\t\t\tif (Files_into_the_right_folder == 2) and (is_file_stil_present_in_New_raw_files_Dir_path == True):\n\t\t\t    # If all the copies have been made successfully\n\t\t\t    path_to_delete = new_raw_file_path\n\t\t\t    #Use subprocess to run the HDFS command to delete the file or folder\n\t\t\t    # Be cautious when using this method as it directly interacts with HDFS.\n\t\t\t    subprocess.run([\"hadoop\", \"dfs\", \"-rm\", \"-r\", path_to_delete])","user":"e854129","dateUpdated":"2023-09-06T11:48:55+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693905765238_-1918923316","id":"20230825-153528_520502784","dateCreated":"2023-09-05T11:22:45+0200","dateStarted":"2023-09-06T11:49:03+0200","dateFinished":"2023-09-06T11:49:04+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:71"},{"title":"STEP 1 : Initialise the log files for the test path","text":"%pyspark\n\n# Searching for newlly uploaded  files in the New_raw_files folder\nNew_raw_files_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/New_raw_files\"\nLog_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\"\nLog_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"\n\n#legacy_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/fichier_brut\"\nlegacy_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut\"\n#dated_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/fichier_brut_par_mois\"\ndated_fichier_brut_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois\"\n\ninitiate_log_files_from_New_raw_files(New_raw_files_Dir_path, legacy_fichier_brut_Dir_path, dated_fichier_brut_Dir_path)","user":"e854129","dateUpdated":"2023-09-06T11:20:14+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693905765250_-1837356550","id":"20230828-105703_1081172253","dateCreated":"2023-09-05T11:22:45+0200","dateStarted":"2023-09-06T11:20:14+0200","dateFinished":"2023-09-06T11:21:38+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:72"},{"title":"STEP 2 : Copy raw file from New_raw_files_Dir and update the logs","text":"%pyspark\ncopy_new_raw_file_into_appropriate_folders(New_raw_files_Dir_path)","user":"e854129","dateUpdated":"2023-09-06T11:49:07+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"name 'IllegalArgumentException' is not defined\nTraceback (most recent call last):\n  File \"<stdin>\", line 847, in copy_new_raw_file_into_appropriate_folders\nNameError: name 'IllegalArgumentException' is not defined\n"}]},"apps":[],"jobName":"paragraph_1693905765263_-1842358285","id":"20230829-132800_206700600","dateCreated":"2023-09-05T11:22:45+0200","dateStarted":"2023-09-06T11:49:10+0200","dateFinished":"2023-09-06T11:49:21+0200","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:73"},{"title":"Read all log files from a folder (example all index Log files)","text":"%pyspark\n# If you read from the Index folder you will not be to overwrite files in the index folder\nLog_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"\nLog_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/*\"\n\nLog_file_df = spark.read.parquet(Log_files_Archive_Dir_path).sort(F.col(\"Update_Date\").desc())\n\nLog_file_df.show(40, truncate=70)\n\n","user":"e854129","dateUpdated":"2023-09-05T17:39:42+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|                                       file_name_no_extension|                                         File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|                                           Raw_file_legacy_folder_path|                                            Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|   MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125826t|   MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125826t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:26|     20230625125826|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-05 17:25:47.906|\n|   MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125138t|   MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125138t.csv|          .csv|      Raw|           true|       2023-06-25 12:51:38|     20230625125138|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-05 17:25:26.483|\n|        MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625134259t|        MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625134259t.csv|          .csv|      Raw|           true|       2023-06-25 13:42:59|     20230625134259|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-05 17:25:05.424|\n|        MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625133950t|        MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625133950t.csv|          .csv|      Raw|           true|       2023-06-25 13:39:50|     20230625133950|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-05 17:24:45.042|\n|        MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625130022t|        MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625130022t.csv|          .csv|      Raw|           true|       2023-06-25 13:00:22|     20230625130022|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-05 17:24:24.838|\n|       MUX_P1153_ISSUE_3_BLEED_REPORT_0580449_20230625120933t|       MUX_P1153_ISSUE_3_BLEED_REPORT_0580449_20230625120933t.csv|          .csv|      Raw|           true|       2023-06-25 12:09:33|     20230625120933|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|      BLEED|2023-09-05 17:24:04.235|\n|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133802t|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133802t.csv|          .csv|      Raw|           true|       2023-06-25 13:38:02|     20230625133802|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-05 17:23:43.889|\n|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133349t|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133349t.csv|          .csv|      Raw|           true|       2023-06-25 13:33:49|     20230625133349|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-05 17:23:23.498|\n|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625125813t|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625125813t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:13|     20230625125813|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-05 17:23:03.233|\n|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625133725t|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625133725t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:25|     20230625133725|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB| 2023-09-05 17:22:42.32|\n|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t.csv|          .csv|      Raw|           true|       2023-06-25 12:47:47|     20230625124747|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-05 17:22:20.508|\n|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124740t|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124740t.csv|          .csv|      Raw|           true|       2023-06-25 12:47:40|     20230625124740|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-05 17:21:59.416|\n|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625125813t|         MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625125813t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:13|     20230625125813|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-05 16:49:40.693|\n|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625133725t|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625133725t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:25|     20230625133725|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB| 2023-09-05 16:49:21.58|\n|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t.csv|          .csv|      Raw|           true|       2023-06-25 12:47:47|     20230625124747|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB| 2023-09-05 16:49:01.92|\n|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124740t|          MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124740t.csv|          .csv|      Raw|           true|       2023-06-25 12:47:40|     20230625124740|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-05 16:48:42.826|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t.csv|          .csv|      Raw|           true|       2023-06-25 12:46:35|     20230625124635|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:13:01.601|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t.csv|          .csv|      Raw|           true|       2023-06-25 12:44:54|     20230625124454|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:12:47.083|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv|          .csv|      Raw|           true|       2023-06-25 12:43:12|     20230625124312|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:12:32.673|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t.csv|          .csv|      Raw|           true|       2023-06-25 12:41:30|     20230625124130|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:12:18.117|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t.csv|          .csv|      Raw|           true|       2023-06-25 12:39:48|     20230625123948|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:12:03.342|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t.csv|          .csv|      Raw|           true|       2023-06-25 12:38:06|     20230625123806|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:11:48.358|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t.csv|          .csv|      Raw|           true|       2023-06-25 12:36:24|     20230625123624|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|  2023-09-05 16:11:33.7|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t.csv|          .csv|      Raw|           true|       2023-06-25 12:34:42|     20230625123442|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:11:18.991|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t.csv|          .csv|      Raw|           true|       2023-06-25 12:33:00|     20230625123300|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-05 16:11:04.43|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t.csv|          .csv|      Raw|           true|       2023-06-25 12:31:18|     20230625123118|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:10:49.363|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t.csv|          .csv|      Raw|           true|       2023-06-25 12:29:37|     20230625122937|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:10:34.507|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t.csv|          .csv|      Raw|           true|       2023-06-25 12:27:54|     20230625122754|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:10:19.557|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t.csv|          .csv|      Raw|           true|       2023-06-25 12:26:12|     20230625122612|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:10:04.796|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t.csv|          .csv|      Raw|           true|       2023-06-25 12:24:30|     20230625122430|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:09:50.385|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t.csv|          .csv|      Raw|           true|       2023-06-25 12:22:48|     20230625122248|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:09:35.889|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t.csv|          .csv|      Raw|           true|       2023-06-25 12:21:06|     20230625122106|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:09:21.544|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t.csv|          .csv|      Raw|           true|       2023-06-25 12:19:24|     20230625121924|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:09:07.081|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t.csv|          .csv|      Raw|           true|       2023-06-25 12:17:43|     20230625121743|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:08:52.645|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t.csv|          .csv|      Raw|           true|       2023-06-25 12:16:01|     20230625121601|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:08:38.161|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t.csv|          .csv|      Raw|           true|       2023-06-25 12:14:19|     20230625121419|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:08:23.627|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv|          .csv|      Raw|           true|       2023-06-25 12:12:37|     20230625121237|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:08:08.572|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv|          .csv|      Raw|           true|       2023-06-25 12:10:55|     20230625121055|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 16:07:53.646|\n|        TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625133349t|        TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625133349t.csv|          .csv|      Raw|           true|       2023-06-25 13:33:49|     20230625133349|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|       LGCS|2023-09-05 16:07:38.641|\n|        TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625125814t|        TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625125814t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:14|     20230625125814|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|       LGCS|2023-09-05 16:07:23.667|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\nonly showing top 40 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693905765276_-1836587052","id":"20230828-120212_1557945957","dateCreated":"2023-09-05T11:22:45+0200","dateStarted":"2023-09-05T17:39:42+0200","dateFinished":"2023-09-05T17:39:43+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:74"},{"title":"Collect a single row from a df","text":"%pyspark\nprint(Log_file_df.collect()[0])","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(file_name_no_extension='TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t', File_name_with_extension='TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', File_type='Raw', File_date_as_TimestampType=datetime.datetime(2023, 6, 25, 12, 43, 12), File_SN='SN449', File_aircraft_model='0580', Raw_file_legacy_folder_path='/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', Raw_file_dated_folder_path='/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Year_2023/Month_06/Day_25/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', Raw_file_legacy_folder_copied=False, Raw_file_dated_folder_copied=False, Valid_file_name=None, Flight_file_name=None, Update_Date=datetime.datetime(2023, 8, 29, 9, 44, 13, 284000))"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693905765291_-1853131255","id":"20230825-172220_468880430","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:75"},{"title":"Read most recent row of archive log from a specific file name","text":"%pyspark\nfile_name_searched = \"MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t\"\n\nlatest_update_Log_file_archive_df = read_latest_update_Log_file_archive_from_file_name(file_name_searched)\nlatest_update_Log_file_archive_df.show(40, truncate=16)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|     Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                         true|                        true|           null|            null|2023-08-29 13...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693905765305_-1847744770","id":"20230829-102244_471524309","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:76"},{"title":"Read all rows of archive log from a specific file name","text":"%pyspark\nall_rows_from_Log_file_archive_df = read_Log_file_archive_from_file_name(file_name_searched)\nall_rows_from_Log_file_archive_df.show(40, truncate=16)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|     Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                         true|                        true|           null|            null|2023-08-29 13...|\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                        false|                       false|           null|            null|2023-08-29 13...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693905765317_-1864673722","id":"20230829-110249_169456362","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:77"},{"title":"Read single row of index log from a specific file name","text":"%pyspark\nall_rows_from_Log_file_index_df = read_Log_file_index_from_file_name(file_name_searched)\nall_rows_from_Log_file_index_df.show(40, truncate=16)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|file_name_no_extension|File_name_with_extension|File_type|File_date_as_TimestampType|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Valid_file_name|Flight_file_name|     Update_Date|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+\n|      MUX_P1153_ISS...|        MUX_P1153_ISS...|      Raw|          2023-06-25 12...|  SN449|               0580|           /datalake/pro...|          /datalake/pro...|                         true|                        true|           null|            null|2023-08-29 13...|\n+----------------------+------------------------+---------+--------------------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+---------------+----------------+----------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1952<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1952/</a>"}]},"apps":[],"jobName":"paragraph_1693905765329_-1856978744","id":"20230829-110155_791683872","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:78"},{"title":"Modify the rights/permission for reading, writing/deleting, execution of a file or folder (specifically those earn by yarn ?)","text":"%pyspark\ndirectory_path_that_need_rights_modification = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449\"\n# code used to set rights/permission for reading, writing/deleting, execution. \"777\" is the default code to grant all rights\nrights_or_permission_to_set = \"777\"\n\n# Modify rights for a directory recursively -> all sub-folders will have the same setting\ngrant_all_permission_command_recursive = [\"hdfs\", \"dfs\", \"-chmod\", \"-R\", rights_or_permission_to_set, directory_path_that_need_rights_modification]\n\n# Modify rights for a directory NON recursively -> only the specific folder rights will be updated\ngrant_all_permission_command_NON_recursive = [\"hdfs\", \"dfs\", \"-chmod\", rights_or_permission_to_set, directory_path_that_need_rights_modification]\n\n# Ude the chosen command in a subprocess\nsubprocess.run(grant_all_permission_command_recursive, check=True)","user":"e854129","dateUpdated":"2023-09-06T09:50:35+0200","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"CompletedProcess(args=['hdfs', 'dfs', '-chmod', '-R', '777', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449'], returncode=0)"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693985357023_-850593722","id":"20230906-092917_776623819","dateCreated":"2023-09-06T09:29:17+0200","dateStarted":"2023-09-06T09:44:31+0200","dateFinished":"2023-09-06T09:44:34+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:79"},{"title":"Find the owner of a path or folder","text":"%pyspark\n# Define the folder path for which you want to find the owner\nfolder_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois\"\n\n# Use the subprocess module to run the getfacl command\ntry:\n    # Run the getfacl command and capture the output\n    #acl_output_bytes = subprocess.check_output([\"hadoop\", \"fs\", \"-getfacl\", folder_path], stderr=subprocess.STDOUT)\n    acl_output_bytes = subprocess.check_output([\"hdfs\", \"dfs\", \"-getfacl\", folder_path], stderr=subprocess.STDOUT)\n    \n    # Decode the output to a string\n    acl_output = acl_output_bytes.decode('utf-8')\n\n    # Parse the output to extract the owner information\n    lines = acl_output.split('\\n')\n    owner_line = next(line for line in lines if line.startswith(\"# owner:\"))\n    owner = owner_line.split(':')[1].strip()\n\n    print(f\"The owner of the folder {folder_path} is {owner}\")\nexcept subprocess.CalledProcessError as e:\n    print(f\"Error: {e}\")","user":"e854129","dateUpdated":"2023-09-06T10:15:57+0200","config":{"colWidth":12,"enabled":false,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"The owner of the folder /datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois is e854129"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693986639884_-1664118174","id":"20230906-095039_1609475787","dateCreated":"2023-09-06T09:50:39+0200","dateStarted":"2023-09-06T10:03:00+0200","dateFinished":"2023-09-06T10:03:02+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:80"},{"text":"%pyspark\n# Define the folder path for which you want to change the owner\nfolder_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449\"\n\n# Define the new owner\nnew_owner = \"e854129\"\n\ntry:\n    # Change the owner of the specified folder and its subfolders recursively\n    subprocess.check_call([\"hdfs\", \"dfs\", \"-chown\", \"-R\", f\"{new_owner}:{new_owner}\", folder_path])\n    #subprocess.check_call([\"hdfs\", \"dfs\", \"-chown\", \"-R\", f\"{new_owner}:{new_owner}:{\"RWX\"}\", folder_path])\n    print(f\"Changed the owner of {folder_path} and its subfolders to {new_owner}\")\nexcept subprocess.CalledProcessError as e:\n    print(f\"Error: {e}\")","user":"e854129","dateUpdated":"2023-09-06T10:17:57+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Error: Command '['hdfs', 'dfs', '-chown', '-R', 'e854129:e854129', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449']' returned non-zero exit status 1."},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693987440598_419265351","id":"20230906-100400_1423812896","dateCreated":"2023-09-06T10:04:00+0200","dateStarted":"2023-09-06T10:17:57+0200","dateFinished":"2023-09-06T10:18:00+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:81"},{"text":"%pyspark\nmultiple_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/ZZZ\"\n\nos.makedirs(multiple_dir_path, exist_ok=True)","user":"e854129","dateUpdated":"2023-09-06T10:24:00+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"[Errno 13] Permission denied: '/datalake'\nTraceback (most recent call last):\n  File \"/usr/lib64/python3.6/os.py\", line 210, in makedirs\n    makedirs(head, mode, exist_ok)\n  File \"/usr/lib64/python3.6/os.py\", line 210, in makedirs\n    makedirs(head, mode, exist_ok)\n  File \"/usr/lib64/python3.6/os.py\", line 210, in makedirs\n    makedirs(head, mode, exist_ok)\n  [Previous line repeated 3 more times]\n  File \"/usr/lib64/python3.6/os.py\", line 220, in makedirs\n    mkdir(name, mode)\nPermissionError: [Errno 13] Permission denied: '/datalake'\n"}]},"apps":[],"jobName":"paragraph_1693988527935_-1563216560","id":"20230906-102207_1627096197","dateCreated":"2023-09-06T10:22:07+0200","dateStarted":"2023-09-06T10:24:00+0200","dateFinished":"2023-09-06T10:24:01+0200","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:82"},{"text":"%pyspark\n#files = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\nmultiple_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/ZZZ\"\n\nsubprocess.run('hdfs dfs -mkdir' + multiple_dir_path, shell=True)","user":"e854129","dateUpdated":"2023-09-06T10:37:57+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"CompletedProcess(args='hdfs dfs -mkdir/datalake/prod/c2/ddd/crm/acmf/ZZZ', returncode=255)"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693989124953_-448340130","id":"20230906-103204_597567217","dateCreated":"2023-09-06T10:32:04+0200","dateStarted":"2023-09-06T10:37:57+0200","dateFinished":"2023-09-06T10:37:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:83"},{"text":"%pyspark\n# If you read from the Index folder you will not be to overwrite files in the index folder\nLog_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"\nLog_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/*\"\n\nLog_file_df = spark.read.parquet(Log_files_Archive_Dir_path)\n\nLog_file_df.show(40, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|                                       file_name_no_extension|                                         File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|                                           Raw_file_legacy_folder_path|                                            Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:33|     20230625125833|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:15.241|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222606t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222606t.csv|          .csv|      Raw|           true|       2023-06-26 22:26:06|     20230626222606|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:14.993|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t.csv|          .csv|      Raw|           true|       2023-06-25 13:13:51|     20230625131351|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:31.055|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t.csv|          .csv|      Raw|           true|       2023-06-25 13:22:20|     20230625132220|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:40.255|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t.csv|          .csv|      Raw|           true|       2023-06-25 12:38:06|     20230625123806|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:53.363|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t.csv|          .csv|      Raw|           true|       2023-06-25 13:08:45|     20230625130845|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:26.133|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t.csv|          .csv|      Raw|           true|       2023-06-25 13:30:50|     20230625133050|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:48.617|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222931t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222931t.csv|          .csv|      Raw|           true|       2023-06-26 22:29:31|     20230626222931|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:19.252|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv|          .csv|      Raw|           true|       2023-06-25 12:10:55|     20230625121055|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:24.919|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223942t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223942t.csv|          .csv|      Raw|           true|       2023-06-26 22:39:42|     20230626223942|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:29.349|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t.csv|          .csv|      Raw|           true|       2023-06-25 13:10:27|     20230625131027|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:27.77|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:38|     20230625133738|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:56.185|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t.csv|          .csv|      Raw|           true|       2023-06-25 12:17:43|     20230625121743|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:55:31.95|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t.csv|          .csv|      Raw|           true|       2023-06-25 13:25:44|     20230625132544|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:43.649|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t.csv|          .csv|      Raw|           true|       2023-06-25 12:55:07|     20230625125507|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:11.378|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t.csv|          .csv|      Raw|           true|       2023-06-25 13:00:15|     20230625130015|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:17.671|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t.csv|          .csv|      Raw|           true|       2023-06-25 13:51:16|     20230625135116|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:09.743|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t.csv|          .csv|      Raw|           true|       2023-06-25 12:33:00|     20230625123300|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:48.268|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222748t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626222748t.csv|          .csv|      Raw|           true|       2023-06-26 22:27:48|     20230626222748|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:16.753|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t.csv|          .csv|      Raw|           true|       2023-06-25 13:32:32|     20230625133232|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:50.334|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t.csv|          .csv|      Raw|           true|       2023-06-25 13:47:52|     20230625134752|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:06.424|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t.csv|          .csv|      Raw|           true|       2023-06-25 13:29:08|     20230625132908|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:46.986|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t.csv|          .csv|      Raw|           true|       2023-06-25 12:16:01|     20230625121601|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:30.212|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223800t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626223800t.csv|          .csv|      Raw|           true|       2023-06-26 22:38:00|     20230626223800|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:27.676|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv|          .csv|      Raw|           true|       2023-06-25 12:12:37|     20230625121237|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:26.645|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t.csv|          .csv|      Raw|           true|       2023-06-25 13:01:57|     20230625130157|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:19.394|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t.csv|          .csv|      Raw|           true|       2023-06-25 13:18:57|     20230625131857|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:36.896|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t.csv|          .csv|      Raw|           true|       2023-06-25 12:41:30|     20230625124130|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:57.949|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t.csv|          .csv|      Raw|           true|       2023-06-25 12:36:24|     20230625123624|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:51.673|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t.csv|          .csv|      Raw|           true|       2023-06-25 12:51:43|     20230625125143|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:07.944|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224305t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230626224305t.csv|          .csv|      Raw|           true|       2023-06-26 22:43:05|     20230626224305|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:57:32.62|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t.csv|          .csv|      Raw|           true|       2023-06-25 13:39:21|     20230625133921|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:57.904|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t.csv|          .csv|      Raw|           true|       2023-06-25 12:56:49|     20230625125649|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:13.522|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t.csv|          .csv|      Raw|           true|       2023-06-25 13:05:21|     20230625130521|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:22.811|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t.csv|          .csv|      Raw|           true|       2023-06-25 12:34:42|     20230625123442|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:55:49.98|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t.csv|          .csv|      Raw|           true|       2023-06-25 13:20:39|     20230625132039|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:38.608|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t.csv|          .csv|      Raw|           true|       2023-06-25 13:35:56|     20230625133556|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:53.729|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t.csv|          .csv|      Raw|           true|       2023-06-25 13:07:03|     20230625130703|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:24.477|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t.csv|          .csv|      Raw|           true|       2023-06-25 12:24:30|     20230625122430|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:39.653|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t.csv|          .csv|      Raw|           true|       2023-06-25 13:42:46|     20230625134246|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:01.445|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\nonly showing top 40 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765341_-1861595730","id":"20230901-101646_1607112581","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:84"},{"title":"STEP 3 : Serching for new flight (exemple on one file name)","text":"%pyspark\nfile_name_without_extension_to_analyse = \"TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t\"\n\ntest_files_sharing_flight_df = find_files_sharing_the_same_flight_as_rawFileName(file_name_without_extension_to_analyse)\n\nprint(\"row count = \", test_files_sharing_flight_df.count())\ntest_files_sharing_flight_df.show(150, truncate=15)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row count =  96\n+----------------------+------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+---------------+\n|file_name_no_extension|File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|Raw_file_legacy_folder_path|Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|    Update_Date|\n+----------------------+------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+---------------+\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124312|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625131209|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133921|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125000|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625130703|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124635|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625132908|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125833|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625122612|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134104|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125325|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134428|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625135439|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625131351|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625132544|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625123118|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625122754|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124817|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134934|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134246|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124130|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134610|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133556|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625122248|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625123806|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121419|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625122106|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121601|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625135257|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625131715|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625131027|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625123624|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625130015|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133414|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625123300|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133738|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121924|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625131857|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134752|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625130339|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125649|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625132402|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625132220|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625132039|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625122430|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625123442|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625131533|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625135116|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121743|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625132726|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121055|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625123948|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133232|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625122937|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124454|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625130521|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625130845|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125143|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625130157|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133050|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121237|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125507|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133904|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133307|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125138|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133357|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125826|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133428|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121004|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625120955|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625120955|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 1...|\n|       P1148_ISSUE_...|         P1148_ISSUE_...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121004|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625120933|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|      BLEED|2023-09-01 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124833|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|      CASOV|2023-09-01 1...|\n|       TRD_P1106_IS...|         TRD_P1106_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133131|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|      CASOV|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125740|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       TPMS|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125805|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625130022|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134252|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133950|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133349|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|       LGCS|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134506|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL|2023-09-01 1...|\n|       TRD_P1153_IS...|         TRD_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125814|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|       LGCS|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134259|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625131131|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133731|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       TPMS|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133349|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-01 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625121020|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|        APU|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133802|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125813|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-01 1...|\n|       TRD_P1028_IS...|         TRD_P1028_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625134035|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|        APU|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124747|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625124740|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133725|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625125201|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         TR|2023-09-01 1...|\n|       MUX_P1153_IS...|         MUX_P1153_IS...|          .csv|      Raw|           true|           2023-06-25 1...|     20230625133753|         0580449|  SN449|               0580|            /datalake/pr...|           /datalake/pr...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         TR|2023-09-01 1...|\n+----------------------+------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+---------------------------+--------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+---------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765353_-1878524682","id":"20230829-110415_2127427821","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:85"},{"title":"STEP 3.5 : separate flight and system, find the name of the new flight file","text":"%pyspark\ndef old_version_separate_flight_and_system_filefrom_log_sharing_flight_df(log_sharing_flight_df):\n    # read the df of all the log index file\n    index_log_file_sharing_flight_df = log_sharing_flight_df\n    \n    vol_files_filter_expression = (F.col(\"Is_Vol\") == True)\n    system_files_filter_expression = (F.col(\"Is_System\") == True)\n    \n    # We separate the previous df in 2 smaller df one with the flight file ant the other with the system file, both of them sorted by date\n    vol_files_filtered_df = index_log_file_sharing_flight_df.filter(vol_files_filter_expression).orderBy(F.col(\"File_date_as_TimestampType\").asc())\n    system_files_filtered_df = index_log_file_sharing_flight_df.filter(system_files_filter_expression).orderBy(F.col(\"File_date_as_TimestampType\").asc())\n    return vol_files_filtered_df, system_files_filtered_df\n    \ndef separate_flight_file_from_log_sharing_flight_df(log_sharing_flight_df):\n    # read the df of all the log index file\n    index_log_file_sharing_flight_df = log_sharing_flight_df\n    vol_files_filter_expression = (F.col(\"Is_Vol\") == True)\n    # We separate the previous df in 2 smaller df one with the flight file ant the other with the system file, both of them sorted by date\n    vol_files_filtered_df = index_log_file_sharing_flight_df.filter(vol_files_filter_expression).orderBy(F.col(\"File_date_as_TimestampType\").asc())\n    return vol_files_filtered_df\n\ndef separate_system_file_from_log_sharing_flight_df(log_sharing_flight_df):\n    # read the df of all the log index file\n    index_log_file_sharing_flight_df = log_sharing_flight_df\n    system_files_filter_expression = (F.col(\"Is_System\") == True)\n    # We separate the previous df in 2 smaller df one with the flight file ant the other with the system file, both of them sorted by date\n    system_files_filtered_df = index_log_file_sharing_flight_df.filter(system_files_filter_expression).orderBy(F.col(\"File_date_as_TimestampType\").asc())\n    return system_files_filtered_df\n\ndef is_SN_a_known_7X_serial_number(searched_SN, known_7X_SN_list = ['SN267', 'SN268', 'SN269', 'SN270', '267', '268', '269', '270', 267, 268, 269, 270]):\n    return searched_SN in known_7X_SN_list\n\ndef is_SN_a_known_8X_serial_number(searched_SN, known_8X_SN_list = ['SN412', 'SN425', 'SN449', 'SN455', 'SN466', '412', '425', '449', '455', '466', 412, 425, 449, 455, 466]):\n    return searched_SN in known_8X_SN_list\n    \ndef is_aircraft_model_number_a_known_Falcon_code(searched_aircraft_model, known_Falcon_code = [\"0420\", \"0580\", \"420\", \"580\", 420, 580]):\n    return searched_aircraft_model in known_Falcon_code\n\ndef get_vol_file_name_from_vol_files_filtered_df(volFiles_filtered_df):\n    # Since vol_files_filtered_df was sorted by date (File_date_as_TimestampType) in a previous function, we can extract all the infos we need reading only the first row\n    first_row = volFiles_filtered_df.first()\n    value_1_IRYS2_or_PERFOS = first_row[\"IRYS2_or_PERFOS\"]\n    value_2_File_aircraft_model = first_row[\"File_aircraft_model\"]\n    # If value_2_File_aircraft_model is not a recognised value change the code with an absormal value\n    if not is_aircraft_model_number_a_known_Falcon_code(value_2_File_aircraft_model):\n        value_2_File_aircraft_model = \"0000\"\n        \n    #value_3_File_SN = str(first_row[\"File_SN\"])\n    value_3_File_SN = strip_non_numeric_char_from_string(first_row[\"File_SN\"])\n    # If value_3_File_SN is not a recognised value change the code with an absormal value\n    if not (is_SN_a_known_7X_serial_number(value_3_File_SN) or is_SN_a_known_8X_serial_number(value_3_File_SN)):\n        value_3_File_SN = \"000\"\n        \n    value_4_File_date_as_String = first_row[\"File_date_as_String\"]\n    # The letter t was cut of in previous transformation to keep only digits\n    value_5_missing_letter_t = \"t\"\n    #value_6_vol_file_extension = \".parquet\"\n    \n    vol_file_complete_name = value_1_IRYS2_or_PERFOS + value_2_File_aircraft_model + value_3_File_SN + \"_\" + value_4_File_date_as_String + value_5_missing_letter_t\n    return vol_file_complete_name, value_2_File_aircraft_model, value_3_File_SN\n\ndef collect_a_df_column_into_a_list(df, column_name_string):\n    values_list = df.select(column_name_string).rdd.flatMap(lambda x: x).collect()\n    return values_list\n\n\n\t\t\t\n\t\t\t\n\t\t\t","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1964<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/</a>"}]},"apps":[],"jobName":"paragraph_1693905765365_-1870829704","id":"20230901-122501_1167284723","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:86"},{"title":"Louis Carmier legacy code","text":"%pyspark\ndef fill2(df):\n\tfor c in df.columns[:-3]:\n\t\tdf = df.withColumn(c, F.regexp_replace(c, ' ', ''))\n\treturn df.dropna()\n\t\t\n#retourne la liste des colonnes doublons (pour information avec leur nom d origine), le nouveau header avec les noms modifies, et une liste contenant le nom des colonnes doublons renommees\ndef detect_doublon(header):\n\tcolonnes=[]\n\tliste_doublon=[]\n\tliste_tot_doublons=[]\n\tc=0\n\tnew_header=[]\n\t\n\tfor col in header:\n\t\tif col in colonnes:\n\t\t\tif col in liste_doublon:\n\t\t\t\tc+=1\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\t\n\t\t\telse:\n\t\t\t\tliste_doublon.append(col)\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\telse:\n\t\t\tnew_header.append(col)\n\t\t\tcolonnes.append(col)\n\treturn liste_doublon, new_header, liste_tot_doublons\n\n#En entree un rdd et un header (label des colonnes)\n#En sortie une dataframe  objet qui permet des traitements par colonnes alors que rdd par ligne\ndef data_frame(rdd, header):\n\tschema = StructType([StructField(column, StringType(), True) for column in header])\n\tdf = spark.createDataFrame(rdd, schema)\n\tdf=df.toDF(*(c.replace(' ', '_') for c in df.columns))\n\tdf=df.toDF(*(c.replace('(', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace(')', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace('.', '_') for c in df.columns))\n\treturn df\n\n#En entree un rdd associe a un fichier acmf\n#En sortie les colonnes du fichier ACMF\ndef get_header(rdd):\n\theaderRow = GetSpecificRow(rdd,6).map(lambda x: x[0]).map(lambda x: x.split(',')) #ici les donnees sont separees par des virgules\n\theader = headerRow.first()\n    # If a column name is an empty space chage it for other\n\theader = ['other' if column == ' ' else column for column in header]\n\treturn header\n\t\t\n#En entree un rdd et le numero de ligne\n#En sortie une ligne du rdd\ndef GetSpecificRow(rdd, id):\n\treturn rdd.zipWithIndex().filter(lambda x: x[1]==id)\n\t\t\n#En entree un rdd\n#En sortie l heure de debut d enregistrement\ndef trigger_time(rdd):\n\tTriggerTimeRow = GetSpecificRow(rdd,3).map(lambda x: x[0]).map(lambda x: x.split(' '))\n\tTriggerTime = ' '.join(TriggerTimeRow.first()[1:])\n\treturn TriggerTime\n\n# Insert a date column to the DF using the Trigger and the Frame_100_ms_ columns\n# Insert a date column to the DF using the Trigger and the Frame_100_ms columns\ndef insert_date_udf(df):\n\tdef insert_date_simple(trigger, frame):\n\t\ttrig = datetime.strptime(trigger, \"%d %b %Y %H:%M:%S\")\n\t\tdelta = timedelta(milliseconds=int(frame)*100)\n\t\tdate = trig + delta\n\t\treturn date.strftime(\"%d %m %Y %H:%M:%S.%f\")\n\tinsert_date_udf = F.udf(insert_date_simple, StringType())\n\t\n\t#df=df.withColumn('date', insert_date_udf(df['Trigger'], df['Frame_100_ms_']))\n\tdf=df.withColumn('date', insert_date_udf(df['Trigger'], df['Frame_100_ms']))\n\treturn df\n\ndef create_df_vol_slow(vol):\n\t# vol is a list of IRYS2/PERFOS files\n\trdd,header=create_join_rdd_debug(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_udf(df)\n\t\n\treturn df\n\ndef create_join_rdd_debug(vol):\n\t# c is a counter\n\tc=0\n\t# Read the first six lines header of the file\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tlength0 = rdd1.count()\n\t\n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\t# For every file in the list except the first\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\tif rdd2.count() != length0:\n\t\t\trdd=sc.union(rdds)\n\t\t\treturn rdd,header\n\t\telse:\n\t\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\t\trdd2.collect()\n\t\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1964<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/</a>"}]},"apps":[],"jobName":"paragraph_1693905765377_2111721485","id":"20230901-154957_2117818172","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:87"},{"text":"%pyspark\nrdd1_brut = sc.textFile('/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv')\nprint(rdd1_brut)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv MapPartitionsRDD[15829] at textFile at <unknown>:0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765391_2107873996","id":"20230901-164058_1736362107","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:88"},{"text":"%pyspark\ntest_vol_files_filtered_df = separate_flight_file_from_log_sharing_flight_df(test_files_sharing_flight_df)\n\nprint(\"row count = \", test_vol_files_filtered_df.count())\ntest_vol_files_filtered_df.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row count =  62\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|                                       file_name_no_extension|                                         File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|                                           Raw_file_legacy_folder_path|                                            Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv|          .csv|      Raw|           true|       2023-06-25 12:10:55|     20230625121055|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:24.607|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv|          .csv|      Raw|           true|       2023-06-25 12:12:37|     20230625121237|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|  2023-09-01 11:55:26.3|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t.csv|          .csv|      Raw|           true|       2023-06-25 12:14:19|     20230625121419|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:28.064|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t.csv|          .csv|      Raw|           true|       2023-06-25 12:16:01|     20230625121601|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:29.878|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t.csv|          .csv|      Raw|           true|       2023-06-25 12:17:43|     20230625121743|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:31.609|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t.csv|          .csv|      Raw|           true|       2023-06-25 12:19:24|     20230625121924|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:33.431|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t.csv|          .csv|      Raw|           true|       2023-06-25 12:21:06|     20230625122106|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:35.208|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t.csv|          .csv|      Raw|           true|       2023-06-25 12:22:48|     20230625122248|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:37.661|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t.csv|          .csv|      Raw|           true|       2023-06-25 12:24:30|     20230625122430|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:39.322|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t.csv|          .csv|      Raw|           true|       2023-06-25 12:26:12|     20230625122612|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:41.088|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t.csv|          .csv|      Raw|           true|       2023-06-25 12:27:54|     20230625122754|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:55:42.83|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t.csv|          .csv|      Raw|           true|       2023-06-25 12:29:37|     20230625122937|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:44.534|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t.csv|          .csv|      Raw|           true|       2023-06-25 12:31:18|     20230625123118|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:46.347|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t.csv|          .csv|      Raw|           true|       2023-06-25 12:33:00|     20230625123300|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:47.964|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t.csv|          .csv|      Raw|           true|       2023-06-25 12:34:42|     20230625123442|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:49.653|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t.csv|          .csv|      Raw|           true|       2023-06-25 12:36:24|     20230625123624|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:51.345|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t.csv|          .csv|      Raw|           true|       2023-06-25 12:38:06|     20230625123806|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:53.031|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t.csv|          .csv|      Raw|           true|       2023-06-25 12:39:48|     20230625123948|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:54.996|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t.csv|          .csv|      Raw|           true|       2023-06-25 12:41:30|     20230625124130|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:57.594|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv|          .csv|      Raw|           true|       2023-06-25 12:43:12|     20230625124312|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:59.268|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t.csv|          .csv|      Raw|           true|       2023-06-25 12:44:54|     20230625124454|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:00.885|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t.csv|          .csv|      Raw|           true|       2023-06-25 12:46:35|     20230625124635|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:02.58|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124817t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124817t.csv|          .csv|      Raw|           true|       2023-06-25 12:48:17|     20230625124817|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:04.28|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125000t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125000t.csv|          .csv|      Raw|           true|       2023-06-25 12:50:00|     20230625125000|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:05.909|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t.csv|          .csv|      Raw|           true|       2023-06-25 12:51:43|     20230625125143|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:07.635|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125325t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125325t.csv|          .csv|      Raw|           true|       2023-06-25 12:53:25|     20230625125325|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:09.346|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t.csv|          .csv|      Raw|           true|       2023-06-25 12:55:07|     20230625125507|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:11.048|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t.csv|          .csv|      Raw|           true|       2023-06-25 12:56:49|     20230625125649|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:13.185|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:33|     20230625125833|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:14.886|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t.csv|          .csv|      Raw|           true|       2023-06-25 13:00:15|     20230625130015|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:17.368|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t.csv|          .csv|      Raw|           true|       2023-06-25 13:01:57|     20230625130157|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:19.051|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130339t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130339t.csv|          .csv|      Raw|           true|       2023-06-25 13:03:39|     20230625130339|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:20.79|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t.csv|          .csv|      Raw|           true|       2023-06-25 13:05:21|     20230625130521|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:22.45|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t.csv|          .csv|      Raw|           true|       2023-06-25 13:07:03|     20230625130703|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:24.156|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t.csv|          .csv|      Raw|           true|       2023-06-25 13:08:45|     20230625130845|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:25.811|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t.csv|          .csv|      Raw|           true|       2023-06-25 13:10:27|     20230625131027|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:27.444|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131209t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131209t.csv|          .csv|      Raw|           true|       2023-06-25 13:12:09|     20230625131209|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:29.119|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t.csv|          .csv|      Raw|           true|       2023-06-25 13:13:51|     20230625131351|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:30.748|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131533t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131533t.csv|          .csv|      Raw|           true|       2023-06-25 13:15:33|     20230625131533|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:32.353|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131715t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131715t.csv|          .csv|      Raw|           true|       2023-06-25 13:17:15|     20230625131715|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:34.129|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t.csv|          .csv|      Raw|           true|       2023-06-25 13:18:57|     20230625131857|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:36.563|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t.csv|          .csv|      Raw|           true|       2023-06-25 13:20:39|     20230625132039|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:38.308|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t.csv|          .csv|      Raw|           true|       2023-06-25 13:22:20|     20230625132220|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:39.93|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132402t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132402t.csv|          .csv|      Raw|           true|       2023-06-25 13:24:02|     20230625132402|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:41.657|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t.csv|          .csv|      Raw|           true|       2023-06-25 13:25:44|     20230625132544|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:43.304|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132726t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132726t.csv|          .csv|      Raw|           true|       2023-06-25 13:27:26|     20230625132726|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:44.97|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t.csv|          .csv|      Raw|           true|       2023-06-25 13:29:08|     20230625132908|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:46.639|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t.csv|          .csv|      Raw|           true|       2023-06-25 13:30:50|     20230625133050|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:48.303|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t.csv|          .csv|      Raw|           true|       2023-06-25 13:32:32|     20230625133232|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:49.976|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133414t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133414t.csv|          .csv|      Raw|           true|       2023-06-25 13:34:14|     20230625133414|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:51.702|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t.csv|          .csv|      Raw|           true|       2023-06-25 13:35:56|     20230625133556|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:53.366|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:38|     20230625133738|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:55.858|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t.csv|          .csv|      Raw|           true|       2023-06-25 13:39:21|     20230625133921|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:57.574|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134104t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134104t.csv|          .csv|      Raw|           true|       2023-06-25 13:41:04|     20230625134104|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:59.428|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t.csv|          .csv|      Raw|           true|       2023-06-25 13:42:46|     20230625134246|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:01.096|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134428t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134428t.csv|          .csv|      Raw|           true|       2023-06-25 13:44:28|     20230625134428|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:02.809|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134610t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134610t.csv|          .csv|      Raw|           true|       2023-06-25 13:46:10|     20230625134610|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:04.425|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t.csv|          .csv|      Raw|           true|       2023-06-25 13:47:52|     20230625134752|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:06.047|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134934t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134934t.csv|          .csv|      Raw|           true|       2023-06-25 13:49:34|     20230625134934|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:07.802|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t.csv|          .csv|      Raw|           true|       2023-06-25 13:51:16|     20230625135116|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:09.421|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135257t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135257t.csv|          .csv|      Raw|           true|       2023-06-25 13:52:57|     20230625135257|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:11.087|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135439t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135439t.csv|          .csv|      Raw|           true|       2023-06-25 13:54:39|     20230625135439|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:13.018|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765402_2115953723","id":"20230901-155140_230267232","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:89"},{"text":"%pyspark\ntest_path_list = collect_a_df_column_into_a_list(test_vol_files_filtered_df, \"Raw_file_legacy_folder_path\")\nprint(test_path_list)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124817t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125000t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125325t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130339t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131209t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131533t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131715t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132402t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132726t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133414t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134104t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134428t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134610t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134934t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135257t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135439t.csv']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765415_2098640023","id":"20230901-155518_189266290","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:90"},{"text":"%pyspark\n# /datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv is full of invalid let's try the same list without it\n\ntest_path_list = ['/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124817t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125000t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125325t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130339t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131209t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131533t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131715t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132402t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132726t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133414t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134104t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134428t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134610t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134934t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135257t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135439t.csv']","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765427_2106335001","id":"20230901-165125_1325176292","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:91"},{"text":"%pyspark\nrdd,header = create_join_rdd_debug(test_path_list)\nprint(header)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Frame (100 ms)', 'Trigger', 'Part']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765439_2101718014","id":"20230901-155751_1190287178","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:92"},{"text":"%pyspark\nrdd_to_df = rdd.toDF(header)\nrdd_to_df.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------+--------------------+----+\n|Frame (100 ms)|             Trigger|Part|\n+--------------+--------------------+----+\n|             0|25 JUN 2023 12:10:56|   0|\n|             1|25 JUN 2023 12:10:56|   0|\n|             2|25 JUN 2023 12:10:56|   0|\n|             3|25 JUN 2023 12:10:56|   0|\n|             4|25 JUN 2023 12:10:56|   0|\n|             5|25 JUN 2023 12:10:56|   0|\n|             6|25 JUN 2023 12:10:56|   0|\n|             7|25 JUN 2023 12:10:56|   0|\n|             8|25 JUN 2023 12:10:56|   0|\n|             9|25 JUN 2023 12:10:56|   0|\n|            10|25 JUN 2023 12:10:56|   0|\n|            11|25 JUN 2023 12:10:56|   0|\n|            12|25 JUN 2023 12:10:56|   0|\n|            13|25 JUN 2023 12:10:56|   0|\n|            14|25 JUN 2023 12:10:56|   0|\n|            15|25 JUN 2023 12:10:56|   0|\n|            16|25 JUN 2023 12:10:56|   0|\n|            17|25 JUN 2023 12:10:56|   0|\n|            18|25 JUN 2023 12:10:56|   0|\n|            19|25 JUN 2023 12:10:56|   0|\n|            20|25 JUN 2023 12:10:56|   0|\n|            21|25 JUN 2023 12:10:56|   0|\n|            22|25 JUN 2023 12:10:56|   0|\n|            23|25 JUN 2023 12:10:56|   0|\n|            24|25 JUN 2023 12:10:56|   0|\n|            25|25 JUN 2023 12:10:56|   0|\n|            26|25 JUN 2023 12:10:56|   0|\n|            27|25 JUN 2023 12:10:56|   0|\n|            28|25 JUN 2023 12:10:56|   0|\n|            29|25 JUN 2023 12:10:56|   0|\n|            30|25 JUN 2023 12:10:56|   0|\n|            31|25 JUN 2023 12:10:56|   0|\n|            32|25 JUN 2023 12:10:56|   0|\n|            33|25 JUN 2023 12:10:56|   0|\n|            34|25 JUN 2023 12:10:56|   0|\n|            35|25 JUN 2023 12:10:56|   0|\n|            36|25 JUN 2023 12:10:56|   0|\n|            37|25 JUN 2023 12:10:56|   0|\n|            38|25 JUN 2023 12:10:56|   0|\n|            39|25 JUN 2023 12:10:56|   0|\n|            40|25 JUN 2023 12:10:56|   0|\n|            41|25 JUN 2023 12:10:56|   0|\n|            42|25 JUN 2023 12:10:56|   0|\n|            43|25 JUN 2023 12:10:56|   0|\n|            44|25 JUN 2023 12:10:56|   0|\n|            45|25 JUN 2023 12:10:56|   0|\n|            46|25 JUN 2023 12:10:56|   0|\n|            47|25 JUN 2023 12:10:56|   0|\n|            48|25 JUN 2023 12:10:56|   0|\n|            49|25 JUN 2023 12:10:56|   0|\n|            50|25 JUN 2023 12:10:56|   0|\n|            51|25 JUN 2023 12:10:56|   0|\n|            52|25 JUN 2023 12:10:56|   0|\n|            53|25 JUN 2023 12:10:56|   0|\n|            54|25 JUN 2023 12:10:56|   0|\n|            55|25 JUN 2023 12:10:56|   0|\n|            56|25 JUN 2023 12:10:56|   0|\n|            57|25 JUN 2023 12:10:56|   0|\n|            58|25 JUN 2023 12:10:56|   0|\n|            59|25 JUN 2023 12:10:56|   0|\n|            60|25 JUN 2023 12:10:56|   0|\n|            61|25 JUN 2023 12:10:56|   0|\n|            62|25 JUN 2023 12:10:56|   0|\n|            63|25 JUN 2023 12:10:56|   0|\n|            64|25 JUN 2023 12:10:56|   0|\n|            65|25 JUN 2023 12:10:56|   0|\n|            66|25 JUN 2023 12:10:56|   0|\n|            67|25 JUN 2023 12:10:56|   0|\n|            68|25 JUN 2023 12:10:56|   0|\n|            69|25 JUN 2023 12:10:56|   0|\n|            70|25 JUN 2023 12:10:56|   0|\n|            71|25 JUN 2023 12:10:56|   0|\n|            72|25 JUN 2023 12:10:56|   0|\n|            73|25 JUN 2023 12:10:56|   0|\n|            74|25 JUN 2023 12:10:56|   0|\n|            75|25 JUN 2023 12:10:56|   0|\n|            76|25 JUN 2023 12:10:56|   0|\n|            77|25 JUN 2023 12:10:56|   0|\n|            78|25 JUN 2023 12:10:56|   0|\n|            79|25 JUN 2023 12:10:56|   0|\n|            80|25 JUN 2023 12:10:56|   0|\n|            81|25 JUN 2023 12:10:56|   0|\n|            82|25 JUN 2023 12:10:56|   0|\n|            83|25 JUN 2023 12:10:56|   0|\n|            84|25 JUN 2023 12:10:56|   0|\n|            85|25 JUN 2023 12:10:56|   0|\n|            86|25 JUN 2023 12:10:56|   0|\n|            87|25 JUN 2023 12:10:56|   0|\n|            88|25 JUN 2023 12:10:56|   0|\n|            89|25 JUN 2023 12:10:56|   0|\n|            90|25 JUN 2023 12:10:56|   0|\n|            91|25 JUN 2023 12:10:56|   0|\n|            92|25 JUN 2023 12:10:56|   0|\n|            93|25 JUN 2023 12:10:56|   0|\n|            94|25 JUN 2023 12:10:56|   0|\n|            95|25 JUN 2023 12:10:56|   0|\n|            96|25 JUN 2023 12:10:56|   0|\n|            97|25 JUN 2023 12:10:56|   0|\n|            98|25 JUN 2023 12:10:56|   0|\n|            99|25 JUN 2023 12:10:56|   0|\n|           100|25 JUN 2023 12:10:56|   0|\n|           101|25 JUN 2023 12:10:56|   0|\n|           102|25 JUN 2023 12:10:56|   0|\n|           103|25 JUN 2023 12:10:56|   0|\n|           104|25 JUN 2023 12:10:56|   0|\n|           105|25 JUN 2023 12:10:56|   0|\n|           106|25 JUN 2023 12:10:56|   0|\n|           107|25 JUN 2023 12:10:56|   0|\n|           108|25 JUN 2023 12:10:56|   0|\n|           109|25 JUN 2023 12:10:56|   0|\n|           110|25 JUN 2023 12:10:56|   0|\n|           111|25 JUN 2023 12:10:56|   0|\n|           112|25 JUN 2023 12:10:56|   0|\n|           113|25 JUN 2023 12:10:56|   0|\n|           114|25 JUN 2023 12:10:56|   0|\n|           115|25 JUN 2023 12:10:56|   0|\n|           116|25 JUN 2023 12:10:56|   0|\n|           117|25 JUN 2023 12:10:56|   0|\n|           118|25 JUN 2023 12:10:56|   0|\n|           119|25 JUN 2023 12:10:56|   0|\n|           120|25 JUN 2023 12:10:56|   0|\n|           121|25 JUN 2023 12:10:56|   0|\n|           122|25 JUN 2023 12:10:56|   0|\n|           123|25 JUN 2023 12:10:56|   0|\n|           124|25 JUN 2023 12:10:56|   0|\n|           125|25 JUN 2023 12:10:56|   0|\n|           126|25 JUN 2023 12:10:56|   0|\n|           127|25 JUN 2023 12:10:56|   0|\n|           128|25 JUN 2023 12:10:56|   0|\n|           129|25 JUN 2023 12:10:56|   0|\n|           130|25 JUN 2023 12:10:56|   0|\n|           131|25 JUN 2023 12:10:56|   0|\n|           132|25 JUN 2023 12:10:56|   0|\n|           133|25 JUN 2023 12:10:56|   0|\n|           134|25 JUN 2023 12:10:56|   0|\n|           135|25 JUN 2023 12:10:56|   0|\n|           136|25 JUN 2023 12:10:56|   0|\n|           137|25 JUN 2023 12:10:56|   0|\n|           138|25 JUN 2023 12:10:56|   0|\n|           139|25 JUN 2023 12:10:56|   0|\n|           140|25 JUN 2023 12:10:56|   0|\n|           141|25 JUN 2023 12:10:56|   0|\n|           142|25 JUN 2023 12:10:56|   0|\n|           143|25 JUN 2023 12:10:56|   0|\n|           144|25 JUN 2023 12:10:56|   0|\n|           145|25 JUN 2023 12:10:56|   0|\n|           146|25 JUN 2023 12:10:56|   0|\n|           147|25 JUN 2023 12:10:56|   0|\n|           148|25 JUN 2023 12:10:56|   0|\n|           149|25 JUN 2023 12:10:56|   0|\n+--------------+--------------------+----+\nonly showing top 150 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765451_2084789062","id":"20230901-160304_881202921","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:93"},{"text":"%pyspark\ndf_from_create_df_vol_slow = create_df_vol_slow(test_path_list)\ndf_from_create_df_vol_slow.show(1000, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+----+--------------------------+\n|Frame_100_ms|             Trigger|Part|                      date|\n+------------+--------------------+----+--------------------------+\n|           0|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.000000|\n|           1|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.100000|\n|           2|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.200000|\n|           3|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.300000|\n|           4|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.400000|\n|           5|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.500000|\n|           6|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.600000|\n|           7|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.700000|\n|           8|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.800000|\n|           9|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:56.900000|\n|          10|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.000000|\n|          11|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.100000|\n|          12|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.200000|\n|          13|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.300000|\n|          14|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.400000|\n|          15|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.500000|\n|          16|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.600000|\n|          17|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.700000|\n|          18|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.800000|\n|          19|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:57.900000|\n|          20|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.000000|\n|          21|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.100000|\n|          22|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.200000|\n|          23|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.300000|\n|          24|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.400000|\n|          25|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.500000|\n|          26|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.600000|\n|          27|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.700000|\n|          28|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.800000|\n|          29|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:58.900000|\n|          30|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.000000|\n|          31|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.100000|\n|          32|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.200000|\n|          33|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.300000|\n|          34|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.400000|\n|          35|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.500000|\n|          36|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.600000|\n|          37|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.700000|\n|          38|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.800000|\n|          39|25 JUN 2023 12:10:56|   0|25 06 2023 12:10:59.900000|\n|          40|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.000000|\n|          41|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.100000|\n|          42|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.200000|\n|          43|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.300000|\n|          44|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.400000|\n|          45|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.500000|\n|          46|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.600000|\n|          47|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.700000|\n|          48|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.800000|\n|          49|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:00.900000|\n|          50|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.000000|\n|          51|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.100000|\n|          52|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.200000|\n|          53|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.300000|\n|          54|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.400000|\n|          55|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.500000|\n|          56|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.600000|\n|          57|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.700000|\n|          58|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.800000|\n|          59|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:01.900000|\n|          60|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.000000|\n|          61|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.100000|\n|          62|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.200000|\n|          63|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.300000|\n|          64|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.400000|\n|          65|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.500000|\n|          66|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.600000|\n|          67|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.700000|\n|          68|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.800000|\n|          69|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:02.900000|\n|          70|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.000000|\n|          71|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.100000|\n|          72|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.200000|\n|          73|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.300000|\n|          74|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.400000|\n|          75|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.500000|\n|          76|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.600000|\n|          77|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.700000|\n|          78|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.800000|\n|          79|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:03.900000|\n|          80|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.000000|\n|          81|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.100000|\n|          82|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.200000|\n|          83|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.300000|\n|          84|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.400000|\n|          85|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.500000|\n|          86|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.600000|\n|          87|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.700000|\n|          88|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.800000|\n|          89|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:04.900000|\n|          90|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.000000|\n|          91|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.100000|\n|          92|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.200000|\n|          93|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.300000|\n|          94|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.400000|\n|          95|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.500000|\n|          96|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.600000|\n|          97|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.700000|\n|          98|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.800000|\n|          99|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:05.900000|\n|         100|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.000000|\n|         101|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.100000|\n|         102|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.200000|\n|         103|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.300000|\n|         104|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.400000|\n|         105|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.500000|\n|         106|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.600000|\n|         107|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.700000|\n|         108|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.800000|\n|         109|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:06.900000|\n|         110|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.000000|\n|         111|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.100000|\n|         112|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.200000|\n|         113|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.300000|\n|         114|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.400000|\n|         115|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.500000|\n|         116|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.600000|\n|         117|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.700000|\n|         118|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.800000|\n|         119|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:07.900000|\n|         120|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.000000|\n|         121|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.100000|\n|         122|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.200000|\n|         123|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.300000|\n|         124|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.400000|\n|         125|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.500000|\n|         126|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.600000|\n|         127|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.700000|\n|         128|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.800000|\n|         129|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:08.900000|\n|         130|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.000000|\n|         131|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.100000|\n|         132|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.200000|\n|         133|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.300000|\n|         134|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.400000|\n|         135|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.500000|\n|         136|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.600000|\n|         137|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.700000|\n|         138|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.800000|\n|         139|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:09.900000|\n|         140|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.000000|\n|         141|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.100000|\n|         142|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.200000|\n|         143|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.300000|\n|         144|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.400000|\n|         145|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.500000|\n|         146|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.600000|\n|         147|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.700000|\n|         148|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.800000|\n|         149|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:10.900000|\n|         150|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.000000|\n|         151|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.100000|\n|         152|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.200000|\n|         153|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.300000|\n|         154|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.400000|\n|         155|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.500000|\n|         156|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.600000|\n|         157|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.700000|\n|         158|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.800000|\n|         159|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:11.900000|\n|         160|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.000000|\n|         161|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.100000|\n|         162|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.200000|\n|         163|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.300000|\n|         164|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.400000|\n|         165|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.500000|\n|         166|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.600000|\n|         167|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.700000|\n|         168|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.800000|\n|         169|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:12.900000|\n|         170|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.000000|\n|         171|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.100000|\n|         172|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.200000|\n|         173|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.300000|\n|         174|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.400000|\n|         175|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.500000|\n|         176|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.600000|\n|         177|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.700000|\n|         178|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.800000|\n|         179|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:13.900000|\n|         180|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.000000|\n|         181|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.100000|\n|         182|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.200000|\n|         183|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.300000|\n|         184|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.400000|\n|         185|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.500000|\n|         186|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.600000|\n|         187|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.700000|\n|         188|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.800000|\n|         189|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:14.900000|\n|         190|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.000000|\n|         191|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.100000|\n|         192|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.200000|\n|         193|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.300000|\n|         194|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.400000|\n|         195|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.500000|\n|         196|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.600000|\n|         197|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.700000|\n|         198|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.800000|\n|         199|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:15.900000|\n|         200|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.000000|\n|         201|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.100000|\n|         202|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.200000|\n|         203|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.300000|\n|         204|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.400000|\n|         205|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.500000|\n|         206|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.600000|\n|         207|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.700000|\n|         208|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.800000|\n|         209|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:16.900000|\n|         210|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.000000|\n|         211|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.100000|\n|         212|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.200000|\n|         213|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.300000|\n|         214|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.400000|\n|         215|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.500000|\n|         216|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.600000|\n|         217|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.700000|\n|         218|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.800000|\n|         219|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:17.900000|\n|         220|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.000000|\n|         221|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.100000|\n|         222|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.200000|\n|         223|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.300000|\n|         224|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.400000|\n|         225|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.500000|\n|         226|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.600000|\n|         227|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.700000|\n|         228|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.800000|\n|         229|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:18.900000|\n|         230|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.000000|\n|         231|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.100000|\n|         232|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.200000|\n|         233|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.300000|\n|         234|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.400000|\n|         235|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.500000|\n|         236|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.600000|\n|         237|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.700000|\n|         238|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.800000|\n|         239|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:19.900000|\n|         240|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.000000|\n|         241|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.100000|\n|         242|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.200000|\n|         243|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.300000|\n|         244|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.400000|\n|         245|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.500000|\n|         246|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.600000|\n|         247|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.700000|\n|         248|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.800000|\n|         249|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:20.900000|\n|         250|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.000000|\n|         251|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.100000|\n|         252|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.200000|\n|         253|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.300000|\n|         254|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.400000|\n|         255|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.500000|\n|         256|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.600000|\n|         257|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.700000|\n|         258|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.800000|\n|         259|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:21.900000|\n|         260|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.000000|\n|         261|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.100000|\n|         262|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.200000|\n|         263|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.300000|\n|         264|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.400000|\n|         265|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.500000|\n|         266|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.600000|\n|         267|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.700000|\n|         268|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.800000|\n|         269|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:22.900000|\n|         270|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.000000|\n|         271|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.100000|\n|         272|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.200000|\n|         273|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.300000|\n|         274|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.400000|\n|         275|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.500000|\n|         276|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.600000|\n|         277|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.700000|\n|         278|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.800000|\n|         279|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:23.900000|\n|         280|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.000000|\n|         281|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.100000|\n|         282|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.200000|\n|         283|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.300000|\n|         284|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.400000|\n|         285|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.500000|\n|         286|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.600000|\n|         287|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.700000|\n|         288|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.800000|\n|         289|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:24.900000|\n|         290|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.000000|\n|         291|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.100000|\n|         292|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.200000|\n|         293|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.300000|\n|         294|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.400000|\n|         295|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.500000|\n|         296|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.600000|\n|         297|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.700000|\n|         298|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.800000|\n|         299|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:25.900000|\n|         300|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.000000|\n|         301|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.100000|\n|         302|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.200000|\n|         303|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.300000|\n|         304|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.400000|\n|         305|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.500000|\n|         306|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.600000|\n|         307|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.700000|\n|         308|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.800000|\n|         309|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:26.900000|\n|         310|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.000000|\n|         311|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.100000|\n|         312|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.200000|\n|         313|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.300000|\n|         314|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.400000|\n|         315|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.500000|\n|         316|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.600000|\n|         317|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.700000|\n|         318|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.800000|\n|         319|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:27.900000|\n|         320|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.000000|\n|         321|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.100000|\n|         322|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.200000|\n|         323|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.300000|\n|         324|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.400000|\n|         325|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.500000|\n|         326|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.600000|\n|         327|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.700000|\n|         328|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.800000|\n|         329|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:28.900000|\n|         330|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.000000|\n|         331|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.100000|\n|         332|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.200000|\n|         333|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.300000|\n|         334|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.400000|\n|         335|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.500000|\n|         336|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.600000|\n|         337|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.700000|\n|         338|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.800000|\n|         339|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:29.900000|\n|         340|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.000000|\n|         341|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.100000|\n|         342|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.200000|\n|         343|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.300000|\n|         344|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.400000|\n|         345|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.500000|\n|         346|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.600000|\n|         347|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.700000|\n|         348|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.800000|\n|         349|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:30.900000|\n|         350|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.000000|\n|         351|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.100000|\n|         352|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.200000|\n|         353|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.300000|\n|         354|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.400000|\n|         355|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.500000|\n|         356|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.600000|\n|         357|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.700000|\n|         358|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.800000|\n|         359|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:31.900000|\n|         360|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.000000|\n|         361|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.100000|\n|         362|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.200000|\n|         363|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.300000|\n|         364|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.400000|\n|         365|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.500000|\n|         366|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.600000|\n|         367|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.700000|\n|         368|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.800000|\n|         369|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:32.900000|\n|         370|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.000000|\n|         371|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.100000|\n|         372|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.200000|\n|         373|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.300000|\n|         374|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.400000|\n|         375|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.500000|\n|         376|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.600000|\n|         377|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.700000|\n|         378|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.800000|\n|         379|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:33.900000|\n|         380|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.000000|\n|         381|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.100000|\n|         382|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.200000|\n|         383|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.300000|\n|         384|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.400000|\n|         385|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.500000|\n|         386|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.600000|\n|         387|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.700000|\n|         388|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.800000|\n|         389|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:34.900000|\n|         390|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.000000|\n|         391|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.100000|\n|         392|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.200000|\n|         393|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.300000|\n|         394|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.400000|\n|         395|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.500000|\n|         396|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.600000|\n|         397|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.700000|\n|         398|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.800000|\n|         399|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:35.900000|\n|         400|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.000000|\n|         401|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.100000|\n|         402|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.200000|\n|         403|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.300000|\n|         404|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.400000|\n|         405|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.500000|\n|         406|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.600000|\n|         407|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.700000|\n|         408|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.800000|\n|         409|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:36.900000|\n|         410|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.000000|\n|         411|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.100000|\n|         412|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.200000|\n|         413|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.300000|\n|         414|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.400000|\n|         415|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.500000|\n|         416|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.600000|\n|         417|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.700000|\n|         418|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.800000|\n|         419|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:37.900000|\n|         420|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.000000|\n|         421|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.100000|\n|         422|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.200000|\n|         423|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.300000|\n|         424|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.400000|\n|         425|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.500000|\n|         426|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.600000|\n|         427|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.700000|\n|         428|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.800000|\n|         429|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:38.900000|\n|         430|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.000000|\n|         431|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.100000|\n|         432|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.200000|\n|         433|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.300000|\n|         434|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.400000|\n|         435|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.500000|\n|         436|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.600000|\n|         437|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.700000|\n|         438|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.800000|\n|         439|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:39.900000|\n|         440|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.000000|\n|         441|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.100000|\n|         442|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.200000|\n|         443|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.300000|\n|         444|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.400000|\n|         445|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.500000|\n|         446|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.600000|\n|         447|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.700000|\n|         448|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.800000|\n|         449|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:40.900000|\n|         450|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.000000|\n|         451|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.100000|\n|         452|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.200000|\n|         453|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.300000|\n|         454|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.400000|\n|         455|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.500000|\n|         456|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.600000|\n|         457|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.700000|\n|         458|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.800000|\n|         459|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:41.900000|\n|         460|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.000000|\n|         461|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.100000|\n|         462|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.200000|\n|         463|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.300000|\n|         464|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.400000|\n|         465|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.500000|\n|         466|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.600000|\n|         467|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.700000|\n|         468|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.800000|\n|         469|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:42.900000|\n|         470|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.000000|\n|         471|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.100000|\n|         472|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.200000|\n|         473|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.300000|\n|         474|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.400000|\n|         475|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.500000|\n|         476|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.600000|\n|         477|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.700000|\n|         478|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.800000|\n|         479|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:43.900000|\n|         480|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.000000|\n|         481|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.100000|\n|         482|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.200000|\n|         483|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.300000|\n|         484|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.400000|\n|         485|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.500000|\n|         486|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.600000|\n|         487|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.700000|\n|         488|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.800000|\n|         489|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:44.900000|\n|         490|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.000000|\n|         491|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.100000|\n|         492|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.200000|\n|         493|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.300000|\n|         494|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.400000|\n|         495|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.500000|\n|         496|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.600000|\n|         497|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.700000|\n|         498|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.800000|\n|         499|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:45.900000|\n|         500|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.000000|\n|         501|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.100000|\n|         502|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.200000|\n|         503|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.300000|\n|         504|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.400000|\n|         505|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.500000|\n|         506|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.600000|\n|         507|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.700000|\n|         508|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.800000|\n|         509|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:46.900000|\n|         510|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.000000|\n|         511|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.100000|\n|         512|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.200000|\n|         513|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.300000|\n|         514|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.400000|\n|         515|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.500000|\n|         516|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.600000|\n|         517|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.700000|\n|         518|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.800000|\n|         519|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:47.900000|\n|         520|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.000000|\n|         521|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.100000|\n|         522|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.200000|\n|         523|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.300000|\n|         524|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.400000|\n|         525|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.500000|\n|         526|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.600000|\n|         527|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.700000|\n|         528|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.800000|\n|         529|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:48.900000|\n|         530|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.000000|\n|         531|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.100000|\n|         532|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.200000|\n|         533|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.300000|\n|         534|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.400000|\n|         535|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.500000|\n|         536|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.600000|\n|         537|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.700000|\n|         538|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.800000|\n|         539|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:49.900000|\n|         540|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.000000|\n|         541|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.100000|\n|         542|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.200000|\n|         543|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.300000|\n|         544|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.400000|\n|         545|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.500000|\n|         546|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.600000|\n|         547|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.700000|\n|         548|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.800000|\n|         549|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:50.900000|\n|         550|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.000000|\n|         551|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.100000|\n|         552|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.200000|\n|         553|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.300000|\n|         554|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.400000|\n|         555|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.500000|\n|         556|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.600000|\n|         557|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.700000|\n|         558|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.800000|\n|         559|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:51.900000|\n|         560|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.000000|\n|         561|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.100000|\n|         562|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.200000|\n|         563|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.300000|\n|         564|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.400000|\n|         565|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.500000|\n|         566|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.600000|\n|         567|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.700000|\n|         568|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.800000|\n|         569|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:52.900000|\n|         570|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.000000|\n|         571|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.100000|\n|         572|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.200000|\n|         573|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.300000|\n|         574|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.400000|\n|         575|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.500000|\n|         576|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.600000|\n|         577|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.700000|\n|         578|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.800000|\n|         579|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:53.900000|\n|         580|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.000000|\n|         581|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.100000|\n|         582|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.200000|\n|         583|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.300000|\n|         584|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.400000|\n|         585|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.500000|\n|         586|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.600000|\n|         587|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.700000|\n|         588|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.800000|\n|         589|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:54.900000|\n|         590|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.000000|\n|         591|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.100000|\n|         592|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.200000|\n|         593|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.300000|\n|         594|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.400000|\n|         595|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.500000|\n|         596|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.600000|\n|         597|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.700000|\n|         598|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.800000|\n|         599|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:55.900000|\n|         600|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.000000|\n|         601|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.100000|\n|         602|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.200000|\n|         603|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.300000|\n|         604|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.400000|\n|         605|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.500000|\n|         606|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.600000|\n|         607|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.700000|\n|         608|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.800000|\n|         609|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:56.900000|\n|         610|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.000000|\n|         611|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.100000|\n|         612|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.200000|\n|         613|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.300000|\n|         614|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.400000|\n|         615|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.500000|\n|         616|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.600000|\n|         617|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.700000|\n|         618|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.800000|\n|         619|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:57.900000|\n|         620|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.000000|\n|         621|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.100000|\n|         622|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.200000|\n|         623|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.300000|\n|         624|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.400000|\n|         625|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.500000|\n|         626|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.600000|\n|         627|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.700000|\n|         628|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.800000|\n|         629|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:58.900000|\n|         630|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.000000|\n|         631|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.100000|\n|         632|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.200000|\n|         633|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.300000|\n|         634|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.400000|\n|         635|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.500000|\n|         636|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.600000|\n|         637|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.700000|\n|         638|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.800000|\n|         639|25 JUN 2023 12:10:56|   0|25 06 2023 12:11:59.900000|\n|         640|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.000000|\n|         641|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.100000|\n|         642|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.200000|\n|         643|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.300000|\n|         644|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.400000|\n|         645|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.500000|\n|         646|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.600000|\n|         647|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.700000|\n|         648|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.800000|\n|         649|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:00.900000|\n|         650|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.000000|\n|         651|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.100000|\n|         652|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.200000|\n|         653|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.300000|\n|         654|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.400000|\n|         655|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.500000|\n|         656|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.600000|\n|         657|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.700000|\n|         658|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.800000|\n|         659|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:01.900000|\n|         660|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.000000|\n|         661|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.100000|\n|         662|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.200000|\n|         663|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.300000|\n|         664|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.400000|\n|         665|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.500000|\n|         666|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.600000|\n|         667|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.700000|\n|         668|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.800000|\n|         669|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:02.900000|\n|         670|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.000000|\n|         671|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.100000|\n|         672|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.200000|\n|         673|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.300000|\n|         674|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.400000|\n|         675|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.500000|\n|         676|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.600000|\n|         677|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.700000|\n|         678|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.800000|\n|         679|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:03.900000|\n|         680|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.000000|\n|         681|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.100000|\n|         682|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.200000|\n|         683|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.300000|\n|         684|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.400000|\n|         685|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.500000|\n|         686|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.600000|\n|         687|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.700000|\n|         688|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.800000|\n|         689|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:04.900000|\n|         690|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.000000|\n|         691|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.100000|\n|         692|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.200000|\n|         693|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.300000|\n|         694|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.400000|\n|         695|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.500000|\n|         696|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.600000|\n|         697|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.700000|\n|         698|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.800000|\n|         699|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:05.900000|\n|         700|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.000000|\n|         701|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.100000|\n|         702|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.200000|\n|         703|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.300000|\n|         704|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.400000|\n|         705|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.500000|\n|         706|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.600000|\n|         707|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.700000|\n|         708|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.800000|\n|         709|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:06.900000|\n|         710|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.000000|\n|         711|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.100000|\n|         712|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.200000|\n|         713|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.300000|\n|         714|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.400000|\n|         715|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.500000|\n|         716|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.600000|\n|         717|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.700000|\n|         718|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.800000|\n|         719|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:07.900000|\n|         720|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.000000|\n|         721|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.100000|\n|         722|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.200000|\n|         723|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.300000|\n|         724|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.400000|\n|         725|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.500000|\n|         726|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.600000|\n|         727|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.700000|\n|         728|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.800000|\n|         729|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:08.900000|\n|         730|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.000000|\n|         731|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.100000|\n|         732|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.200000|\n|         733|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.300000|\n|         734|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.400000|\n|         735|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.500000|\n|         736|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.600000|\n|         737|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.700000|\n|         738|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.800000|\n|         739|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:09.900000|\n|         740|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.000000|\n|         741|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.100000|\n|         742|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.200000|\n|         743|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.300000|\n|         744|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.400000|\n|         745|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.500000|\n|         746|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.600000|\n|         747|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.700000|\n|         748|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.800000|\n|         749|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:10.900000|\n|         750|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.000000|\n|         751|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.100000|\n|         752|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.200000|\n|         753|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.300000|\n|         754|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.400000|\n|         755|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.500000|\n|         756|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.600000|\n|         757|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.700000|\n|         758|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.800000|\n|         759|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:11.900000|\n|         760|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.000000|\n|         761|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.100000|\n|         762|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.200000|\n|         763|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.300000|\n|         764|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.400000|\n|         765|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.500000|\n|         766|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.600000|\n|         767|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.700000|\n|         768|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.800000|\n|         769|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:12.900000|\n|         770|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.000000|\n|         771|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.100000|\n|         772|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.200000|\n|         773|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.300000|\n|         774|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.400000|\n|         775|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.500000|\n|         776|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.600000|\n|         777|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.700000|\n|         778|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.800000|\n|         779|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:13.900000|\n|         780|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.000000|\n|         781|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.100000|\n|         782|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.200000|\n|         783|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.300000|\n|         784|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.400000|\n|         785|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.500000|\n|         786|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.600000|\n|         787|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.700000|\n|         788|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.800000|\n|         789|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:14.900000|\n|         790|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.000000|\n|         791|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.100000|\n|         792|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.200000|\n|         793|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.300000|\n|         794|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.400000|\n|         795|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.500000|\n|         796|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.600000|\n|         797|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.700000|\n|         798|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.800000|\n|         799|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:15.900000|\n|         800|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.000000|\n|         801|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.100000|\n|         802|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.200000|\n|         803|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.300000|\n|         804|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.400000|\n|         805|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.500000|\n|         806|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.600000|\n|         807|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.700000|\n|         808|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.800000|\n|         809|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:16.900000|\n|         810|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.000000|\n|         811|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.100000|\n|         812|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.200000|\n|         813|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.300000|\n|         814|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.400000|\n|         815|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.500000|\n|         816|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.600000|\n|         817|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.700000|\n|         818|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.800000|\n|         819|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:17.900000|\n|         820|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.000000|\n|         821|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.100000|\n|         822|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.200000|\n|         823|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.300000|\n|         824|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.400000|\n|         825|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.500000|\n|         826|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.600000|\n|         827|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.700000|\n|         828|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.800000|\n|         829|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:18.900000|\n|         830|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.000000|\n|         831|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.100000|\n|         832|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.200000|\n|         833|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.300000|\n|         834|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.400000|\n|         835|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.500000|\n|         836|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.600000|\n|         837|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.700000|\n|         838|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.800000|\n|         839|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:19.900000|\n|         840|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.000000|\n|         841|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.100000|\n|         842|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.200000|\n|         843|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.300000|\n|         844|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.400000|\n|         845|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.500000|\n|         846|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.600000|\n|         847|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.700000|\n|         848|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.800000|\n|         849|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:20.900000|\n|         850|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.000000|\n|         851|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.100000|\n|         852|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.200000|\n|         853|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.300000|\n|         854|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.400000|\n|         855|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.500000|\n|         856|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.600000|\n|         857|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.700000|\n|         858|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.800000|\n|         859|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:21.900000|\n|         860|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.000000|\n|         861|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.100000|\n|         862|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.200000|\n|         863|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.300000|\n|         864|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.400000|\n|         865|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.500000|\n|         866|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.600000|\n|         867|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.700000|\n|         868|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.800000|\n|         869|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:22.900000|\n|         870|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.000000|\n|         871|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.100000|\n|         872|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.200000|\n|         873|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.300000|\n|         874|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.400000|\n|         875|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.500000|\n|         876|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.600000|\n|         877|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.700000|\n|         878|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.800000|\n|         879|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:23.900000|\n|         880|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.000000|\n|         881|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.100000|\n|         882|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.200000|\n|         883|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.300000|\n|         884|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.400000|\n|         885|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.500000|\n|         886|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.600000|\n|         887|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.700000|\n|         888|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.800000|\n|         889|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:24.900000|\n|         890|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.000000|\n|         891|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.100000|\n|         892|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.200000|\n|         893|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.300000|\n|         894|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.400000|\n|         895|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.500000|\n|         896|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.600000|\n|         897|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.700000|\n|         898|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.800000|\n|         899|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:25.900000|\n|         900|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.000000|\n|         901|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.100000|\n|         902|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.200000|\n|         903|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.300000|\n|         904|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.400000|\n|         905|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.500000|\n|         906|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.600000|\n|         907|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.700000|\n|         908|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.800000|\n|         909|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:26.900000|\n|         910|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.000000|\n|         911|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.100000|\n|         912|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.200000|\n|         913|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.300000|\n|         914|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.400000|\n|         915|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.500000|\n|         916|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.600000|\n|         917|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.700000|\n|         918|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.800000|\n|         919|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:27.900000|\n|         920|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.000000|\n|         921|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.100000|\n|         922|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.200000|\n|         923|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.300000|\n|         924|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.400000|\n|         925|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.500000|\n|         926|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.600000|\n|         927|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.700000|\n|         928|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.800000|\n|         929|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:28.900000|\n|         930|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.000000|\n|         931|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.100000|\n|         932|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.200000|\n|         933|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.300000|\n|         934|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.400000|\n|         935|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.500000|\n|         936|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.600000|\n|         937|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.700000|\n|         938|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.800000|\n|         939|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:29.900000|\n|         940|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.000000|\n|         941|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.100000|\n|         942|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.200000|\n|         943|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.300000|\n|         944|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.400000|\n|         945|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.500000|\n|         946|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.600000|\n|         947|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.700000|\n|         948|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.800000|\n|         949|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:30.900000|\n|         950|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.000000|\n|         951|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.100000|\n|         952|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.200000|\n|         953|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.300000|\n|         954|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.400000|\n|         955|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.500000|\n|         956|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.600000|\n|         957|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.700000|\n|         958|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.800000|\n|         959|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:31.900000|\n|         960|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.000000|\n|         961|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.100000|\n|         962|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.200000|\n|         963|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.300000|\n|         964|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.400000|\n|         965|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.500000|\n|         966|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.600000|\n|         967|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.700000|\n|         968|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.800000|\n|         969|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:32.900000|\n|         970|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.000000|\n|         971|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.100000|\n|         972|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.200000|\n|         973|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.300000|\n|         974|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.400000|\n|         975|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.500000|\n|         976|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.600000|\n|         977|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.700000|\n|         978|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.800000|\n|         979|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:33.900000|\n|         980|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.000000|\n|         981|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.100000|\n|         982|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.200000|\n|         983|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.300000|\n|         984|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.400000|\n|         985|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.500000|\n|         986|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.600000|\n|         987|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.700000|\n|         988|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.800000|\n|         989|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:34.900000|\n|         990|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.000000|\n|         991|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.100000|\n|         992|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.200000|\n|         993|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.300000|\n|         994|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.400000|\n|         995|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.500000|\n|         996|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.600000|\n|         997|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.700000|\n|         998|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.800000|\n|         999|25 JUN 2023 12:10:56|   0|25 06 2023 12:12:35.900000|\n+------------+--------------------+----+--------------------------+\nonly showing top 1000 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765463_2092484040","id":"20230901-160931_1555581191","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:94"},{"text":"%pyspark\ndf_from_create_df_vol_slow_2= df_from_create_df_vol_slow.drop('other')\ndf_from_create_df_vol_slow_3=fill2(df_from_create_df_vol_slow_2)\ndf_from_create_df_vol_slow_3.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+----+--------------------------+\n|Frame_100_ms|             Trigger|Part|                      date|\n+------------+--------------------+----+--------------------------+\n|           0|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.000000|\n|           1|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.100000|\n|           2|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.200000|\n|           3|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.300000|\n|           4|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.400000|\n|           5|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.500000|\n|           6|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.600000|\n|           7|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.700000|\n|           8|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.800000|\n|           9|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:15.900000|\n|          10|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.000000|\n|          11|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.100000|\n|          12|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.200000|\n|          13|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.300000|\n|          14|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.400000|\n|          15|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.500000|\n|          16|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.600000|\n|          17|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.700000|\n|          18|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.800000|\n|          19|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:16.900000|\n|          20|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.000000|\n|          21|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.100000|\n|          22|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.200000|\n|          23|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.300000|\n|          24|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.400000|\n|          25|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.500000|\n|          26|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.600000|\n|          27|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.700000|\n|          28|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.800000|\n|          29|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:17.900000|\n|          30|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.000000|\n|          31|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.100000|\n|          32|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.200000|\n|          33|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.300000|\n|          34|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.400000|\n|          35|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.500000|\n|          36|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.600000|\n|          37|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.700000|\n|          38|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.800000|\n|          39|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:18.900000|\n|          40|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.000000|\n|          41|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.100000|\n|          42|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.200000|\n|          43|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.300000|\n|          44|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.400000|\n|          45|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.500000|\n|          46|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.600000|\n|          47|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.700000|\n|          48|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.800000|\n|          49|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:19.900000|\n|          50|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.000000|\n|          51|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.100000|\n|          52|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.200000|\n|          53|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.300000|\n|          54|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.400000|\n|          55|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.500000|\n|          56|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.600000|\n|          57|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.700000|\n|          58|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.800000|\n|          59|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:20.900000|\n|          60|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.000000|\n|          61|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.100000|\n|          62|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.200000|\n|          63|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.300000|\n|          64|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.400000|\n|          65|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.500000|\n|          66|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.600000|\n|          67|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.700000|\n|          68|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.800000|\n|          69|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:21.900000|\n|          70|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.000000|\n|          71|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.100000|\n|          72|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.200000|\n|          73|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.300000|\n|          74|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.400000|\n|          75|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.500000|\n|          76|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.600000|\n|          77|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.700000|\n|          78|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.800000|\n|          79|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:22.900000|\n|          80|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.000000|\n|          81|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.100000|\n|          82|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.200000|\n|          83|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.300000|\n|          84|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.400000|\n|          85|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.500000|\n|          86|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.600000|\n|          87|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.700000|\n|          88|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.800000|\n|          89|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:23.900000|\n|          90|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.000000|\n|          91|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.100000|\n|          92|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.200000|\n|          93|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.300000|\n|          94|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.400000|\n|          95|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.500000|\n|          96|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.600000|\n|          97|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.700000|\n|          98|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.800000|\n|          99|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:24.900000|\n|         100|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.000000|\n|         101|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.100000|\n|         102|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.200000|\n|         103|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.300000|\n|         104|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.400000|\n|         105|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.500000|\n|         106|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.600000|\n|         107|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.700000|\n|         108|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.800000|\n|         109|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:25.900000|\n|         110|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.000000|\n|         111|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.100000|\n|         112|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.200000|\n|         113|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.300000|\n|         114|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.400000|\n|         115|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.500000|\n|         116|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.600000|\n|         117|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.700000|\n|         118|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.800000|\n|         119|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:26.900000|\n|         120|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.000000|\n|         121|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.100000|\n|         122|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.200000|\n|         123|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.300000|\n|         124|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.400000|\n|         125|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.500000|\n|         126|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.600000|\n|         127|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.700000|\n|         128|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.800000|\n|         129|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:27.900000|\n|         130|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.000000|\n|         131|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.100000|\n|         132|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.200000|\n|         133|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.300000|\n|         134|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.400000|\n|         135|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.500000|\n|         136|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.600000|\n|         137|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.700000|\n|         138|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.800000|\n|         139|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:28.900000|\n|         140|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.000000|\n|         141|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.100000|\n|         142|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.200000|\n|         143|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.300000|\n|         144|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.400000|\n|         145|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.500000|\n|         146|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.600000|\n|         147|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.700000|\n|         148|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.800000|\n|         149|25 JUN 2023 12:09:15|   0|25 06 2023 12:09:29.900000|\n+------------+--------------------+----+--------------------------+\nonly showing top 150 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765475_2075555089","id":"20230901-162207_292631667","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:95"},{"title":"Final function ?","text":"%pyspark\ndef complete_raw_files_transformation_process(New_raw_files_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/New_raw_files\"):\n    # Search all newly imported raw files in the New_raw_files folder\n    Recently_uploaded_SN_dir = listdir(New_raw_files_Dir_path)\n\tfor SN_dir in Recently_uploaded_SN_dir:\n\t    # Recently_uploaded_file_path_list will need to will be emptied progressively\n\t\tRecently_uploaded_file_path_list = listdir(SN_dir)\n\t\tfor new_raw_file_path in Recently_uploaded_file_path_list:\n\t\t    #Take a single file name in the list\n\t\t\tfile_name_without_extension = extract_filename_without_extension(new_raw_file_path)\n\t\t\t# Use that file name to search the log file and find a df of all the files that probably share the same flight as the file_name_without_extension\n\t\t\tall_files_sharing_flight_df = find_files_sharing_the_same_flight_as_rawFileName(file_name_without_extension)\n\t\t\t# Separate vol and system files\n\t\t\tall_flight_files_sharing_same_flight_df = separate_flight_file_from_log_sharing_flight_df(all_files_sharing_flight_df)\n\t\t\tall_system_files_sharing_same_flight_df = separate_system_file_from_log_sharing_flight_df(all_files_sharing_flight_df)\n\t\t\t\n\t\t\t# Find the vol file name that will regroup all the IRYS2 and PERFOS files, the arcraft model code and the sn, those informations will be used to complete the log_files\n\t\t\tconcat_vol_file_name, concat_vol_file_aircraft_model, concat_vol_file_SN = get_vol_file_name_from_vol_files_filtered_df(all_flight_files_sharing_same_flight_df)\n\t\t\t\n\t\t\t# Extract the list of path found in all_flight_files_sharing_same_flight_df\n\t\t\tpath_column_name_to_collect = \"Raw_file_legacy_folder_path\"\n\t\t\tflight_files_path_list = collect_a_df_column_into_a_list(all_flight_files_sharing_same_flight_df, path_column_name_to_collect)\n\t\t\tsystem_files_path_list = collect_a_df_column_into_a_list(all_system_files_sharing_same_flight_df, path_column_name_to_collect)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693905765487_2070938102","id":"20230901-154954_406570839","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:96"},{"text":"%pyspark\nname = get_vol_file_name_from_vol_files_filtered_df(vol_files_filtered_df)\nprint(name)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"IRYS2_0580449_20230625121055t"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765499_2078633080","id":"20230901-144411_782654363","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:97"},{"text":"%pyspark\npath_list = collect_a_df_column_into_a_list(vol_files_filtered_df, \"Raw_file_legacy_folder_path\")\nprint(path_list)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124817t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125000t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125325t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130339t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131209t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131533t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131715t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132402t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132726t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133414t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134104t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134428t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134610t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134934t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135257t.csv', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135439t.csv']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765511_-2134767449","id":"20230901-150337_656127689","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:98"},{"text":"%pyspark\nvol_files_filtered_df = separate_flight_file_from_log_sharing_flight_df(test_files_sharing_flight_df)\n\nprint(\"row count = \", vol_files_filtered_df.count())\nvol_files_filtered_df.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row count =  62\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|                                       file_name_no_extension|                                         File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|                                           Raw_file_legacy_folder_path|                                            Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv|          .csv|      Raw|           true|       2023-06-25 12:10:55|     20230625121055|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:24.607|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv|          .csv|      Raw|           true|       2023-06-25 12:12:37|     20230625121237|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|  2023-09-01 11:55:26.3|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121419t.csv|          .csv|      Raw|           true|       2023-06-25 12:14:19|     20230625121419|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:28.064|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121601t.csv|          .csv|      Raw|           true|       2023-06-25 12:16:01|     20230625121601|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:29.878|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121743t.csv|          .csv|      Raw|           true|       2023-06-25 12:17:43|     20230625121743|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:31.609|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121924t.csv|          .csv|      Raw|           true|       2023-06-25 12:19:24|     20230625121924|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:33.431|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122106t.csv|          .csv|      Raw|           true|       2023-06-25 12:21:06|     20230625122106|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:35.208|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122248t.csv|          .csv|      Raw|           true|       2023-06-25 12:22:48|     20230625122248|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:37.661|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122430t.csv|          .csv|      Raw|           true|       2023-06-25 12:24:30|     20230625122430|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:39.322|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122612t.csv|          .csv|      Raw|           true|       2023-06-25 12:26:12|     20230625122612|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:41.088|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122754t.csv|          .csv|      Raw|           true|       2023-06-25 12:27:54|     20230625122754|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:55:42.83|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625122937t.csv|          .csv|      Raw|           true|       2023-06-25 12:29:37|     20230625122937|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:44.534|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123118t.csv|          .csv|      Raw|           true|       2023-06-25 12:31:18|     20230625123118|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:46.347|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123300t.csv|          .csv|      Raw|           true|       2023-06-25 12:33:00|     20230625123300|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:47.964|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123442t.csv|          .csv|      Raw|           true|       2023-06-25 12:34:42|     20230625123442|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:49.653|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123624t.csv|          .csv|      Raw|           true|       2023-06-25 12:36:24|     20230625123624|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:51.345|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123806t.csv|          .csv|      Raw|           true|       2023-06-25 12:38:06|     20230625123806|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:53.031|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625123948t.csv|          .csv|      Raw|           true|       2023-06-25 12:39:48|     20230625123948|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:54.996|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124130t.csv|          .csv|      Raw|           true|       2023-06-25 12:41:30|     20230625124130|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:57.594|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124312t.csv|          .csv|      Raw|           true|       2023-06-25 12:43:12|     20230625124312|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:55:59.268|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124454t.csv|          .csv|      Raw|           true|       2023-06-25 12:44:54|     20230625124454|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:00.885|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124635t.csv|          .csv|      Raw|           true|       2023-06-25 12:46:35|     20230625124635|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:02.58|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124817t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625124817t.csv|          .csv|      Raw|           true|       2023-06-25 12:48:17|     20230625124817|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:04.28|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125000t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125000t.csv|          .csv|      Raw|           true|       2023-06-25 12:50:00|     20230625125000|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:05.909|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125143t.csv|          .csv|      Raw|           true|       2023-06-25 12:51:43|     20230625125143|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:07.635|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125325t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125325t.csv|          .csv|      Raw|           true|       2023-06-25 12:53:25|     20230625125325|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:09.346|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125507t.csv|          .csv|      Raw|           true|       2023-06-25 12:55:07|     20230625125507|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:11.048|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125649t.csv|          .csv|      Raw|           true|       2023-06-25 12:56:49|     20230625125649|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:13.185|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625125833t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:33|     20230625125833|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:14.886|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130015t.csv|          .csv|      Raw|           true|       2023-06-25 13:00:15|     20230625130015|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:17.368|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130157t.csv|          .csv|      Raw|           true|       2023-06-25 13:01:57|     20230625130157|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:19.051|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130339t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130339t.csv|          .csv|      Raw|           true|       2023-06-25 13:03:39|     20230625130339|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:20.79|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130521t.csv|          .csv|      Raw|           true|       2023-06-25 13:05:21|     20230625130521|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:22.45|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130703t.csv|          .csv|      Raw|           true|       2023-06-25 13:07:03|     20230625130703|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:24.156|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625130845t.csv|          .csv|      Raw|           true|       2023-06-25 13:08:45|     20230625130845|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:25.811|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131027t.csv|          .csv|      Raw|           true|       2023-06-25 13:10:27|     20230625131027|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:27.444|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131209t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131209t.csv|          .csv|      Raw|           true|       2023-06-25 13:12:09|     20230625131209|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:29.119|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131351t.csv|          .csv|      Raw|           true|       2023-06-25 13:13:51|     20230625131351|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:30.748|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131533t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131533t.csv|          .csv|      Raw|           true|       2023-06-25 13:15:33|     20230625131533|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:32.353|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131715t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131715t.csv|          .csv|      Raw|           true|       2023-06-25 13:17:15|     20230625131715|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:34.129|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625131857t.csv|          .csv|      Raw|           true|       2023-06-25 13:18:57|     20230625131857|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:36.563|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132039t.csv|          .csv|      Raw|           true|       2023-06-25 13:20:39|     20230625132039|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:38.308|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132220t.csv|          .csv|      Raw|           true|       2023-06-25 13:22:20|     20230625132220|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:39.93|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132402t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132402t.csv|          .csv|      Raw|           true|       2023-06-25 13:24:02|     20230625132402|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:41.657|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132544t.csv|          .csv|      Raw|           true|       2023-06-25 13:25:44|     20230625132544|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:43.304|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132726t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132726t.csv|          .csv|      Raw|           true|       2023-06-25 13:27:26|     20230625132726|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-01 11:56:44.97|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625132908t.csv|          .csv|      Raw|           true|       2023-06-25 13:29:08|     20230625132908|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:46.639|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133050t.csv|          .csv|      Raw|           true|       2023-06-25 13:30:50|     20230625133050|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:48.303|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133232t.csv|          .csv|      Raw|           true|       2023-06-25 13:32:32|     20230625133232|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:49.976|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133414t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133414t.csv|          .csv|      Raw|           true|       2023-06-25 13:34:14|     20230625133414|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:51.702|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133556t.csv|          .csv|      Raw|           true|       2023-06-25 13:35:56|     20230625133556|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:53.366|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133738t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:38|     20230625133738|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:55.858|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625133921t.csv|          .csv|      Raw|           true|       2023-06-25 13:39:21|     20230625133921|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:57.574|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134104t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134104t.csv|          .csv|      Raw|           true|       2023-06-25 13:41:04|     20230625134104|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:56:59.428|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134246t.csv|          .csv|      Raw|           true|       2023-06-25 13:42:46|     20230625134246|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:01.096|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134428t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134428t.csv|          .csv|      Raw|           true|       2023-06-25 13:44:28|     20230625134428|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:02.809|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134610t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134610t.csv|          .csv|      Raw|           true|       2023-06-25 13:46:10|     20230625134610|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:04.425|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134752t.csv|          .csv|      Raw|           true|       2023-06-25 13:47:52|     20230625134752|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:06.047|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134934t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625134934t.csv|          .csv|      Raw|           true|       2023-06-25 13:49:34|     20230625134934|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:07.802|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135116t.csv|          .csv|      Raw|           true|       2023-06-25 13:51:16|     20230625135116|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:09.421|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135257t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135257t.csv|          .csv|      Raw|           true|       2023-06-25 13:52:57|     20230625135257|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:11.087|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135439t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625135439t.csv|          .csv|      Raw|           true|       2023-06-25 13:54:39|     20230625135439|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-01 11:57:13.018|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765523_-2127072471","id":"20230901-134504_1269810800","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:99"},{"text":"%pyspark\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693905765535_-2131689458","id":"20230901-160323_1201986817","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:100"},{"text":"%pyspark\n#min_date = vol_files_filtered_df.select(min('Age')).show()\nfirst_row = vol_files_filtered_df.first()\nval = first_row[\"file_name_no_extension\"]\nprint(first_row)\nprint(val)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(file_name_no_extension='TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t', File_name_with_extension='TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv', File_extension='.csv', File_type='Raw', Valid_file_name=True, File_date_as_TimestampType=datetime.datetime(2023, 6, 25, 12, 10, 55), File_date_as_String='20230625121055', File_complete_ID='0580449', File_SN='SN449', File_aircraft_model='0580', Raw_file_legacy_folder_path='/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv', Raw_file_dated_folder_path='/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Year_2023/Month_06/Day_25/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t.csv', Raw_file_legacy_folder_copied=True, Raw_file_dated_folder_copied=True, Flight_file_name=None, TRD_starts_file_name=True, MUX_starts_file_name=False, IRYS2_in_file_name=True, PERFOS_in_file_name=True, FAIL_in_file_name=False, Is_Vol=True, IRYS2_or_PERFOS='IRYS2_', Is_System=False, System_Name=None, Update_Date=datetime.datetime(2023, 9, 1, 11, 55, 24, 607000))\nTRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121055t"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765546_2146733635","id":"20230901-135938_188862521","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:101"},{"text":"%pyspark\nsystem_files_filtered_df = separate_system_file_from_log_sharing_flight_df(test_files_sharing_flight_df)\n\nprint(\"row count = \", system_files_filtered_df.count())\nsystem_files_filtered_df.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"row count =  34\n+----------------------------------------------------------+--------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|                                    file_name_no_extension|                                      File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|                                           Raw_file_legacy_folder_path|                                            Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+----------------------------------------------------------+--------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|    MUX_P1153_ISSUE_3_BLEED_REPORT_0580449_20230625120933t|    MUX_P1153_ISSUE_3_BLEED_REPORT_0580449_20230625120933t.csv|          .csv|      Raw|           true|       2023-06-25 12:09:33|     20230625120933|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|      BLEED|2023-09-01 11:54:34.532|\n|  P1148_ISSUE_1_RH_HUD_FAIL_REPORT_0580449_20230625120955t|  P1148_ISSUE_1_RH_HUD_FAIL_REPORT_0580449_20230625120955t.csv|          .csv|      Raw|           true|       2023-06-25 12:09:55|     20230625120955|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/P1148_ISSUE_...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 11:55:10.449|\n|  P1148_ISSUE_1_LH_HUD_FAIL_REPORT_0580449_20230625120955t|  P1148_ISSUE_1_LH_HUD_FAIL_REPORT_0580449_20230625120955t.csv|          .csv|      Raw|           true|       2023-06-25 12:09:55|     20230625120955|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/P1148_ISSUE_...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 11:55:07.314|\n|  P1148_ISSUE_1_RH_HUD_FAIL_REPORT_0580449_20230625121004t|  P1148_ISSUE_1_RH_HUD_FAIL_REPORT_0580449_20230625121004t.csv|          .csv|      Raw|           true|       2023-06-25 12:10:04|     20230625121004|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/P1148_ISSUE_...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 11:55:12.097|\n|  P1148_ISSUE_1_LH_HUD_FAIL_REPORT_0580449_20230625121004t|  P1148_ISSUE_1_LH_HUD_FAIL_REPORT_0580449_20230625121004t.csv|          .csv|      Raw|           true|       2023-06-25 12:10:04|     20230625121004|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/P1148_ISSUE_...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|               false|             false|              false|             true| false|           null|     true|        HUD|2023-09-01 11:55:08.881|\n|      TRD_P1028_ISSUE_3_APU_REPORT_0580449_20230625121020t|      TRD_P1028_ISSUE_3_APU_REPORT_0580449_20230625121020t.csv|          .csv|      Raw|           true|       2023-06-25 12:10:20|     20230625121020|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1028_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|        APU|2023-09-01 11:55:13.887|\n|       MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124740t|       MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124740t.csv|          .csv|      Raw|           true|       2023-06-25 12:47:40|     20230625124740|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-01 11:54:20.393|\n|       MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t|       MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124747t.csv|          .csv|      Raw|           true|       2023-06-25 12:47:47|     20230625124747|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-01 11:54:23.131|\n|    TRD_P1106_ISSUE_1_CASOV_REPORT_0580449_20230625124833t|    TRD_P1106_ISSUE_1_CASOV_REPORT_0580449_20230625124833t.csv|          .csv|      Raw|           true|       2023-06-25 12:48:33|     20230625124833|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1106_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|      CASOV|2023-09-01 11:55:17.993|\n|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125138t|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125138t.csv|          .csv|      Raw|           true|       2023-06-25 12:51:38|     20230625125138|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 11:54:42.035|\n|       MUX_P1153_ISSUE_3_TR_REPORT_0580449_20230625125201t|       MUX_P1153_ISSUE_3_TR_REPORT_0580449_20230625125201t.csv|          .csv|      Raw|           true|       2023-06-25 12:52:01|     20230625125201|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         TR|2023-09-01 11:55:04.039|\n|     MUX_P1153_ISSUE_3_TPMS_REPORT_0580449_20230625125740t|     MUX_P1153_ISSUE_3_TPMS_REPORT_0580449_20230625125740t.csv|          .csv|      Raw|           true|       2023-06-25 12:57:40|     20230625125740|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       TPMS|2023-09-01 11:55:00.873|\n|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625125805t|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625125805t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:05|     20230625125805|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL|2023-09-01 11:54:53.094|\n|      MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625125813t|      MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625125813t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:13|     20230625125813|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-01 11:54:27.594|\n|     TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625125814t|     TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625125814t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:14|     20230625125814|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|       LGCS| 2023-09-01 11:55:21.17|\n|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125826t|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625125826t.csv|          .csv|      Raw|           true|       2023-06-25 12:58:26|     20230625125826|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 11:54:43.797|\n|     MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625130022t|     MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625130022t.csv|          .csv|      Raw|           true|       2023-06-25 13:00:22|     20230625130022|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC| 2023-09-01 11:54:36.46|\n|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625131131t|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625131131t.csv|          .csv|      Raw|           true|       2023-06-25 13:11:31|     20230625131131|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL|2023-09-01 11:54:55.633|\n|    TRD_P1106_ISSUE_1_CASOV_REPORT_0580449_20230625133131t|    TRD_P1106_ISSUE_1_CASOV_REPORT_0580449_20230625133131t.csv|          .csv|      Raw|           true|       2023-06-25 13:31:31|     20230625133131|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1106_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|      CASOV|2023-09-01 11:55:19.605|\n|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133307t|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133307t.csv|          .csv|      Raw|           true|       2023-06-25 13:33:07|     20230625133307|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 11:54:45.828|\n|     TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625133349t|     TRD_P1153_ISSUE_1_LGCS_REPORT_0580449_20230625133349t.csv|          .csv|      Raw|           true|       2023-06-25 13:33:49|     20230625133349|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|       LGCS|2023-09-01 11:55:22.735|\n|      MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133349t|      MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133349t.csv|          .csv|      Raw|           true|       2023-06-25 13:33:49|     20230625133349|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-01 11:54:29.553|\n|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133357t|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133357t.csv|          .csv|      Raw|           true|       2023-06-25 13:33:57|     20230625133357|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP| 2023-09-01 11:54:47.59|\n|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133428t|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133428t.csv|          .csv|      Raw|           true|       2023-06-25 13:34:28|     20230625133428|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 11:54:49.352|\n|       MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625133725t|       MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625133725t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:25|     20230625133725|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         AB|2023-09-01 11:54:25.296|\n|     MUX_P1153_ISSUE_3_TPMS_REPORT_0580449_20230625133731t|     MUX_P1153_ISSUE_3_TPMS_REPORT_0580449_20230625133731t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:31|     20230625133731|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       TPMS|2023-09-01 11:55:02.498|\n|       MUX_P1153_ISSUE_3_TR_REPORT_0580449_20230625133753t|       MUX_P1153_ISSUE_3_TR_REPORT_0580449_20230625133753t.csv|          .csv|      Raw|           true|       2023-06-25 13:37:53|     20230625133753|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|         TR|2023-09-01 11:55:05.651|\n|      MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133802t|      MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625133802t.csv|          .csv|      Raw|           true|       2023-06-25 13:38:02|     20230625133802|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|        BCS|2023-09-01 11:54:32.448|\n|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133904t|MUX_P1153_ISSUE_3_FLAP_SLAT_REPORT_0580449_20230625133904t.csv|          .csv|      Raw|           true|       2023-06-25 13:39:04|     20230625133904|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FLAP|2023-09-01 11:54:51.327|\n|     MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625133950t|     MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625133950t.csv|          .csv|      Raw|           true|       2023-06-25 13:39:50|     20230625133950|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-01 11:54:38.426|\n|      TRD_P1028_ISSUE_3_APU_REPORT_0580449_20230625134035t|      TRD_P1028_ISSUE_3_APU_REPORT_0580449_20230625134035t.csv|          .csv|      Raw|           true|       2023-06-25 13:40:35|     20230625134035|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1028_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|                true|               false|             false|              false|            false| false|           null|     true|        APU|2023-09-01 11:55:16.379|\n|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625134252t|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625134252t.csv|          .csv|      Raw|           true|       2023-06-25 13:42:52|     20230625134252|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL|2023-09-01 11:54:57.547|\n|     MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625134259t|     MUX_P1153_ISSUE_3_ELEC_REPORT_0580449_20230625134259t.csv|          .csv|      Raw|           true|       2023-06-25 13:42:59|     20230625134259|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       ELEC|2023-09-01 11:54:40.147|\n|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625134506t|     MUX_P1153_ISSUE_3_FUEL_REPORT_0580449_20230625134506t.csv|          .csv|      Raw|           true|       2023-06-25 13:45:06|     20230625134506|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Yea...|                         true|                        true|            null|               false|                true|             false|              false|            false| false|           null|     true|       FUEL| 2023-09-01 11:54:59.26|\n+----------------------------------------------------------+--------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765558_-2140538683","id":"20230901-133205_1109119679","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:102"},{"title":"STEP 4 : concat fichiers vols in list","text":"%pyspark\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693905765570_2137499661","id":"20230901-110235_133920401","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:103"},{"text":"%pyspark\ndef GetSpecificRow(rdd, id):\n\treturn rdd.zipWithIndex().filter(lambda x: x[1]==id)\n\n#En entree un rdd associe a un fichier acmf\n#En sortie les colonnes du fichier ACMF\ndef get_header(rdd):\n\theaderRow = GetSpecificRow(rdd,6).map(lambda x: x[0]).map(lambda x: x.split(',')) #ici les donnees sont separees par des virgules\n\theader = headerRow.first()\n    # If a column name is an empty space chage it for other\n\theader = ['other' if column == ' ' else column for column in header]\n\treturn header\n\n#En entree une liste de noms de fichiers appartenant a un meme vol\n#En sortie un rdd contenant l'ensemble des fichiers d un meme vol concatenes.\ndef create_join_rdd(vol):\n\tc=0\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n   \n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\trdd2.collect()\n\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header\n\t\n#En entree un rdd et un header (label des colonnes)\n#En sortie une dataframe  objet qui permet des traitements par colonnes alors que rdd par ligne\ndef data_frame(rdd, header):\n\tschema = StructType([StructField(column, StringType(), True) for column in header])\n\tdf = spark.createDataFrame(rdd, schema)\n\tdf=df.toDF(*(c.replace(' ', '_') for c in df.columns))\n\tdf=df.toDF(*(c.replace('(', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace(')', '') for c in df.columns))\n\tdf=df.toDF(*(c.replace('.', '_') for c in df.columns))\n\treturn df\n\t\n#En entree un rdd\n#En sortie l heure de debut d enregistrement\ndef trigger_time(rdd):\n\tTriggerTimeRow = GetSpecificRow(rdd,3).map(lambda x: x[0]).map(lambda x: x.split(' '))\n\tTriggerTime = ' '.join(TriggerTimeRow.first()[1:])\n\treturn TriggerTime\n\n#En entree une dataframe\n#en sortie la meme dataframe adjointe dun vecteur date\ndef insert_date(df):\n\t@pandas_udf(StringType())\n\tdef pandas_insert_date(trigger: pd.Series, frame: pd.Series) -> pd.Series:\n\t\ttrig=pd.Series([datetime.strptime(TriggerTime, \"%d %b %Y %H:%M:%S\") for TriggerTime in trigger])\n\t\tdelta=pd.Series([timedelta(milliseconds=int(ms)*100) for ms in frame])\n\t\tdate=trig+delta\n\t\treturn pd.Series([d.strftime(\"%d %m %Y %H:%M:%S.%f\") for d in date])\n\t\t\n\tdf=df.withColumn('date', pandas_insert_date(df['Trigger'], df['Frame_100_ms']))\n\t\n\treturn df\n\t\n#retourne la liste des colonnes doublons (pour information avec leur nom d origine), le nouveau header avec les noms modifies, et une liste contenant le nom des colonnes doublons renommees\ndef detect_doublon(header):\n\tcolonnes=[]\n\tliste_doublon=[]\n\tliste_tot_doublons=[]\n\tc=0\n\tnew_header=[]\n\t\n\tfor col in header:\n\t\tif col in colonnes:\n\t\t\tif col in liste_doublon:\n\t\t\t\tc+=1\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\t\n\t\t\telse:\n\t\t\t\tliste_doublon.append(col)\n\t\t\t\tnew_header.append(col+str(c))\n\t\t\t\tliste_tot_doublons.append(col+str(c))\n\t\telse:\n\t\t\tnew_header.append(col)\n\t\t\tcolonnes.append(col)\n\treturn liste_doublon, new_header, liste_tot_doublons\n\t\n#suppression des colonnes doublons    \ndef suppr_doublon(df, new_header, liste_tot_doublons):\n\tschema = StructType([StructField(column, StringType(), True) for column in new_header])\n\tcsv=df.rdd\n\tdf=spark.createDataFrame(csv, schema)\n\tfor col in liste_tot_doublons:\n\t\tdf=df.drop(df[col])\n\treturn df\n\t\n#en entree les fichiers appartenant a un meme vol\n#creation de la dataframe corrigee avec adjonction du vecteur temps\n#en sortie la dataframe corrigee\ndef create_df_vol(vol):\n\trdd,header=create_join_rdd(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date(df)\n\t\n\treturn df\n\t\n#les fonctions suivantes sont utiles dans le cas ou l on traite un fichier seul, qui n a pas pu etre lie a un vol.\ndef insert_date_seul(df, TriggerTime):\n\t@pandas_udf(StringType())\n\tdef pandas_insert_date(series: pd.Series) -> pd.Series:\n\t\tdate=datetime.strptime(TriggerTime, \"%d %b %Y %H:%M:%S\")\n\t\treturn pd.Series([(date+timedelta(milliseconds=int(ms)*100)).strftime(\"%d %m %Y %H:%M:%S.%f\") for ms in series])\n\t\n\tdf=df.withColumn('date', pandas_insert_date(df['Frame_100_ms']))\n\t\n\treturn df\n\t\n#creation dune dataframe a parir dun fichier seul\ndef create_df(path):\n\trdd_brut = sc.textFile(path)\n\tTriggerTime=trigger_time(rdd_brut)\n\theader=get_header(rdd_brut)\n\trdd = rdd_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_seul(df, TriggerTime)\n\n\treturn df  \n\t\ndef create_df_slow(path):\n\trdd_brut = sc.textFile(path)\n\tTriggerTime=trigger_time(rdd_brut)\n\theader=get_header(rdd_brut)\n\trdd = rdd_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tdf=data_frame(rdd, header)\n\tdf = df.withColumn('Trigger', F.lit(TriggerTime))\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n \n\tdf=insert_date_udf(df)\n\t\n\treturn df\n\t\n#en entree le chemin vers un dossier\n#en sortie une la liste des fichiers dans le dossier\ndef listdir(path):\n\tfiles = str(subprocess.check_output('hdfs dfs -ls ' + path, shell=True))\n\treturn [re.search(' (/.+)', i).group(1) for i in str(files).split(\"\\\\n\") if re.search(' (/.+)', i)]\n\t\n#extraction du nom du fichier a partir du chemin complet\ndef find_aircraft_NAME_from_path(path):\n\tfor i in range (1, len(path)):\n\t\tif path[-i]=='/':\n\t\t\treturn (path[len(path)-i+1:-4])\n\t\t\t\n#extraction de la date d enregistrement\n# Extract substring from file path (the last 15 char)\ndef find_aircraft_DATE_from_path(path):\n\treturn(find_aircraft_NAME_from_path(path)[-15:])\n\t\n#identite de l'avion et date\ndef find_aircraft_ID_from_path(path):\n\treturn(find_aircraft_NAME_from_path(path)[-23:])\n\t\n#Detection de fichiers appartenant a un meme vol\n#Le defaut est corrige\ndef isSameFlight(t1,t2):\n\ttry:\n\t\tt1 = datetime.strptime(t1,\"%Y%m%d%H%M%S\")\n\t\tt2 = datetime.strptime(t2,\"%Y%m%d%H%M%S\")\n\t\tif t1 > t2:\n\t\t\tdelta= t1-t2\n\t\telse:\n\t\t\tdelta=t2-t1\n\t\t\t\n\t\tif delta<timedelta(seconds=220):\n\t\t\treturn True\n\t\telse:\n\t\t\treturn False\n\texcept:\n\t\treturn False\n\t\t\n#version plus efficace de get_vols\ndef get_vols_perfo(liste_fichiers):\n\tif liste_fichiers==[]:\n\t\treturn []\n\telse:\n\t\t# Take the first flight of the liste_fichiers as the vol list first element\n\t\tvol=[liste_fichiers[0]]\n\t\tL_vols=[]\n\t\t# For every file in the list (minus the first one)\n\t\t# The range of i is 0 to -2\n\t\tfor i in range(len(liste_fichiers)-1):\n\t\t\tp1=liste_fichiers[i]\n\t\t\tp2=liste_fichiers[i+1]\n\t\t\t# The dates inside p1 and p2 s path are compared end return True if delta < 220 sec \n\t\t\t# If both dates are close enough, p2 is inserted one position before the curent last\n\t\t\tif isSameFlight(find_aircraft_DATE_from_path(p1)[:-1], find_aircraft_DATE_from_path(p2)[:-1]):\n\t\t\t\ttry:\n\t\t\t\t\tif datetime.strptime(find_aircraft_DATE_from_path(p2)[:-1], \"%Y%m%d%H%M%S\")  < datetime.strptime(find_aircraft_DATE_from_path(vol[0])[:-1], \"%Y%m%d%H%M%S\"):\n\t\t\t\t\t\tvol.insert(0, p2)\n\t\t\t\t\t# replace with elif\n\t\t\t\t\tif datetime.strptime(find_aircraft_DATE_from_path(p2)[:-1], \"%Y%m%d%H%M%S\")  > datetime.strptime(find_aircraft_DATE_from_path(vol[-1])[:-1], \"%Y%m%d%H%M%S\"):\n\t\t\t\t\t\tvol.append(p2)\n\t\t\t\t\telse:\n\t\t\t\t\t\tvol.insert(len(vol)-2, p2)\n\t\t\t\texcept:\n\t\t\t\t\tprint(p1,p2)\n\t\t\telse:\n\t\t\t\t# p1 and p2 dates are not close enough\n\t\t\t\t# The list vol containing p1 alone is added to L_vols\n\t\t\t\t# Every time p1 and p2 dates are not close enough, a new vol sublist containing a single file is added to L_vols/new_vols\n\t\t\t\tL_vols.append(vol)\n\t\t\t\t# The vol list is overwritten as [p2] or [liste_fichiers[i+1]]\n\t\t\t\tvol=[p2]\n\t\t# if liste_fichiers !=[] L_vols/new_vols will always be append with one vol, potentially vol=[p2] if the last two p1/p2 are a missmatch\n\t\tL_vols.append(vol)\n\t\treturn L_vols\n\t\t\n#suppression des lignes ou la jointure est decalee\ndef fill(df):\n\tdf=df.replace(' ', None)\n\tdf=df.dropna(subset=df.columns[2:10])\n\t\n\treturn df\n\ndef fill2(df):\n\tfor c in df.columns[:-3]:\n\t\tdf = df.withColumn(c, F.regexp_replace(c, ' ', ''))\n\treturn df.dropna()\n\t\ndef isSameFlight_perfo2(t,vol):\n\t# Campare a single datestring t with vol, a list of vol files\n\t# A list with a single element should work and give the same dates for debut et fin\n\t# ! ! ! The list is not ordered ->\n\t# If the try failed, no boolean is returned\n\ttry:\n\t\tdebut=datetime.strptime(find_aircraft_DATE_from_path(vol[0])[:-1], \"%Y%m%d%H%M%S\")\n\t\tfin=datetime.strptime(find_aircraft_DATE_from_path(vol[-1])[:-1], \"%Y%m%d%H%M%S\")\n\t\tDateTime=datetime.strptime(t[:-1], \"%Y%m%d%H%M%S\")\n\t\tif DateTime>=debut and DateTime<=fin: \n\t\t\treturn True\n\t\telse: \n\t\t\treturn False\n\texcept:\n\t\tprint(find_aircraft_DATE_from_path(vol[0]), find_aircraft_DATE_from_path(vol[-1]))\n\t\t\n#distinciton entre fichiers irys et fichiers perfos\n# Some of the more recent files have can present both YRYS2 and PERFOS in their name TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420269_20230604070715t.csv\ndef nom_vol(path):\n\t# nom_vol return either 'IRYS2_' (if 'IRYS2_' is found in the path even if 'PERFOS_' is also present) 'PERFOS_'\n\tif 'IRYS2' in path:\n\t\treturn('IRYS2_')\n\tif 'PERFOS' in path:\n\t\treturn('PERFOS_')\n\t\t\t\t\t\n#detection d un fichier vol\ndef is_Irys(path):\n\treturn 'IRYS2' in path or 'PERFOS' in path\n\t\n#detection de tous les fichiers vols et systeme\n# files result from listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+ SN)\n# If files are nether flight or system they are added to system\ndef get_files(files):\n\tsystems = []\n\tflights = []\n\tfor file in files:\n\t\t# boolean -> return 'IRYS2' in path or 'PERFOS' in path\n\t\tif is_Irys(file):\n\t\t\tflights.append(file)\n\t\telse:\n\t\t\tsystems.append(file)\n\t# tousIrys, tousSyst\n\treturn flights, systems\n\t\t\n\n#extraction nom du fichier systeme\ndef nom_syst(path):\n\treturn(find_aircraft_NAME_from_path(path)[:-24])\n\n#envoi de fichiers sur l hdfs\ndef envoi(df, nom, destination):\n\tdf.write.mode(\"overwrite\").parquet(destination+nom+'.parquet')\n\ndef decalage(df):\n\n\t@pandas_udf(StringType())\n\tdef pandas_del_na(series: pd.Series) -> pd.Series:\n\t\tt=series.size\n\t\tseries=series.dropna()\n\t\ttna=series.size\n\t\treturn pd.concat([series, pd.Series([None for i in range(t-tna)])])\n\t\t\n\tdf=df.replace(' ', None)\n\tfor c in df.columns:\n\t\tdf=df.withColumn(c, pandas_del_na(F.col(c)))\n\t\t\n\treturn df\n\n#system correspond au nom du rapport systeme a filtrer\ndef find_rename_send_system_report(L_vols, L_system, destination, system):\n\tif L_system==[] or L_vols==[]:\n\t\tNone\n\telse:\n\t\tL=[]\n\t\tfor p in L_system:\n\t\t\ttry:\n\t\t\t\tsys_split = p.split('_')[5]\n\t\t\t\tif system == sys_split:\n\t\t\t\t\tL.append(p)\n\t\t\texcept:\n\t\t\t\tpass\n\t\tfor syst in L:\n\t\t\tfound=False\n\t\t\tfor vol in L_vols:\n\t\t\t\tif isSameFlight_perfo2(find_aircraft_DATE_from_path(syst),vol) and not found:\n\t\t\t\t\ttry:\n\t\t\t\t\t\tfound=True\n\t\t\t\t\t\tdf_syst=create_df(syst).repartition(1)\n\t\t\t\t\t\tdf_syst=decalage(df_syst)\n\t\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\t\tenvoi(df_syst, find_aircraft_NAME_from_path(syst)+'_'+find_aircraft_DATE_from_path(vol[0]), destination)\n\t\t\t\t\texcept:\n\t\t\t\t\t\tpass\n\t\t\t\t\t\t\n#Recuperation des nouveaux fichiers Irys Perfo                    \ndef get_new_irys_syst(SN):\n\tancienSyst = listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_systeme/')\n\tlast=datetime.strptime('20101225153010', \"%Y%m%d%H%M%S\")\n\tfor syst in ancienSyst:\n\t\ttry:\n\t\t\tancienVols=listdir(syst + '/' + SN[-5:])\n\t\t\tfor vol in ancienVols:\n\t\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\t\tif last<date:\n\t\t\t\t\tlast=date\n\t\t\t\n\t\t\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/' + SN[-5:]))\n\t\t\t\n\t\t\tnouveauxIrys=[]\n\t\t\tfor irys in tousIrys:\n\t\t\t\ttry:\n\t\t\t\t\tdate=datetime.strptime(find_aircraft_DATE_from_path(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\t\tif date>last:\n\t\t\t\t\t\tnouveauxIrys.append(irys)\n\t\t\t\texcept:\n\t\t\t\t\tprint(irys)        \n\t\t\t\n\t\texcept:\n\t\t\tpass\n\t\t\n\treturn nouveauxIrys\n\t\ndef get_new_irys_vol(SN):\n\tancienVols=listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'+SN)\n\ttry:\n\t\tlast=datetime.strptime(ancienVols[0][-23:-9], \"%Y%m%d%H%M%S\")\n\texcept:\n\t\tlast=datetime.strptime(ancienVols[3][-23:-9], \"%Y%m%d%H%M%S\")\n\tfor vol in ancienVols:\n\t\ttry:\n\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\tif last<date:\n\t\t\t\tlast=date\n\t\texcept:\n\t\t\tNone\n\t\t\t\n\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+SN))\n\t\n\tnouveauxIrys=[]\n\tfor irys in tousIrys:\n\t\ttry:\n\t\t\tdate=datetime.strptime(find_aircraft_DATE_from_path(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\tif date>last:\n\t\t\t\tnouveauxIrys.append(irys)\n\t\texcept:\n\t\t\tNone\n\n\treturn nouveauxIrys\n\t\t\ndef get_new_irys_manuel(SN, date_str):\n\t\t\n\tlast = datetime.strptime(date_str, \"%Y%m%d%H%M%S\")\n\t\n\ttousIrys=get_Irys(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+SN))\n\t\n\tnouveauxIrys=[]\n\tfor irys in tousIrys:\n\t\ttry:\n\t\t\tdate=datetime.strptime(find_aircraft_DATE_from_path(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\tif date>last:\n\t\t\t\tnouveauxIrys.append(irys)\n\t\texcept:\n\t\t\tNone\n\n\treturn nouveauxIrys\n\t\ndef get_new_files(SN, all_files=False):\n    # Potential problem : need to check every file name in the directory TWICE (first to find the last date, then compare the laste date to each files of the IRYSlist and SYSTEMlist)\n    # It is possible for the function to return both nouveauxIrys, nouveauxSyst as empty lists used by get_vols_perfo and get_system_identifier respectively\n\n\t# Check every single file from a SN folder to find the latest date in the existing files\n\tancienVols=listdir('/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/' + SN)\n\t# Same thing for the raw files in fichier_brut, all the files of the SN are checked -> exponentially more costly in computing ressources mont after month with several tens of thousand of new files added each month to every SN\n    # If a file name contains eather 'IRYS2' or 'PERFOS' in it's name, add it to the tousIrys list, otherwise add it to the tousSyst list\n\t# eather list or both of them could be empty\n\t# More realistically both list will be quite large\n\ttousIrys, tousSyst = get_files(listdir('/datalake/prod/c2/ddd/crm/acmf/fichier_brut/'+ SN))\n\n\t#If there are no fichier_vol_2 files at all or all_files set to True to lounch a full treatment return the full list of files tousIrys, tousSyst\n\tif (ancienVols == []) or (all_files) :\n\t\treturn tousIrys, tousSyst\n\t# Else we want to reduce the file number of tousIrys, tousSyst\n\telse:\n\t\t# Searching for a date comming from the one of the fichier_vol_2 file\n\t\tlast = None\n\t\ti=0\n\t\twhile last==None:\n\t\t\ttry:\n\t\t\t\tlast=datetime.strptime(ancienVols[i][-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\texcept:\n                # pass and none should give the same result\n\t\t\t\tpass\n\t\t\ti+=1\n\n\t\t# for each fichier_vol_2 in the ancienVols list compare the file date to the curent last date and update last if necessary\n\t\tfor vol in ancienVols:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(vol[-23:-9], \"%Y%m%d%H%M%S\")\n\t\t\t\tif last<date:\n\t\t\t\t\tlast=date\n\t\t\texcept:\n\t\t\t\tpass\n\t\tlast = last - timedelta(weeks=0)\n\t\t\n\t\tnouveauxIrys=[]\n\t\tfor irys in tousIrys:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(find_aircraft_DATE_from_path(irys)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\tif date>last:\n\t\t\t\t\tnouveauxIrys.append(irys)\n\t\t\texcept:\n\t\t\t\tNone\n\t\t\n\t\tnouveauxSyst=[]\n\t\tfor syst in tousSyst:\n\t\t\ttry:\n\t\t\t\tdate=datetime.strptime(find_aircraft_DATE_from_path(syst)[:-1], \"%Y%m%d%H%M%S\")\n\t\t\t\tif date>last:\n\t\t\t\t\tnouveauxSyst.append(syst)\n\t\t\texcept:\n\t\t\t\tNone\n\t\t# Files without the general name format like some fail files wil be ignored\n\t\treturn nouveauxIrys, nouveauxSyst\n\t\n\t\n\t\n#Retourne la liste des systemes presents dans la liste de nouveaux fichiers systemes\n# Need to change the index one to index 0 ?   \n# No need to chage because full path split looks like\n# ['/datalake/prod/c2/ddd/crm/acmf/fichier', 'brut/SN267/MUX', 'P1153', 'ISSUE', '3', 'AB', 'REPORT', '0420267', '20210505200234t.csv']              \ndef get_system_identifier(L_systems):\n\tsystems = []\n\tfor path in L_systems:    \n\t\tif '.csv' in path:\n\t\t\tp = path.split('_')\n\t\t\tif ('TRD' in p[1]) | ('MUX' in p[1]):\n\t\t\t\tif (p[5] not in systems) & (p[5] != 'IRYS2') & (p[5] != 'PERFOS'):\n\t\t\t\t\tsystems.append(p[5])\n\t\t\telse:\n\t\t\t\tif (p[4] not in systems) & ('P1153' in p[1]):\n\t\t\t\t\tsystems.append(p[4])\n\treturn systems \n\n# Insert a date column to the DF using the Trigger and the Frame_100_ms columns\ndef insert_date_udf(df):\n\tdef insert_date_simple(trigger, frame):\n\t\ttrig = datetime.strptime(trigger, \"%d %b %Y %H:%M:%S\")\n\t\tdelta = timedelta(milliseconds=int(frame)*100)\n\t\tdate = trig + delta\n\t\treturn date.strftime(\"%d %m %Y %H:%M:%S.%f\")\n\tinsert_date_udf = F.udf(insert_date_simple, StringType())\n\t\n\tdf=df.withColumn('date', insert_date_udf(df['Trigger'], df['Frame_100_ms']))\n\treturn df\n\t\ndef create_df_vol_slow(vol):\n\t# vol is a list of IRYS2/PERFOS files\n\trdd,header=create_join_rdd_debug(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_udf(df)\n\t\n\treturn df\n\t\ndef create_join_rdd_debug(vol):\n\t# c is a counter\n\tc=0\n\t# Read the first six lines header of the file\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tlength0 = rdd1.count()\n\t\n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\t# For every file in the list except the first\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\tif rdd2.count() != length0:\n\t\t\trdd=sc.union(rdds)\n\t\t\treturn rdd,header\n\t\telse:\n\t\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\t\trdd2.collect()\n\t\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header\n\t\ndef find_rename_send_system_report_all_files(L_vols, L_system, destination, system):\n    # L_vols -> new_vols, une liste de liste de fichiers IRYS2 et ou Perfos\n    # L_system -> L_syst, les nouveaux fichiers systeme\n    # destination -> output_destination_syst\n    # system -> the curent system in the list : systems\n\tif L_system==[] or L_vols==[]:\n\t\tNone\n\telse:\n\t\tL=[]\n        # for each file in L_system\n\t\tfor p in L_system:\n\t\t\ttry:\n                # on a full path split give this kingd of results :\n                #['/datalake/prod/c2/ddd/crm/acmf/fichier', 'brut/SN267/MUX', 'P1153', 'ISSUE', '3', 'AB', 'REPORT', '0420267', '20210505200234t.csv']\n\t\t\t\tsys_split = p.split('_')[5]\n                # If both systems match add the file to the list L\n\t\t\t\tif system == sys_split:\n\t\t\t\t\tL.append(p)\n\t\t\texcept:\n\t\t\t\tpass\n        # for each system file path in L\n\t\tfor syst in L:\n\t\t\tfound=False\n            # For each vol file (fichiers IRYS2 and or PERFOS)\n\t\t\tfor vol in L_vols:\n                # Find the date of the system file from it s path then compare each vol file to that date to to see if the date is within the interval of the flight\n\t\t\t\t# If the try of is same flight failled, no boolean is given.\n\t\t\t\tif isSameFlight_perfo2(find_aircraft_DATE_from_path(syst),vol):\n\t\t\t\t\ttry:\n\t\t\t\t\t\tfound=True\n\t\t\t\t\t\tdf_syst=create_df_slow(syst).repartition(1)\n\t\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\t\tversion = syst.split('/')[8]\n\t\t\t\t\t\tenvoi(df_syst, find_aircraft_NAME_from_path(syst)+'_'+find_aircraft_DATE_from_path(vol[0]), destination + version + '/')\n\t\t\t\t\t\tbreak\n\t\t\t\t\texcept:\n\t\t\t\t\t\tbreak\n\t\t\t\t\n\t\t\tif not found:\n\t\t\t\ttry:\n\t\t\t\t\tdf_syst=create_df_slow(syst).repartition(1)\n\t\t\t\t\tdf_syst=df_syst.withColumn('Part', F.lit('0'))\n\t\t\t\t\tdf_syst=fill2(df_syst)\n\t\t\t\t\tversion = syst.split('/')[8]\n\t\t\t\t\tenvoi(df_syst, find_aircraft_NAME_from_path(syst)+'_X', destination + version + '/')\n\t\t\t\texcept:\n\t\t\t\t\tpass\n\n#concatenation et envoi des fichiers sur l hdfs\n# general_list_of_new_vol_files_in_sublists-> new_vols from the function get_vols_perfo\n# vol is a list of files identified as bellonging to the same flight that will be combined\n# get_vols_perfo wil ad a list with a single vol file when two files dates mismatch\ndef concatenate_send(general_list_of_new_vol_files_in_sublists, destination):\n\t#septx = ['SN267', 'SN268', 'SN269', 'SN270']\n\tmodel_7X_SN_list = ['SN267', 'SN268', 'SN269', 'SN270']\n\tmodel_8X_SN_list = ['SN412', 'SN425', 'SN449', 'SN455', 'SN466']\n\n\tif general_list_of_new_vol_files_in_sublists==[]:\n\t\tNone\n\telse:\n\t\tfor vol in general_list_of_new_vol_files_in_sublists:\n\t\t\t#vol is list of IRYS2/PERFOS files, if the list is more than one file\n\t\t\tif len(vol)>1:\n\t\t\t\ttry:\n\t\t\t\t\tdf=create_df_vol_slow(vol)\n\t\t\t\t\tdf= df.drop('other')\n\t\t\t\t\tdf=fill2(df)\n\t\t\t\t\tdf=df.repartition('Part')\n\t\t\t\t\tversion = vol[0].split('/')[8]\n\t\t\t\t\t# nom_vol(vol[0]) return either 'IRYS2_' (if 'IRYS2_' is found in the path even if 'PERFOS_' is also present) 'PERFOS_'\n\n\t\t\t\t\t#version = vol[0].split('/')[8]\n\t\t\t\t\t#\"/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN269/TRD_P1028_ISSUE_3_IRYS2_REPORT_0420269_20190306160655t.csv\" -> \"SN269\"\n\t\t\t\t\t# version[-3:] -> 269\n\n\t\t\t\t\t# find_aircraft_ID_from_path(vol[0]) \n\t\t\t\t\t# for a path like /datalake/prod/c2/ddd/crm/acmf/fichier_brut_par_mois/SN267/Year_2019/Month_07/Day_24/TRD_P1106_ISSUE_2_PERFOS_REPORT_0420267_20190724144011t.csv\n\t\t\t\t\t#find_aircraft_ID_from_path(vol[0]) return \"267_20190724144011t.csv\" ?\n\t\t\t\t\t# p exemple : 'PERFOS_' + \"267_20190724144011t.csv\" or \"0420267_20190724144011t\"\n\t\t\t\t\tp = nom_vol(vol[0])+find_aircraft_ID_from_path(vol[0])\n\t\t\t\t\t#Lorsque l'ACMF est extrait du CMC le nom et numero avion n'est pas forcement ecrit\n\t\t\t\t\tif '__' in p:\n\t\t\t\t\t\t\n\t\t\t\t\t\tif version in model_7X_SN_list:\n\t\t\t\t\t\t\tfile_name = nom_vol(vol[0])+ '0420' + version[-3:] +find_aircraft_ID_from_path(vol[0])\n\t\t\t\t\t\t\tfile_path_destination = destination + version + '/'\n\t\t\t\t\t\t\tenvoi(df, file_name, file_path_destination)\n\t\t\t\t\t\telif version in model_8X_SN_list:\n\t\t\t\t\t\t\tfile_name = nom_vol(vol[0])+ '0580' + version[-3:] +find_aircraft_ID_from_path(vol[0])\n\t\t\t\t\t\t\tfile_path_destination = destination + version + '/'\n\t\t\t\t\t\t\tenvoi(df, file_name, file_path_destination)\n                        # Case where the plane is not recognised in either list\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\tfile_name = nom_vol(vol[0])+ '0000' + version[-3:] +find_aircraft_ID_from_path(vol[0])\n\t\t\t\t\t\t\tfile_path_destination = destination + version + '/'\n\t\t\t\t\t\t\tenvoi(df, file_name, file_path_destination)\n\t\t\t\t\telse:\n\t\t\t\t\t\tfile_name = nom_vol(vol[0])+find_aircraft_ID_from_path(vol[0])\n\t\t\t\t\t\tfile_path_destination = destination + version + '/'\n\n\t\t\t\t\t\tenvoi(df, file_name, file_path_destination)\n\t\t\t\texcept:\n\t\t\t\t\tpass\n\t\t\t# vol is a list of a single file\t\t\n\t\t\telse:\n\t\t\t\ttry:\n\t\t\t\t\tdf=create_df_slow(vol[0])\n\t\t\t\t\tdf= df.drop('other')\n\t\t\t\t\tdf=fill2(df)\n\t\t\t\t\tdf=df.withColumn('Part', F.lit('0'))\n\t\t\t\t\tp = nom_vol(vol[0])+find_aircraft_ID_from_path(vol[0])\n\t\t\t\t\tversion = vol[0].split('/')[8]\n\t\t\t\t\tif '__' in p:\n\t\t\t\t\t\tif version in model_7X_SN_list:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0420' + version[-3:] +find_aircraft_ID_from_path(vol[0]), destination + version + '/')\n\t\t\t\t\t\telif version in model_8X_SN_list:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0580' + version[-3:] +find_aircraft_ID_from_path(vol[0]), destination + version + '/')\n\t\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+ '0000' + version[-3:] +find_aircraft_ID_from_path(vol[0]), destination + version + '/')\n\t\t\t\t\telse:\n\t\t\t\t\t\t\tenvoi(df, nom_vol(vol[0])+find_aircraft_ID_from_path(vol[0]), destination + version + '/')\n\t\t\t\texcept:\n\t\t\t\t\tpass\n\n\n\n#detection de tous les fichiers vols\ndef get_Irys(Lp_SN):\n\tList_IRYS2_or_PERFOS_files=[]\n\tfor path in Lp_SN:\n        # boolean -> return 'IRYS2' in path or 'PERFOS' in path\n\t\tif is_Irys(path):\n\t\t\tList_IRYS2_or_PERFOS_files.append(path)\n\treturn List_IRYS2_or_PERFOS_files\n###############################################################################\n#                   Function added to Pretreatment_new_files                  #\n###############################################################################\n\n# Some of the old function do not behave properly :\n# id_date(path) if the file name (string) end with something other than the date it is also extracted -> date_test =  20210430060747t  => Consequences : unknown\n# The last character of id_date resulting string is always taken out in the function get_vols_perfo. If the files always ends with a t after a date YYYYmmddHHMMSS => no consequences\n\ndef strip_non_numeric_char_from_string(my_string):\n\tnon_numeric_string = re.sub(\"[^0-9]\", \"\", my_string)\n\treturn non_numeric_string\n\ndef extract_infos_from_ACMF_raw_csv_header(ACMF_rdd):\n\tsixLines_header_as_list = ACMF_rdd.zipWithIndex().filter(lambda a:a[1]<6).map(lambda a:a[0])\n\tReportName = sixLines_header_as_list.collect()[0].split(\"ReportName \",1)[1]\n\tTriggerTime = sixLines_header_as_list.collect()[3].split(\"TriggerTime \",1)[1]\n\tReportTime = sixLines_header_as_list.collect()[4].split(\"Report written on \",1)[1]\n\tTailNumber = sixLines_header_as_list.collect()[5].split(\"Aircraft Tail Number \",1)[1]\n\treturn ReportName, TriggerTime, ReportTime, TailNumber\n\ndef convert_ACMF_raw_csv_file_to_df_ignoring_6linesHeader(ACMF_csvFile_path):\n\tACMF_rdd = sc.textFile(ACMF_csvFile_path)\n\t#All the raw csv ACMF files have a 6 lines header with important informations but giving the file an abnormal structure\n\trdd_final = ACMF_rdd.zipWithIndex().filter(lambda a:a[1]>5).map(lambda a:a[0].split(\",\"))\n\tcolumns_names = rdd_final.collect()[0]\n\tskipline = rdd_final.first()\n\tACMF_df = rdd_final.filter(lambda a:a!=skipline).toDF(columns_names)\n\treturn ACMF_df\n\ndef convert_ACMF_raw_csv_file_to_df(ACMF_csvFile_path):\n\tACMF_rdd = sc.textFile(ACMF_csvFile_path)\n\t#All the raw csv ACMF files have a 6 lines header with important informations but giving the file an abnormal structure\n\trdd_final = ACMF_rdd.zipWithIndex().filter(lambda a:a[1]>5).map(lambda a:a[0].split(\",\"))\n\tcolumns_names = rdd_final.collect()[0]\n\tskipline = rdd_final.first()\n\tACMF_df = rdd_final.filter(lambda a:a!=skipline).toDF(columns_names)\n\tReportName, TriggerTime, ReportTime, TailNumber = extract_infos_from_ACMF_raw_csv_header(ACMF_rdd)\n\tACMF_df_final = ACMF_df.withColumn('ReportName', F.lit(ReportName)).withColumn('TriggerTime', F.lit(TriggerTime)).withColumn('ReportTime', F.lit(ReportTime)).withColumn('TailNumber', F.lit(TailNumber))\n\treturn ACMF_df_final\n\ndef get_date_from_ACMF_csv_file(path):\n\t#file_name = find_aircraft_NAME_from_path(test_path)\n\tfile_name = find_aircraft_NAME_from_path(path)\n\tfile_name_ending = file_name.split('_')[-1]\n\tfile_writing_date = dparser.parse(file_name_ending,fuzzy=True, dayfirst=False, yearfirst=True)\n\treturn file_writing_date\n\ndef get_date_as_numeric_string_from_ACMF_csv_file(path):\n\tfile_date = get_date_from_ACMF_csv_file(path)\n\tfile_date_as_numeric_string = strip_non_numeric_char_from_string(str(file_date))\n\treturn file_date_as_numeric_string\n\n########################################################################################\n########################################################################################\n\n\n\n########################################################################################\n########################################################################################\n########################################################################################\n########################################################################################\n\n\n#Envoi des nouveaux fichiers systemes\n# Seule fonction appelee pour trouver, transformer et ecrire les nouveaux fichiers vols\n\n#def write_systems_files_datalake(input_path):\ndef write_systems_files_datalake(input_path, inputSN, output_destination_vol):\n\t\n\t#inputSN = listdir(input_path)\n\t#A MODIFIER ICI POUR NE PAS METTRE LA PRIO SUR 268\n\t# inputSN = ['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN268']\n\t\n    #inputSN = ['/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN267', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN268', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN269', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN270', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN412', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN425', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN449', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN455', '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN466']\n\n\t\n\tfor SN in inputSN:\n\t\t\tif not '.xlsx' in SN:\n\t\t\t\t\n                #output_destination_vol = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_vol_2/'\n                \n                # Get two lists of new files path, one for the new vol (IRYS2 or PERFOS files) and one for the new system files\n\t\t\t\t# Eather of the list can be empty\n\t\t\t\tL_vols, L_syst = get_new_files(SN[-5:], all_files=False)\n\t\t\t\t\n\t\t\t\t#MODIF ICI\n\t\t\t\tnew_vols = get_vols_perfo(L_vols)\n\t\t\t\t\n                # Used to create the new vol files\n\t\t\t\tconcatenate_send(new_vols, output_destination_vol)\n\t\t\t\t\n                # Need to investigate the index problem of get_system_identifier\n                # Prone to bugs but technically works with full path\n\t\t\t\tsystems = get_system_identifier(L_syst)\n                # if the system list is not empty transform the file in a fichier_systeme_2 file\n\t\t\t\tif systems != []:\n                    # For each systems identified in the new system file list\n\t\t\t\t\tfor system in systems:\n\t\t\t\t\t\toutput_destination_syst = '/datalake/prod/c2/ddd/crm/acmf/pretraitement/fichier_systeme_2/' + system + '/'\n\t\t\t\t\t\tfind_rename_send_system_report_all_files(new_vols, L_syst, output_destination_syst, system)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1964<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/</a>"}]},"apps":[],"jobName":"paragraph_1693905765581_2131728428","id":"20230901-170307_218036837","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:104"},{"text":"%pyspark\nSN = '/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN267'\nprint(SN[-5:])","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"SN267"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1963<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1963/</a>"}]},"apps":[],"jobName":"paragraph_1693905765593_2139423406","id":"20230901-170342_559468543","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:105"},{"text":"%pyspark\nL_vols, L_syst = get_new_files(\"SN449\", all_files=False)\nprint(L_vols)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":false,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Job is cancelled"}]},"apps":[],"jobName":"paragraph_1693905765604_2122879203","id":"20230901-170709_1302259969","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:106"},{"text":"%pyspark\nnewTest_df = create_df(\"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\")\n\nprint(\"row count = \", newTest_df.count())\nnewTest_df.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"An error occurred while calling o531.showString.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 27.0 failed 4 times, most recent failure: Lost task 0.3 in stage 27.0 (TID 46, dalbigc03.dassault-avion.fr, executor 4): java.lang.IllegalArgumentException\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:334)\n\tat org.apache.arrow.vector.ipc.message.MessageChannelReader.readNextMessage(MessageChannelReader.java:64)\n\tat org.apache.arrow.vector.ipc.message.MessageSerializer.deserializeSchema(MessageSerializer.java:104)\n\tat org.apache.arrow.vector.ipc.ArrowStreamReader.readSchema(ArrowStreamReader.java:128)\n\tat org.apache.arrow.vector.ipc.ArrowReader.initialize(ArrowReader.java:181)\n\tat org.apache.arrow.vector.ipc.ArrowReader.ensureInitialized(ArrowReader.java:172)\n\tat org.apache.arrow.vector.ipc.ArrowReader.getVectorSchemaRoot(ArrowReader.java:65)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:154)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:114)\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:252)\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec$$anon$2.<init>(ArrowEvalPythonExec.scala:90)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec.evaluate(ArrowEvalPythonExec.scala:88)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:131)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:93)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1587)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1586)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1586)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1820)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1769)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1758)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:363)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3272)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3253)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3252)\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2698)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:254)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.IllegalArgumentException\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:334)\n\tat org.apache.arrow.vector.ipc.message.MessageChannelReader.readNextMessage(MessageChannelReader.java:64)\n\tat org.apache.arrow.vector.ipc.message.MessageSerializer.deserializeSchema(MessageSerializer.java:104)\n\tat org.apache.arrow.vector.ipc.ArrowStreamReader.readSchema(ArrowStreamReader.java:128)\n\tat org.apache.arrow.vector.ipc.ArrowReader.initialize(ArrowReader.java:181)\n\tat org.apache.arrow.vector.ipc.ArrowReader.ensureInitialized(ArrowReader.java:172)\n\tat org.apache.arrow.vector.ipc.ArrowReader.getVectorSchemaRoot(ArrowReader.java:65)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:154)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:114)\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:252)\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec$$anon$2.<init>(ArrowEvalPythonExec.scala:90)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec.evaluate(ArrowEvalPythonExec.scala:88)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:131)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:93)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\nTraceback (most recent call last):\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1964/container_e96_1661169780396_1964_01_000001/pyspark.zip/pyspark/sql/dataframe.py\", line 352, in show\n    print(self._jdf.showString(n, int(truncate), vertical))\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1964/container_e96_1661169780396_1964_01_000001/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1964/container_e96_1661169780396_1964_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1964/container_e96_1661169780396_1964_01_000001/py4j-0.10.6-src.zip/py4j/protocol.py\", line 320, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o531.showString.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 0 in stage 27.0 failed 4 times, most recent failure: Lost task 0.3 in stage 27.0 (TID 46, dalbigc03.dassault-avion.fr, executor 4): java.lang.IllegalArgumentException\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:334)\n\tat org.apache.arrow.vector.ipc.message.MessageChannelReader.readNextMessage(MessageChannelReader.java:64)\n\tat org.apache.arrow.vector.ipc.message.MessageSerializer.deserializeSchema(MessageSerializer.java:104)\n\tat org.apache.arrow.vector.ipc.ArrowStreamReader.readSchema(ArrowStreamReader.java:128)\n\tat org.apache.arrow.vector.ipc.ArrowReader.initialize(ArrowReader.java:181)\n\tat org.apache.arrow.vector.ipc.ArrowReader.ensureInitialized(ArrowReader.java:172)\n\tat org.apache.arrow.vector.ipc.ArrowReader.getVectorSchemaRoot(ArrowReader.java:65)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:154)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:114)\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:252)\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec$$anon$2.<init>(ArrowEvalPythonExec.scala:90)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec.evaluate(ArrowEvalPythonExec.scala:88)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:131)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:93)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1587)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1586)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1586)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1820)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1769)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1758)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:363)\n\tat org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n\tat org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collectFromPlan(Dataset.scala:3272)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3253)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3252)\n\tat org.apache.spark.sql.Dataset.head(Dataset.scala:2484)\n\tat org.apache.spark.sql.Dataset.take(Dataset.scala:2698)\n\tat org.apache.spark.sql.Dataset.showString(Dataset.scala:254)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.lang.IllegalArgumentException\n\tat java.nio.ByteBuffer.allocate(ByteBuffer.java:334)\n\tat org.apache.arrow.vector.ipc.message.MessageChannelReader.readNextMessage(MessageChannelReader.java:64)\n\tat org.apache.arrow.vector.ipc.message.MessageSerializer.deserializeSchema(MessageSerializer.java:104)\n\tat org.apache.arrow.vector.ipc.ArrowStreamReader.readSchema(ArrowStreamReader.java:128)\n\tat org.apache.arrow.vector.ipc.ArrowReader.initialize(ArrowReader.java:181)\n\tat org.apache.arrow.vector.ipc.ArrowReader.ensureInitialized(ArrowReader.java:172)\n\tat org.apache.arrow.vector.ipc.ArrowReader.getVectorSchemaRoot(ArrowReader.java:65)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:154)\n\tat org.apache.spark.sql.execution.python.ArrowPythonRunner$$anon$1.read(ArrowPythonRunner.scala:114)\n\tat org.apache.spark.api.python.BasePythonRunner$ReaderIterator.hasNext(PythonRunner.scala:252)\n\tat org.apache.spark.InterruptibleIterator.hasNext(InterruptibleIterator.scala:37)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec$$anon$2.<init>(ArrowEvalPythonExec.scala:90)\n\tat org.apache.spark.sql.execution.python.ArrowEvalPythonExec.evaluate(ArrowEvalPythonExec.scala:88)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:131)\n\tat org.apache.spark.sql.execution.python.EvalPythonExec$$anonfun$doExecute$1.apply(EvalPythonExec.scala:93)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.RDD$$anonfun$mapPartitions$1$$anonfun$apply$23.apply(RDD.scala:800)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.rdd.MapPartitionsRDD.compute(MapPartitionsRDD.scala:38)\n\tat org.apache.spark.rdd.RDD.computeOrReadCheckpoint(RDD.scala:324)\n\tat org.apache.spark.rdd.RDD.iterator(RDD.scala:288)\n\tat org.apache.spark.scheduler.ResultTask.runTask(ResultTask.scala:87)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n"}]},"apps":[],"jobName":"paragraph_1693905765616_2130574181","id":"20230901-170821_433578795","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:107"},{"text":"%pyspark\npath = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\"\nrdd_brut = sc.textFile(path)\nTriggerTime=trigger_time(rdd_brut)\nheader=get_header(rdd_brut)\nrdd = rdd_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\ndf=data_frame(rdd, header)\n\ndf.show()","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+\n|Frame_100_ms|\n+------------+\n|           0|\n|           1|\n|           2|\n|           3|\n|           4|\n|           5|\n|           6|\n|           7|\n|           8|\n|           9|\n|          10|\n|          11|\n|          12|\n|          13|\n|          14|\n|          15|\n|          16|\n|          17|\n|          18|\n|          19|\n+------------+\nonly showing top 20 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1964<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/</a>"}]},"apps":[],"jobName":"paragraph_1693905765627_2127880939","id":"20230901-171518_339601056","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:108"},{"text":"%pyspark\npath = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\"\ndf=create_df_slow(path)\ndf.show()","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+--------------------+--------------------+\n|Frame_100_ms|             Trigger|                date|\n+------------+--------------------+--------------------+\n|           0|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           1|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           2|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           3|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           4|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           5|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           6|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           7|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           8|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|           9|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          10|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          11|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          12|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          13|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          14|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          15|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          16|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          17|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          18|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n|          19|25 JUN 2023 12:10:56|25 06 2023 12:10:...|\n+------------+--------------------+--------------------+\nonly showing top 20 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1964<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1964/</a>"}]},"apps":[],"jobName":"paragraph_1693905765639_-2085519590","id":"20230901-172840_907227054","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:109"},{"title":"New test","text":"%pyspark\ndef trigger_time(rdd):\n\tTriggerTimeRow = GetSpecificRow(rdd,3).map(lambda x: x[0]).map(lambda x: x.split(' '))\n\tTriggerTime = ' '.join(TriggerTimeRow.first()[1:])\n\treturn TriggerTime\n\ndef GetSpecificRow(rdd, id):\n\treturn rdd.zipWithIndex().filter(lambda x: x[1]==id)\n\n#En entree un rdd associe a un fichier acmf\n#En sortie les colonnes du fichier ACMF\ndef get_header(rdd):\n\theaderRow = GetSpecificRow(rdd,6).map(lambda x: x[0]).map(lambda x: x.split(',')) #ici les donnees sont separees par des virgules\n\theader = headerRow.first()\n    # If the first column name is an empty space chage it for other\n\theader = ['other' if column == ' ' else column for column in header]\n\treturn header\n\npath = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\"\nrdd1_brut = sc.textFile(path)\nTriggerTime0=trigger_time(rdd1_brut)\n\nheader=get_header(rdd1_brut)\n\nrdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\nrdd1_df = rdd1.toDF()\n\nprint(\"TriggerTime0 = \", TriggerTime0)\nprint(\"header = \", header)\nprint(\"rdd1 = \", rdd1)\nrdd1_df.show()\n\n\nrdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\nrdd1_df = rdd1.toDF()\nprint(\"rdd1 = \", rdd1)\nrdd1_df.show()\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"TriggerTime0 =  25 JUN 2023 12:10:56\nheader =  ['Frame (100 ms)']\nrdd1 =  PythonRDD[62930] at RDD at PythonRDD.scala:48\n+---+\n| _1|\n+---+\n|  0|\n|  1|\n|  2|\n|  3|\n|  4|\n|  5|\n|  6|\n|  7|\n|  8|\n|  9|\n| 10|\n| 11|\n| 12|\n| 13|\n| 14|\n| 15|\n| 16|\n| 17|\n| 18|\n| 19|\n+---+\nonly showing top 20 rows\n\nrdd1 =  PythonRDD[62940] at RDD at PythonRDD.scala:48\n+---+--------------------+---+\n| _1|                  _2| _3|\n+---+--------------------+---+\n|  0|25 JUN 2023 12:10:56|  0|\n|  1|25 JUN 2023 12:10:56|  0|\n|  2|25 JUN 2023 12:10:56|  0|\n|  3|25 JUN 2023 12:10:56|  0|\n|  4|25 JUN 2023 12:10:56|  0|\n|  5|25 JUN 2023 12:10:56|  0|\n|  6|25 JUN 2023 12:10:56|  0|\n|  7|25 JUN 2023 12:10:56|  0|\n|  8|25 JUN 2023 12:10:56|  0|\n|  9|25 JUN 2023 12:10:56|  0|\n| 10|25 JUN 2023 12:10:56|  0|\n| 11|25 JUN 2023 12:10:56|  0|\n| 12|25 JUN 2023 12:10:56|  0|\n| 13|25 JUN 2023 12:10:56|  0|\n| 14|25 JUN 2023 12:10:56|  0|\n| 15|25 JUN 2023 12:10:56|  0|\n| 16|25 JUN 2023 12:10:56|  0|\n| 17|25 JUN 2023 12:10:56|  0|\n| 18|25 JUN 2023 12:10:56|  0|\n| 19|25 JUN 2023 12:10:56|  0|\n+---+--------------------+---+\nonly showing top 20 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1974<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/</a>"}]},"apps":[],"jobName":"paragraph_1693905765650_-2077439863","id":"20230901-173409_180961947","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:110"},{"text":"%pyspark\ndef create_join_rdd_debug(vol):\n\t# c is a counter\n\tc=0\n\t# Read the first six lines header of the file\n\trdd1_brut = sc.textFile(vol[0])\n\tTriggerTime0=trigger_time(rdd1_brut)\n\t\n\theader=get_header(rdd1_brut)\n\trdd1 = rdd1_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\tlength0 = rdd1.count()\n\t\n\trdd1=rdd1.map(lambda header: header+[TriggerTime0]+[str(0)])\n\theader.append('Trigger')\n\theader.append('Part')\n\trdds=[rdd1]\n\t# For every file in the list except the first\n\tfor path in vol[1:]:\n\t\tc+=1\n\t\trdd2_brut = sc.textFile(path)\n\t\tTriggerTime=trigger_time(rdd2_brut)\n\t\t\n\t\trdd2 = rdd2_brut.zipWithIndex().filter(lambda x: x[1]>6 ).map(lambda x: x[0]).map(lambda x: x.split(','))\n\t\t\n\t\tif rdd2.count() != length0:\n\t\t\trdd=sc.union(rdds)\n\t\t\treturn rdd,header\n\t\telse:\n\t\t\trdd2=rdd2.map(lambda header2: header2+[TriggerTime]+[c])\n\t\t\trdd2.collect()\n\t\t\trdds.append(rdd2)\n\n\trdd=sc.union(rdds)\n\treturn rdd,header\n\t\ndef create_df_vol_slow(vol):\n\t# vol is a list of IRYS2/PERFOS files\n\trdd,header=create_join_rdd_debug(vol)\n\tdf=data_frame(rdd, header)\n\tl,h,L=detect_doublon(df.columns)\n\t\n\tif l!=[]:\n\t\tdf=suppr_doublon(df,h,L)\n\t   \n\tdf=insert_date_udf(df)\n\t\n\treturn df","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1974<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/</a>"}]},"apps":[],"jobName":"paragraph_1693905765911_1920116533","id":"20230904-143550_415143010","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:111"},{"text":"%pyspark\nnewdf = create_df_vol_slow(\"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\")\nnewdf.show()","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"An error occurred while calling o109228.partitions.\n: java.io.IOException: Not a file: hdfs://hdfs.isilon.dassault-avion.fr:8020/datalake\n\tat org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:322)\n\tat org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:200)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:253)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:251)\n\tat scala.Option.getOrElse(Option.scala:121)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:251)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:253)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:251)\n\tat scala.Option.getOrElse(Option.scala:121)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:251)\n\tat org.apache.spark.api.java.JavaRDDLike$class.partitions(JavaRDDLike.scala:61)\n\tat org.apache.spark.api.java.AbstractJavaRDDLike.partitions(JavaRDDLike.scala:45)\n\tat sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nTraceback (most recent call last):\n  File \"<stdin>\", line 37, in create_df_vol_slow\n  File \"<stdin>\", line 6, in create_join_rdd_debug\n  File \"<stdin>\", line 2, in trigger_time\n  File \"<stdin>\", line 7, in GetSpecificRow\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1974/container_e96_1661169780396_1974_01_000001/pyspark.zip/pyspark/rdd.py\", line 2169, in zipWithIndex\n    if self.getNumPartitions() > 1:\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1974/container_e96_1661169780396_1974_01_000001/pyspark.zip/pyspark/rdd.py\", line 401, in getNumPartitions\n    return self._jrdd.partitions().size()\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1974/container_e96_1661169780396_1974_01_000001/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1974/container_e96_1661169780396_1974_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1974/container_e96_1661169780396_1974_01_000001/py4j-0.10.6-src.zip/py4j/protocol.py\", line 320, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o109228.partitions.\n: java.io.IOException: Not a file: hdfs://hdfs.isilon.dassault-avion.fr:8020/datalake\n\tat org.apache.hadoop.mapred.FileInputFormat.getSplits(FileInputFormat.java:322)\n\tat org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:200)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:253)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:251)\n\tat scala.Option.getOrElse(Option.scala:121)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:251)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:253)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:251)\n\tat scala.Option.getOrElse(Option.scala:121)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:251)\n\tat org.apache.spark.api.java.JavaRDDLike$class.partitions(JavaRDDLike.scala:61)\n\tat org.apache.spark.api.java.AbstractJavaRDDLike.partitions(JavaRDDLike.scala:45)\n\tat sun.reflect.GeneratedMethodAccessor135.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\n\n"}]},"apps":[],"jobName":"paragraph_1693905765925_1900879088","id":"20230904-145110_1364710967","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:112"},{"text":"%pyspark\npath = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\"\nrdd1_brut = sc.textFile(path)\nTriggerTime0=trigger_time(rdd1_brut)\n\n#headerRow = GetSpecificRow(rdd1_brut,6).map(lambda x: x[0]).map(lambda x: x.split(','))\nheaderRow = GetSpecificRow(rdd1_brut,6)\n\nprint(\"TriggerTime0 = \", TriggerTime0)\nprint(\"headerRow = \", headerRow)\nheaderRow_df = headerRow.toDF()\nheaderRow_df.show()\n\n\n#print(\"rdd1 = \", rdd1)\n#rdd1_df.show(150, truncate=70)\n\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"TriggerTime0 =  25 JUN 2023 12:10:56\nheaderRow =  PythonRDD[63031] at RDD at PythonRDD.scala:48\n+--------------+---+\n|            _1| _2|\n+--------------+---+\n|Frame (100 ms)|  6|\n+--------------+---+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1974<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/</a>"}]},"apps":[],"jobName":"paragraph_1693905765939_1909343564","id":"20230904-145331_993255110","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:113"},{"text":"%pyspark\n\ndef GetSpecificRow(rdd, id):\n\treturn rdd.zipWithIndex().filter(lambda x: x[1]==id)\n\npath = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\"\nrdd1_brut = sc.textFile(path)\n\ndata = rdd1_brut.collect()\nprint(\"data[0]  = \", data[0])\nprint(\"data[1]  = \", data[1])\nprint(\"data[2]  = \", data[2])\nprint(\"data[3]  = \", data[3])\nprint(\"data[4]  = \", data[4])\nprint(\"data[5]  = \", data[5])\nprint(\"data[6]  = \", data[6])\nprint(\"data[7]  = \", data[7])\n","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data[0]  =  ReportName TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT\ndata[1]  =  AcmfApplicationName C:\\CMC\\APPLICATIONS\\\\USER.ACM\ndata[2]  =  AcmfApplicationVersion 5.0.-\ndata[3]  =  TriggerTime 25 JUN 2023 12:10:56\ndata[4]  =  Report written on 25 JUN 2023 12:12:37\ndata[5]  =  Aircraft Tail Number VQBXD\ndata[6]  =  Frame (100 ms)\ndata[7]  =  0"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1974<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/</a>"}]},"apps":[],"jobName":"paragraph_1693905765951_1904726577","id":"20230904-145212_862090588","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:114"},{"text":"%pyspark\n\n# Do Not Work\n#path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580449_20230625121237t.csv\"\n# Do Not Work\n#path = \"/datalake/prod/c2/ddd/crm/acmf/fichier_brut_par_mois/SN267/Year_2021/Month_07/Day_20/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420267_20210720155623t.csv\"\n# Work\n#path = \"/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN267/MUX_P1153_ISSUE_3_AB_REPORT_0420267_20210430060747t.csv\"\n# Work\n#path = \"/datalake/prod/c2/ddd/crm/acmf/fichier_brut/SN267/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420267_20210720155623t.csv\"\n# Work\npath = \"/datalake/prod/c2/ddd/crm/acmf/New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230611130330t.csv\"\n\nACMF_rdd = sc.textFile(path)\n#All the raw csv ACMF files have a 6 lines header with important informations but giving the file an abnormal structure\nrdd_final = ACMF_rdd.zipWithIndex().filter(lambda a:a[1]>5).map(lambda a:a[0].split(\",\"))\ncolumns_names = rdd_final.collect()[0]\nprint(columns_names)","dateUpdated":"2023-09-05T11:22:45+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"['Frame (100 ms) ', ' ASCB D\\\\ADS\\\\ADS1aADA\\\\airData1000msecA429Data\\\\totalAirTemperature', ' ASCB D\\\\ADS\\\\ADS1aADA\\\\airData50msec\\\\lbl241b28_12AngleOfAttackAircraft', ' ASCB D\\\\ADS\\\\ADS1aADA\\\\airData50msec\\\\lbl250b28_12AngleofSideslip', ' ASCB D\\\\ADS\\\\ADS1aADA\\\\airData50msec\\\\staticAirTemperature', ' ASCB D\\\\ADS\\\\ADS1aADA\\\\airData50msec\\\\staticPressure', ' ASCB D\\\\ADS\\\\ADS1aADA\\\\airData50msec\\\\totalPressure', ' ASCB D\\\\ADS\\\\ADS2aADA\\\\airData1000msecA429Data\\\\totalAirTemperature', ' ASCB D\\\\ADS\\\\ADS2aADA\\\\airData50msec\\\\lbl241b28_12AngleOfAttackAircraft', ' ASCB D\\\\ADS\\\\ADS2aADA\\\\airData50msec\\\\lbl250b28_12AngleofSideslip', ' ASCB D\\\\ADS\\\\ADS2aADA\\\\airData50msec\\\\staticAirTemperature', ' ASCB D\\\\ADS\\\\ADS2aADA\\\\airData50msec\\\\staticPressure', ' ASCB D\\\\ADS\\\\ADS2aADA\\\\airData50msec\\\\totalPressure', ' ASCB D\\\\AMMONE\\\\AMMONE1aA429\\\\ammone1000msecA429Data\\\\lbl274b29_14BASFlow', ' ASCB D\\\\AMMONE\\\\AMMONE1aA429\\\\ammone1000msecA429Discretes\\\\lbl270b22BrakeHeatingMode', ' ASCB D\\\\AMMONE\\\\AMMONE1aA429\\\\ammone1000msecA429Discretes\\\\lbl270b23SDuctAntiIceMode', ' ASCB D\\\\AMMONE\\\\AMMONE1aA429\\\\ammone1000msecA429Discretes\\\\lbl270b24WingAntiIceMode', ' ASCB D\\\\AMMONE\\\\AMMONE1aA429\\\\ammone1000msecA429Discretes\\\\lbl272b15MprsovEng1ClosedPositionSwitch', ' ASCB D\\\\AMMONE\\\\AMMONE1aA429\\\\ammone1000msecA429Discretes\\\\lbl272b29HprSovClosed', ' ASCB D\\\\AMMTHREE\\\\AMMTHREE1aA429\\\\ammthree1000msecA429Data\\\\lbl274b29_14BASFlow', ' ASCB D\\\\AMMTHREE\\\\AMMTHREE1aA429\\\\ammthree1000msecA429Data\\\\lbl311b29_14LHFreshAirFlow', ' ASCB D\\\\AMMTHREE\\\\AMMTHREE1aA429\\\\ammthree1000msecA429Discretes\\\\lbl272b15MprSovClosedEng3Position', ' ASCB D\\\\AMMTHREE\\\\AMMTHREE1aA429\\\\ammthree1000msecA429Discretes\\\\lbl272b29HPPRSOVClosed', ' ASCB D\\\\AMMTWO\\\\AMMTWO1aA429\\\\ammtwo1000msecA429Data\\\\lbl274b29_14BASFlow', ' ASCB D\\\\AMMTWO\\\\AMMTWO1aA429\\\\ammtwo1000msecA429Data\\\\lbl311b29_14RHFreshAirFlow', ' ASCB D\\\\AMMTWO\\\\AMMTWO1aA429\\\\ammtwo1000msecA429Discretes\\\\lbl272b15MprSovClosedEng2Position', ' ASCB D\\\\AMMTWO\\\\AMMTWO1aA429\\\\ammtwo1000msecA429Discretes\\\\lbl272b29HPPRSOVClosed', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone100msecA429Data\\\\lbl114b29_17LeftInboardBrakeTemperature', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone100msecA429Data\\\\lbl116b29_17RightInboardBrakeTemperature', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone100msecA429Discretes\\\\lbl271b20ParkBrakeValveHandlePosition', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl005b28_17LeftOutboardWheelSpeed', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl006b28_17LeftInboardWheelSpeed', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl007b28_17RightInboardWheelSpeed', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl040b28_17RightOutboardWheelSpeed', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl051b28_17LeftBrakeControlValveCurrent', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl052b28_17RightBrakeControlValveCurrent', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl070b28_17LeftBrakePressure', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone12msecA429Data\\\\lbl072b28_17RightBrakePressure', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone50msecA429Data\\\\lbl113b28_17ShutoffValveCurrent', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone50msecA429Data\\\\lbl171b29_21LeftPilotBrakePedalPosition', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone50msecA429Data\\\\lbl172b29_21RightPilotBrakePedalPosition', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone50msecA429Data\\\\lbl173b29_21LeftCopilotBrakePedalPosition', ' ASCB D\\\\BCUONE\\\\BCUONE1aA429\\\\bcuone50msecA429Data\\\\lbl174b29_21RightCopilotBrakePedalPosition', ' ASCB D\\\\BCUTWO\\\\BCUTWO1aA429\\\\bcutwo100msecA429Data\\\\lbl050b28_17ParkEmergencyBrakeAccumulatorPressure', ' ASCB D\\\\CPCSCAB\\\\CPCSCAB1aA429\\\\cpcscab200msecA429Data\\\\lbl204b28_13CabinPressureActual', ' ASCB D\\\\EEC\\\\EEC1aA429\\\\eec1000msecA429Discretes\\\\lbl273b24ThrustReverser', ' ASCB D\\\\EEC\\\\EEC1aA429\\\\eec100msecA429Data\\\\lbl300b29_15N1Trimmed', ' ASCB D\\\\EEC\\\\EEC1aA429\\\\eec100msecA429Data\\\\lbl344b29_15N2MechanicalSpeed', ' ASCB D\\\\EEC\\\\EEC1aA429\\\\eec100msecA429Data\\\\lbl345b29_17ITT', ' ASCB D\\\\EEC\\\\EEC1aA429\\\\eec100msecA429Data\\\\lbl346b29_15N1MechanicalSpeed', ' ASCB D\\\\EEC\\\\EEC1aA429\\\\eec200msecA429Data\\\\lbl134b29_17TLAPlusAutothrottleTLATrim', ' ASCB D\\\\EEC\\\\EEC1aA429\\\\eec50msecA429Data\\\\lbl133b29_17SelectedTLA', ' ASCB D\\\\EEC\\\\EEC3aA429\\\\eec100msecA429Data\\\\lbl300b29_15N1Trimmed', ' ASCB D\\\\EEC\\\\EEC3aA429\\\\eec100msecA429Data\\\\lbl344b29_15N2MechanicalSpeed', ' ASCB D\\\\EEC\\\\EEC3aA429\\\\eec100msecA429Data\\\\lbl345b29_17ITT', ' ASCB D\\\\EEC\\\\EEC3aA429\\\\eec100msecA429Data\\\\lbl346b29_15N1MechanicalSpeed', ' ASCB D\\\\EEC\\\\EEC3aA429\\\\eec200msecA429Data\\\\lbl134b29_17TLAPlusAutothrottleTLATrim', ' ASCB D\\\\EEC\\\\EEC3aA429\\\\eec50msecA429Data\\\\lbl133b29_17SelectedTLA', ' ASCB D\\\\EEC\\\\EEC5aA429\\\\eec100msecA429Data\\\\lbl300b29_15N1Trimmed', ' ASCB D\\\\EEC\\\\EEC5aA429\\\\eec100msecA429Data\\\\lbl344b29_15N2MechanicalSpeed', ' ASCB D\\\\EEC\\\\EEC5aA429\\\\eec100msecA429Data\\\\lbl345b29_17ITT', ' ASCB D\\\\EEC\\\\EEC5aA429\\\\eec100msecA429Data\\\\lbl346b29_15N1MechanicalSpeed', ' ASCB D\\\\EEC\\\\EEC5aA429\\\\eec200msecA429Data\\\\lbl134b29_17TLAPlusAutothrottleTLATrim', ' ASCB D\\\\EEC\\\\EEC5aA429\\\\eec50msecA429Data\\\\lbl133b29_17SelectedTLA', ' ASCB D\\\\FCS\\\\FCS1At\\\\atDisplayed\\\\atControlMode', ' ASCB D\\\\FCS\\\\FCS1At\\\\atStatus\\\\atEngaged', ' ASCB D\\\\FCS\\\\FCS1Fd\\\\fdModes\\\\fdActiveLatMode', ' ASCB D\\\\FCS\\\\FCS1Fd\\\\fdModes\\\\fdActiveVertMode', ' ASCB D\\\\FCS\\\\FCS1Fd\\\\fdPitRolCmds\\\\fdPitchCmd', ' ASCB D\\\\FCS\\\\FCS1Fd\\\\fdPitRolCmds\\\\fdRollCmd', ' ASCB D\\\\FMS\\\\FMS1FMA\\\\rate1000ms\\\\zeroFuelWeightCG', ' ASCB D\\\\FMS\\\\FMS1FMA\\\\rate100ms\\\\grossWeight', ' ASCB D\\\\FMS\\\\FMS1FMA\\\\rate100ms\\\\phaseOfFlight', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl167b28_14LeftWingOuterTankFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl172b28_14CenterCircuitTotalFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl177b28_14LeftWingMiddleTankFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl200b28_14LeftWingInnerTankFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl201b28_14RightWingOuterTankFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl202b28_14RightWingMiddleTankFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl203b28_14RightWingInnerTankFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl213b28_14LeftFuelUsedQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl214b28_14RightFuelUsedQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl215b28_14CenterFuelUsedQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl257b28_14LeftCircuitTotalFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel1000msecA429Data\\\\lbl261b28_14RightCircuitTotalFuelQuantity', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel100msecA429Data\\\\lbl345b28_17CenterFuelFlow', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel100msecA429Data\\\\lbl346b28_17RightFuelFlow', ' ASCB D\\\\FUEL\\\\FUEL1aA429\\\\fuel100msecA429Data\\\\lbl347b28_17LeftFuelFlow', ' ASCB D\\\\GGF\\\\GGF1GGA\\\\hsiData\\\\leftMnGearState', ' ASCB D\\\\GGF\\\\GGF1GGA\\\\hsiData\\\\noseGearState', ' ASCB D\\\\GGF\\\\GGF1GGA\\\\hsiData\\\\rightMnGearState', ' ASCB D\\\\GIOFOUR\\\\GIOFOUR1aAnalog\\\\gioFour50msecVersatileAnalogData\\\\hydSysBPress', ' ASCB D\\\\GIOFOUR\\\\GIOFOUR1aDiscrete\\\\gioFour50msecDiscretes\\\\airbrakePanelInboardRH', ' ASCB D\\\\GIOFOUR\\\\GIOFOUR1aDiscrete\\\\gioFour50msecDiscretes\\\\casov2FullClosedSW', ' ASCB D\\\\GIOONE\\\\GIOONE1aAnalog\\\\gioOne50msecVersatileAnalogData\\\\hydSysAPress', ' ASCB D\\\\GIOONE\\\\GIOONE1aAnalog\\\\gioOne50msecVersatileAnalogData\\\\oxyTemperatureSignal', ' ASCB D\\\\GIOONE\\\\GIOONE1aDiscrete\\\\gioOne50msecDiscretes\\\\airbrakePanelOutboardLH', ' ASCB D\\\\GIOONE\\\\GIOONE1aDiscrete\\\\gioOne50msecDiscretes\\\\backupSlatSwIndic', ' ASCB D\\\\GIOONE\\\\GIOONE1aDiscrete\\\\gioOne50msecDiscretes\\\\casov1FullClosedSW', ' ASCB D\\\\GIOONE\\\\GIOONE1aDiscrete\\\\gioOne50msecDiscretes\\\\casov3FullClosedSW', ' ASCB D\\\\GIOONE\\\\GIOONE1aDiscrete\\\\gioOne50msecDiscretes\\\\flapSlatLeverPosSF3', ' ASCB D\\\\GIOTHREE\\\\GIOTHREE1aDiscrete\\\\gioThree50msecDiscretes\\\\airbrakePanelInboardLH', ' ASCB D\\\\GIOTWO\\\\GIOTWO1aAnalog\\\\gioTwo50msecVersatileAnalogData\\\\hydSysCPress', ' ASCB D\\\\GIOTWO\\\\GIOTWO1aAnalog\\\\gioTwo50msecVersatileAnalogData\\\\oxyPressureSignal', ' ASCB D\\\\GIOTWO\\\\GIOTWO1aDiscrete\\\\gioTwo50msecDiscretes\\\\airbrakePanelOutboardRH', ' ASCB D\\\\GIOTWO\\\\GIOTWO1aDiscrete\\\\gioTwo50msecDiscretes\\\\flapSlatLeverPosSF1', ' ASCB D\\\\GIOTWO\\\\GIOTWO1aDiscrete\\\\gioTwo50msecDiscretes\\\\flapSlatLeverPosSF2', ' ASCB D\\\\GPS\\\\GPS1aGps429\\\\gps50msec429\\\\altitude', ' ASCB D\\\\GPS\\\\GPS1aGps429\\\\gps50msec429\\\\latitude', ' ASCB D\\\\GPS\\\\GPS1aGps429\\\\gps50msec429\\\\latitudeFine', ' ASCB D\\\\GPS\\\\GPS1aGps429\\\\gps50msec429\\\\longitude', ' ASCB D\\\\GPS\\\\GPS1aGps429\\\\gps50msec429\\\\longitudeFine', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs100msecHybrid429\\\\lbl137b29_14HybridTrackAngle', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs100msecHybrid429\\\\lbl175b28_14HybridGroundSpeed', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs100msecHybrid429\\\\lbl263b29_17HybridFlightPathAngle', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs100msecHybrid429\\\\lbl266b29_14HybridNSVelocity', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs100msecHybrid429\\\\lbl267b29_14HybridEWVelocity', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs100msecHybrid429\\\\lbl345b29_14HybridVerticalVelocity', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\bodyLatAccel', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\bodyLongAccel', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\bodyNormAccel', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\bodyPitchRate', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\bodyRollRate', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\bodyYawRate', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\flightPathAccel', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\inertialVerticalSpd', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\pitchAngle', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\rollAngle', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs12msec429\\\\trueHeading', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs50msec429\\\\ewVelocity', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs50msec429\\\\nsVelocity', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs50msec429\\\\windDirectionTrue', ' ASCB D\\\\IRS\\\\IRS1aIrs429\\\\irs50msec429\\\\windSpeed', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl270b20LMGUplock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl270b21LMGDownlock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl270b26NLGUplock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl270b27NLGDownlock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl271b28RMGUplock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl271b29RMGDownlock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl363b19LMGDoorUplock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl364b25RMGDoorUplock', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl365b28GearHandleDown', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu100msecA429Discretes\\\\lbl365b29GearHandleUp', ' ASCB D\\\\LGSCU\\\\LGSCU1aA429\\\\lgscu50msecA429Data\\\\lbl376b29_17NosewheelAngle', ' ASCB D\\\\LGSCU\\\\LGSCU2aA429\\\\lgscu100msecA429Discretes\\\\lbl365b28GearHandleDown', ' ASCB D\\\\LGSCU\\\\LGSCU2aA429\\\\lgscu100msecA429Discretes\\\\lbl365b29GearHandleUp', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b11Throttle1IdleDiscrete1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b13Throttle2IdleDiscrete1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b15Throttle3IdleDiscrete1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b17Throttle1TODiscrete1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b19Throttle2TODiscrete1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b21Throttle3TODiscrete1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b27ABManualExtendCmd1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic1000msecCMCData\\\\lbl117b28ABManualExtendCmd2', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl100b29_18LhAileronPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl101b29_18RhAileronPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl102b29_18LhElevatorPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl103b29_18RhElevatorPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl104b29_18LhSpoilerPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl105b29_18RhSpoilerPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl106b29_18PrimaryRudderPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl120b29_18PilotPitchControlPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl121b29_18PilotRollControlPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl123b29_18CopilotPitchControlPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic100msecA429Data\\\\lbl124b29_18CopilotRollControlPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl110b29_18HorizontalStabilizerPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl111b29_18LhInboardFlapPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl112b29_18RhInboardFlapPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl113b29_18LhInboardFlapPosition2_1', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl114b29_18RhInboardFlapPosition2_2', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl115b29_18CombinedFlapPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl127b29_18AirbrakesLeverPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Data\\\\lbl240b29_11PitchElevatorTrimOrder', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b11LhOutboardSlatExtension', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b12RhOutboardSlatExtension', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b13LhMiddleSlatExtension', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b14RhMiddleSlatExtension', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b15LhInboardSlatExtension', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b16RhInboardSlatExtension', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b17LhOutboardSlatRetraction', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b18RhOutboardSlatRetraction', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b19LhMiddleSlatRetraction', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b20RhMiddleSlatRetraction', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b21LhInboardSlatRetraction', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl116b22RhInboardSlatRetraction', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl277b11APEngagementStatus', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl277b12PfcsNoseLandingGearWOWStatus', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl277b13PfcsLhMainLandingGearWOWStatus', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic200msecA429Discretes\\\\lbl277b14PfcsRhMainLandingGearWOWStatus', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic50msecA429Data\\\\lbl122b29_18PilotYawControlPosition', ' ASCB D\\\\MAIC\\\\MAIC1aA429\\\\maic50msecA429Data\\\\lbl125b29_18CopilotYawControlPosition', ' ASCB D\\\\MRC\\\\MRC1Cluster\\\\cat3Nav100msec\\\\cat3GsDev', ' ASCB D\\\\MRC\\\\MRC1Cluster\\\\cat3Nav100msec\\\\cat3LocDev', ' ASCB D\\\\PPDBL\\\\PPDBL1aA429\\\\ppdbl200msecA429Data\\\\lbl002b28_17PointOfRegulationVoltage', ' ASCB D\\\\PPDBL\\\\PPDBL1aA429\\\\ppdbl200msecA429Data\\\\lbl006b28_18LoadCurrent', ' ASCB D\\\\PPDBR\\\\PPDBR1aA429\\\\ppdbr200msecA429Data\\\\lbl002b28_17PointOfRegulationVoltage', ' ASCB D\\\\PPDBR\\\\PPDBR1aA429\\\\ppdbr200msecA429Data\\\\lbl006b28_18LoadCurrent', ' ASCB D\\\\RADALT\\\\RADALT1aA429\\\\radalt50msec429\\\\radioHeight', ' ']"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1974<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/</a>"}]},"apps":[],"jobName":"paragraph_1693905765963_1887797625","id":"20230904-151448_738646872","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:115"},{"title":"Works to remove but error message","text":"%pyspark\npath = \"/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803225543t.csv\"\n\n# Use subprocess to run the HDFS command to delete the file or folder\n# Be cautious when using this method as it directly interacts with HDFS.\nsubprocess.run([\"hadoop\", \"fs\", \"-rm\", \"-r\", path])","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Unrecognized token 'Deleted': was expecting ('true', 'false' or 'null')\n at [Source: Deleted /datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803225543t.csv; line: 1, column: 8]"}]},"apps":[],"jobName":"paragraph_1693905765975_1895492603","id":"20230904-154011_1660030101","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:116"},{"title":"No error message","text":"%pyspark\npath2 = \"/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230711115235t.csv\"\n\n# Use subprocess to run the HDFS command to delete the file or folder\n# Be cautious when using this method as it directly interacts with HDFS.\nsubprocess.run([\"hadoop\", \"dfs\", \"-rm\", \"-r\", path2])","dateUpdated":"2023-09-05T11:22:45+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1974<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/</a>"}]},"apps":[],"jobName":"paragraph_1693905765987_1878563652","id":"20230904-163154_320588915","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:117"},{"title":"Do not work to remove","text":"%pyspark\npath2 = \"/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230711115235t.csv\"\n\nfrom dbutils import dbutils\n\n# Use dbutils.fs.rm to delete the file or folder\ndbutils.fs.rm(path2, recurse=False)","dateUpdated":"2023-09-05T11:22:46+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1974<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1974/</a>"}]},"apps":[],"jobName":"paragraph_1693905765999_1873946665","id":"20230904-161648_1514357889","dateCreated":"2023-09-05T11:22:45+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:118"},{"text":"%pyspark\npath3 = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index\"\npath4 = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives\"\n\n# Use subprocess to run the HDFS command to delete the file or folder\n# Be cautious when using this method as it directly interacts with HDFS.\nsubprocess.run([\"hadoop\", \"dfs\", \"-rm\", \"-r\", path3])\nsubprocess.run([\"hadoop\", \"dfs\", \"-rm\", \"-r\", path4])","dateUpdated":"2023-09-05T11:22:46+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Unrecognized token 'Deleted': was expecting ('true', 'false' or 'null')\n at [Source: Deleted /datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index; line: 1, column: 8]"}]},"apps":[],"jobName":"paragraph_1693905766011_1881641643","id":"20230904-161959_1637033785","dateCreated":"2023-09-05T11:22:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:119"},{"text":"%pyspark\ntest_submit_log_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/Log_ACMF_Archive_TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420269_20230720054352t.parquet\"\n\ntest_submit_log_df = spark.read.parquet(test_submit_log_path)\n\ntest_submit_log_df.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:46+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|                                       file_name_no_extension|                                         File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|                                           Raw_file_legacy_folder_path|                                            Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420269_20230720054352t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420269_20230720054352t.csv|          .csv|      Raw|           true|       2023-07-20 05:43:52|     20230720054352|         0420269|  SN269|               0420|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN269/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN269/Yea...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 19:43:08.567|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420269_20230720054352t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420269_20230720054352t.csv|          .csv|      Raw|           true|       2023-07-20 05:43:52|     20230720054352|         0420269|  SN269|               0420|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN269/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN269/Yea...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 10:17:10.536|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693905766023_1963208410","id":"20230904-171216_304443268","dateCreated":"2023-09-05T11:22:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:120"},{"text":"%pyspark\ntest_submit_log_path_2 = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/Log_ACMF_Archive_TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230608104141t.parquet\"\n\ntest_submit_log_df_2 = spark.read.parquet(test_submit_log_path_2)\n\ntest_submit_log_df_2.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:46+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|                                       file_name_no_extension|                                         File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|                                           Raw_file_legacy_folder_path|                                            Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230608104141t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230608104141t.csv|          .csv|      Raw|           true|       2023-06-08 10:41:41|     20230608104141|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN270/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN270/Yea...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 11:00:16.506|\n|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230608104141t|TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230608104141t.csv|          .csv|      Raw|           true|       2023-06-08 10:41:41|     20230608104141|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN270/TRD_P1153_IS...|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN270/Yea...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 20:23:42.083|\n+-------------------------------------------------------------+-----------------------------------------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693905766034_1971288137","id":"20230905-110443_1793002940","dateCreated":"2023-09-05T11:22:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:121"},{"text":"%pyspark\n# If you read from the Index folder you will not be to overwrite files in the index folder\nLog_files_Index_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/*\"\nLog_files_Archive_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Log_Archives/*\"\n\nLog_file_df = spark.read.parquet(Log_files_Index_Dir_path)\n\nLog_file_df.show(40, truncate=30)","dateUpdated":"2023-09-05T11:22:46+0200","config":{"colWidth":12,"results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------------------+------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+------------------------------+------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|        file_name_no_extension|      File_name_with_extension|File_extension|File_type|Valid_file_name|File_date_as_TimestampType|File_date_as_String|File_complete_ID|File_SN|File_aircraft_model|   Raw_file_legacy_folder_path|    Raw_file_dated_folder_path|Raw_file_legacy_folder_copied|Raw_file_dated_folder_copied|Flight_file_name|TRD_starts_file_name|MUX_starts_file_name|IRYS2_in_file_name|PERFOS_in_file_name|FAIL_in_file_name|Is_Vol|IRYS2_or_PERFOS|Is_System|System_Name|            Update_Date|\n+------------------------------+------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+------------------------------+------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-04 15:09:47|     20230604150947|         0420269|  SN269|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 08:37:31.158|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-05-25 16:49:35|     20230525164935|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 22:16:59.885|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-04 17:19:07|     20230704171907|         0580425|  SN425|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-05 02:10:34.67|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-09 21:46:57|     20230709214657|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 03:22:19.901|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-28 19:55:53|     20230628195553|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 23:25:58.468|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-10 06:54:46|     20230710065446|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 03:29:36.047|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-04 06:45:25|     20230704064525|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 03:15:24.715|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-13 17:12:09|     20230713171209|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 23:52:36.671|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-15 07:38:37|     20230615073837|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 20:38:37.448|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-11 20:43:54|     20230611204354|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 22:44:33.595|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-17 16:51:43|     20230717165143|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|  2023-09-05 00:19:38.1|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-04 12:36:46|     20230604123646|         0420269|  SN269|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 08:35:25.285|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-11 12:47:59|     20230711124759|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 23:44:47.905|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-19 23:06:29|     20230719230629|         0580425|  SN425|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 02:23:58.884|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-11 20:59:27|     20230611205927|         0580466|  SN466|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 04:36:25.912|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-08 06:36:36|     20230608063636|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 22:37:26.774|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-11 19:14:04|     20230611191404|         0580466|  SN466|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 04:34:57.341|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-19 02:37:39|     20230719023739|         0580425|  SN425|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 02:21:47.305|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-20 16:58:23|     20230720165823|         0580425|  SN425|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 02:27:32.293|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-29 20:58:04|     20230629205804|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|  2023-09-04 23:32:45.1|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-19 18:53:27|     20230619185327|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-04 20:46:58.88|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-26 15:39:36|     20230726153936|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-05 03:49:53.82|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-04 13:38:21|     20230704133821|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-04 21:04:35.73|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-03 05:03:00|     20230603050300|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-04 22:27:24.42|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-08-02 10:29:32|     20230802102932|         0580466|  SN466|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 06:13:53.222|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-18 17:48:38|     20230718174838|         0580466|  SN466|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 05:54:10.941|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-06 11:29:53|     20230606112953|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-05 10:59:58.78|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-24 06:30:10|     20230624063010|         0420269|  SN269|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-05 09:20:44.63|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-11 11:01:31|     20230711110131|         0580466|  SN466|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 05:44:42.846|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-05 07:41:38|     20230705074138|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|  2023-09-04 21:06:43.7|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-19 14:40:16|     20230619144016|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 20:43:39.467|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-11 14:49:39|     20230611144939|         0420270|  SN270|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 11:07:41.946|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-17 14:13:03|     20230717141303|         0420269|  SN269|               0420|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 09:57:05.213|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-15 17:19:10|     20230715171910|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null| 2023-09-05 00:12:12.36|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-18 16:12:41|     20230618161241|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 23:11:48.219|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-18 06:24:20|     20230618062420|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 23:04:03.149|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-29 05:30:36|     20230629053036|         0580466|  SN466|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 05:17:09.943|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-13 19:53:46|     20230713195346|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 23:54:48.255|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-07-03 07:39:00|     20230703073900|         0580449|  SN449|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-05 03:13:27.819|\n|TRD_P1153_ISSUE_3_PERFOS_IR...|TRD_P1153_ISSUE_3_PERFOS_IR...|          .csv|      Raw|           true|       2023-06-13 23:35:25|     20230613233525|         0580412|  SN412|               0580|/datalake/prod/c2/ddd/crm/a...|/datalake/prod/c2/ddd/crm/a...|                         null|                        null|            null|                true|               false|              true|               true|            false|  true|         IRYS2_|    false|       null|2023-09-04 22:52:57.493|\n+------------------------------+------------------------------+--------------+---------+---------------+--------------------------+-------------------+----------------+-------+-------------------+------------------------------+------------------------------+-----------------------------+----------------------------+----------------+--------------------+--------------------+------------------+-------------------+-----------------+------+---------------+---------+-----------+-----------------------+\nonly showing top 40 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693905766046_1966671150","id":"20230905-103413_268037703","dateCreated":"2023-09-05T11:22:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:122"},{"text":"%pyspark\nLog_file_df_2 = Log_file_df\nLog_file_df_2.count()","dateUpdated":"2023-09-05T11:22:46+0200","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"editOnDblClick":false,"language":"python"}},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"An error occurred while calling o80.count.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 4 in stage 16.0 failed 4 times, most recent failure: Lost task 4.3 in stage 16.0 (TID 13379, dalbigc04.dassault-avion.fr, executor 5): java.io.FileNotFoundException: File does not exist: hdfs://hdfs.isilon.dassault-avion.fr:8020/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/Log_ACMF_Index_TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230612151737t.parquet/part-00063-42564b9f-0d60-43b2-b2ac-651e6e9475e4-c000.snappy.parquet\nIt is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:131)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:182)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:109)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.scan_nextBatch$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithoutKey$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1587)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1586)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1586)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1820)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1769)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1758)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2099)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:939)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:363)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:938)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:297)\n\tat org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2770)\n\tat org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2769)\n\tat org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3253)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3252)\n\tat org.apache.spark.sql.Dataset.count(Dataset.scala:2769)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.io.FileNotFoundException: File does not exist: hdfs://hdfs.isilon.dassault-avion.fr:8020/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/Log_ACMF_Index_TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230612151737t.parquet/part-00063-42564b9f-0d60-43b2-b2ac-651e6e9475e4-c000.snappy.parquet\nIt is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:131)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:182)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:109)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.scan_nextBatch$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithoutKey$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\nTraceback (most recent call last):\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1980/container_e96_1661169780396_1980_01_000001/pyspark.zip/pyspark/sql/dataframe.py\", line 455, in count\n    return int(self._jdf.count())\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1980/container_e96_1661169780396_1980_01_000001/py4j-0.10.6-src.zip/py4j/java_gateway.py\", line 1160, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1980/container_e96_1661169780396_1980_01_000001/pyspark.zip/pyspark/sql/utils.py\", line 63, in deco\n    return f(*a, **kw)\n  File \"/hadoop/yarn/local/usercache/e854129/appcache/application_1661169780396_1980/container_e96_1661169780396_1980_01_000001/py4j-0.10.6-src.zip/py4j/protocol.py\", line 320, in get_return_value\n    format(target_id, \".\", name), value)\npy4j.protocol.Py4JJavaError: An error occurred while calling o80.count.\n: org.apache.spark.SparkException: Job aborted due to stage failure: Task 4 in stage 16.0 failed 4 times, most recent failure: Lost task 4.3 in stage 16.0 (TID 13379, dalbigc04.dassault-avion.fr, executor 5): java.io.FileNotFoundException: File does not exist: hdfs://hdfs.isilon.dassault-avion.fr:8020/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/Log_ACMF_Index_TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230612151737t.parquet/part-00063-42564b9f-0d60-43b2-b2ac-651e6e9475e4-c000.snappy.parquet\nIt is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:131)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:182)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:109)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.scan_nextBatch$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithoutKey$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\n\nDriver stacktrace:\n\tat org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1599)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1587)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$abortStage$1.apply(DAGScheduler.scala:1586)\n\tat scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n\tat scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.abortStage(DAGScheduler.scala:1586)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGScheduler$$anonfun$handleTaskSetFailed$1.apply(DAGScheduler.scala:831)\n\tat scala.Option.foreach(Option.scala:257)\n\tat org.apache.spark.scheduler.DAGScheduler.handleTaskSetFailed(DAGScheduler.scala:831)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1820)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1769)\n\tat org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1758)\n\tat org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n\tat org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:642)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2034)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2055)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2074)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2099)\n\tat org.apache.spark.rdd.RDD$$anonfun$collect$1.apply(RDD.scala:939)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:363)\n\tat org.apache.spark.rdd.RDD.collect(RDD.scala:938)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollect(SparkPlan.scala:297)\n\tat org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2770)\n\tat org.apache.spark.sql.Dataset$$anonfun$count$1.apply(Dataset.scala:2769)\n\tat org.apache.spark.sql.Dataset$$anonfun$52.apply(Dataset.scala:3253)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:77)\n\tat org.apache.spark.sql.Dataset.withAction(Dataset.scala:3252)\n\tat org.apache.spark.sql.Dataset.count(Dataset.scala:2769)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:214)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: java.io.FileNotFoundException: File does not exist: hdfs://hdfs.isilon.dassault-avion.fr:8020/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_current_State_and_Index/Log_ACMF_Index_TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0420270_20230612151737t.parquet/part-00063-42564b9f-0d60-43b2-b2ac-651e6e9475e4-c000.snappy.parquet\nIt is possible the underlying files have been updated. You can explicitly invalidate the cache in Spark by running 'REFRESH TABLE tableName' command in SQL or by recreating the Dataset/DataFrame involved.\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.org$apache$spark$sql$execution$datasources$FileScanRDD$$anon$$readCurrentFile(FileScanRDD.scala:131)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.nextIterator(FileScanRDD.scala:182)\n\tat org.apache.spark.sql.execution.datasources.FileScanRDD$$anon$1.hasNext(FileScanRDD.scala:109)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.scan_nextBatch$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.agg_doAggregateWithoutKey$(Unknown Source)\n\tat org.apache.spark.sql.catalyst.expressions.GeneratedClass$GeneratedIteratorForCodegenStage1.processNext(Unknown Source)\n\tat org.apache.spark.sql.execution.BufferedRowIterator.hasNext(BufferedRowIterator.java:43)\n\tat org.apache.spark.sql.execution.WholeStageCodegenExec$$anonfun$10$$anon$1.hasNext(WholeStageCodegenExec.scala:614)\n\tat scala.collection.Iterator$$anon$11.hasNext(Iterator.scala:408)\n\tat org.apache.spark.shuffle.sort.BypassMergeSortShuffleWriter.write(BypassMergeSortShuffleWriter.java:125)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:96)\n\tat org.apache.spark.scheduler.ShuffleMapTask.runTask(ShuffleMapTask.scala:53)\n\tat org.apache.spark.scheduler.Task.run(Task.scala:109)\n\tat org.apache.spark.executor.Executor$TaskRunner.run(Executor.scala:345)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\t... 1 more\n\n"}]},"apps":[],"jobName":"paragraph_1693905766058_1949742198","id":"20230905-110916_1097140312","dateCreated":"2023-09-05T11:22:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:123"},{"text":"%pyspark\ntest_submit_log_path_2 = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN269/MUX_P1153_ISSUE_3_TR_REPORT_0420269_20230720091122t.csv\"\n\ntest_submit_log_df_2 = spark.read.csv(test_submit_log_path_2)\n\ntest_submit_log_df_2.show(150, truncate=70)","dateUpdated":"2023-09-05T11:22:46+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------+\n|                                              _c0|\n+-------------------------------------------------+\n|           ReportName MUX_P1153_ISSUE_3_TR_REPORT|\n|AcmfApplicationName C:\\CMC\\APPLICATIONS\\\\USER.ACM|\n|                     AcmfApplicationVersion 4.0.-|\n|                 TriggerTime 20 JUL 2023 09:10:50|\n|           Report written on 20 JUL 2023 09:11:22|\n|                       Aircraft Tail Number DAGBF|\n|                                   Frame (100 ms)|\n|                                             -100|\n|                                              -99|\n|                                              -98|\n|                                              -97|\n|                                              -96|\n|                                              -95|\n|                                              -94|\n|                                              -93|\n|                                              -92|\n|                                              -91|\n|                                              -90|\n|                                              -89|\n|                                              -88|\n|                                              -87|\n|                                              -86|\n|                                              -85|\n|                                              -84|\n|                                              -83|\n|                                              -82|\n|                                              -81|\n|                                              -80|\n|                                              -79|\n|                                              -78|\n|                                              -77|\n|                                              -76|\n|                                              -75|\n|                                              -74|\n|                                              -73|\n|                                              -72|\n|                                              -71|\n|                                              -70|\n|                                              -69|\n|                                              -68|\n|                                              -67|\n|                                              -66|\n|                                              -65|\n|                                              -64|\n|                                              -63|\n|                                              -62|\n|                                              -61|\n|                                              -60|\n|                                              -59|\n|                                              -58|\n|                                              -57|\n|                                              -56|\n|                                              -55|\n|                                              -54|\n|                                              -53|\n|                                              -52|\n|                                              -51|\n|                                              -50|\n|                                              -49|\n|                                              -48|\n|                                              -47|\n|                                              -46|\n|                                              -45|\n|                                              -44|\n|                                              -43|\n|                                              -42|\n|                                              -41|\n|                                              -40|\n|                                              -39|\n|                                              -38|\n|                                              -37|\n|                                              -36|\n|                                              -35|\n|                                              -34|\n|                                              -33|\n|                                              -32|\n|                                              -31|\n|                                              -30|\n|                                              -29|\n|                                              -28|\n|                                              -27|\n|                                              -26|\n|                                              -25|\n|                                              -24|\n|                                              -23|\n|                                              -22|\n|                                              -21|\n|                                              -20|\n|                                              -19|\n|                                              -18|\n|                                              -17|\n|                                              -16|\n|                                              -15|\n|                                              -14|\n|                                              -13|\n|                                              -12|\n|                                              -11|\n|                                              -10|\n|                                               -9|\n|                                               -8|\n|                                               -7|\n|                                               -6|\n|                                               -5|\n|                                               -4|\n|                                               -3|\n|                                               -2|\n|                                               -1|\n|                                                0|\n|                                                1|\n|                                                2|\n|                                                3|\n|                                                4|\n|                                                5|\n|                                                6|\n|                                                7|\n|                                                8|\n|                                                9|\n|                                               10|\n|                                               11|\n|                                               12|\n|                                               13|\n|                                               14|\n|                                               15|\n|                                               16|\n|                                               17|\n|                                               18|\n|                                               19|\n|                                               20|\n|                                               21|\n|                                               22|\n|                                               23|\n|                                               24|\n|                                               25|\n|                                               26|\n|                                               27|\n|                                               28|\n|                                               29|\n|                                               30|\n|                                               31|\n|                                               32|\n|                                               33|\n|                                               34|\n|                                               35|\n|                                               36|\n|                                               37|\n|                                               38|\n|                                               39|\n|                                               40|\n|                                               41|\n|                                               42|\n+-------------------------------------------------+\nonly showing top 150 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693905766070_1957437176","id":"20230905-111604_152604979","dateCreated":"2023-09-05T11:22:46+0200","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:124"},{"text":"%pyspark\ntest_submit_log_path_2 = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs/Error_Log_20230905144238455000.parquet\"\n\ntest_submit_log_df_2 = spark.read.parquet(test_submit_log_path_2)\n\ntest_submit_log_df_2.show(150, truncate=70)","user":"e854129","dateUpdated":"2023-09-05T14:43:15+0200","config":{"editorSetting":{"editOnDblClick":false,"language":"python"},"colWidth":12,"editorMode":"ace/mode/python","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------------------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------+\n|                                       Error_Name|                                               Data_curently_processed|                                                         Error_Message|            Update_Date|\n+-------------------------------------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------+\n|Error_1_hdfs_copy_file_from_source_to_destination|/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_I...|Command '['hadoop', 'dfs', '-cp', '/datalake/prod/c2/ddd/crm/acmf/C...|2023-09-05 14:42:38.535|\n+-------------------------------------------------+----------------------------------------------------------------------+----------------------------------------------------------------------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693917091227_733818235","id":"20230905-143131_52124576","dateCreated":"2023-09-05T14:31:31+0200","dateStarted":"2023-09-05T14:43:15+0200","dateFinished":"2023-09-05T14:43:18+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:125"},{"title":"Read error logs","text":"%pyspark\n# If you read from the Index folder you will not be to overwrite files in the index folder\nLog_files_error_Dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs/*\"\n\nLog_file_error_df = spark.read.parquet(Log_files_error_Dir_path).sort(F.col(\"Update_Date\").asc())\n\nLog_file_error_df.show(150, truncate=20000)","user":"e854129","dateUpdated":"2023-09-06T11:31:20+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----------------------------------------------------+--------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+\n|                                          Error_Name|                                                                                       Data_curently_processed|                                                                                                                              Error_Message|            Update_Date|\n+----------------------------------------------------+--------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+\n|Error_1_hdfs_check_if_dir_exist_and_create_it_if_not|/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449/MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625124740t.csv|Command '['hdfs', 'dfs', '-chmod', '-R', '777', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut/SN449']' returned non-zero exit status 1.|2023-09-06 11:24:15.919|\n+----------------------------------------------------+--------------------------------------------------------------------------------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------+-----------------------+"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693923255132_-1032201716","id":"20230905-161415_931466967","dateCreated":"2023-09-05T16:14:15+0200","dateStarted":"2023-09-06T11:31:20+0200","dateFinished":"2023-09-06T11:31:21+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:126"},{"title":"Copy file","text":"%pyspark\n\n# Source and destination HDFS paths\nsource_path = \"/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv\"\n#destination_path = \"/datalake/prod/c2/ddd/crm/acmf/To_delete\"\ndestination_path = \"/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv\"\n\n# Use subprocess to copy the file\n#copy_command = [\"hadoop\", \"fs\", \"-cp\", source_path, destination_path]\ncopy_command = [\"hadoop\", \"dfs\", \"-cp\", source_path, destination_path]\n#copy_command = [\"hadoop\", \"fs\", \"-cp\", \"-p\", source_path, destination_path]\n#copy_command = [\"hdfs\", \"dfs\", \"-cp\", \"-p\", source_path, destination_path]\n\n#grant_all_permission_command = [\"hadoop\", \"dfs\", \"-R\", \"777\", destination_path]\n\ntry:\n    subprocess.run(copy_command, check=True)\n    #subprocess.run(grant_all_permission_command, check=True)\n    print(\"File copied successfully.\")\nexcept subprocess.CalledProcessError as e:\n    print(f\"Error copying file: {e}\")","user":"e854129","dateUpdated":"2023-09-05T13:20:12+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"CompletedProcess(args=['hadoop', 'dfs', '-cp', '/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv', '/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv'], returncode=0)\nFile copied successfully."},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693905766081_1939353978","id":"20230905-111040_1251002404","dateCreated":"2023-09-05T11:22:46+0200","dateStarted":"2023-09-05T13:20:12+0200","dateFinished":"2023-09-05T13:20:15+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:127"},{"text":"%pyspark\nfile_to_change_path = \"/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv\"\ngrant_all_permission_command = [\"hadoop\", \"dfs\", \"-chmod\", \"777\", file_to_change_path]\nsubprocess.run(grant_all_permission_command, check=True)","user":"e854129","dateUpdated":"2023-09-05T13:02:55+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"CompletedProcess(args=['hadoop', 'dfs', '-chmod', '777', '/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv'], returncode=0)"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693911509613_635433901","id":"20230905-125829_901312681","dateCreated":"2023-09-05T12:58:29+0200","dateStarted":"2023-09-05T13:02:55+0200","dateFinished":"2023-09-05T13:02:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:128"},{"text":"%pyspark\ndef hdfs_copy_file_from_source_to_destination(source_file_path, destination_file_path):\n    # Use subprocess to copy the file, the permission are changed, , ownership of the file is not preserved and attributed to yarn\n    copy_command = [\"hadoop\", \"dfs\", \"-cp\", source_file_path, destination_file_path]\n    # Then to change the permissions\n    grant_all_permission_command = [\"hadoop\", \"dfs\", \"-chmod\", \"777\", file_to_change_path]\n    try:\n        subprocess.run(copy_command, check=True)\n        subprocess.run(grant_all_permission_command, check=True)\n        print(\"File copied successfully.\")\n    except subprocess.CalledProcessError as Error_1_hdfs_copy_file_from_source_to_destination:\n        error_name = \"Error_1_hdfs_copy_file_from_source_to_destination\"\n        error_message = Error_1_hdfs_copy_file_from_source_to_destination\n        data_processed = source_file_path\n        print(f\"Error copying file: {Error_1_hdfs_copy_file_from_source_to_destination}\")\n        print(\"error_name = \", error_name)\n        print(\"error_message = \", error_message)\n        print(\"data_processed = \", data_processed)","user":"e854129","dateUpdated":"2023-09-05T13:33:56+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693912491728_305605865","id":"20230905-131451_1355363455","dateCreated":"2023-09-05T13:14:51+0200","dateStarted":"2023-09-05T13:33:57+0200","dateFinished":"2023-09-05T13:33:58+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:129"},{"text":"%pyspark\nsource_path = \"/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv\"\ndestination_path = \"/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv\"\n\nhdfs_copy_file_from_source_to_destination(source_path, destination_path)","user":"e854129","dateUpdated":"2023-09-05T13:34:01+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Error copying file: Command '['hadoop', 'dfs', '-cp', '/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv', '/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv']' returned non-zero exit status 1.\nerror_name =  Error_1_hdfs_copy_file_from_source_to_destination\nerror_message =  Command '['hadoop', 'dfs', '-cp', '/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv', '/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv']' returned non-zero exit status 1.\ndata_processed =  /datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693913440118_-1777847179","id":"20230905-133040_1600598805","dateCreated":"2023-09-05T13:30:40+0200","dateStarted":"2023-09-05T13:34:01+0200","dateFinished":"2023-09-05T13:34:04+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:130"},{"text":"%pyspark\ndef create_basic_error_log_df(error_name, data_curently_processed = None, error_message = None):\n\tfields = [StructField(\"Error_Name\", StringType(),True),\n\t  StructField(\"Data_curently_processed\", StringType(),True),\n\t  StructField(\"Error_Message\", StringType(),True),\n\t ]\n\tschema = StructType(fields)\n\n\t# load data\n\tdata = [[error_name, data_curently_processed, error_message]]\n\n\tdf = spark.createDataFrame(data, schema)\n\t# Add a column with the curreent_timestamp to trace the date of the last modification\n\tdf = df.withColumn(\"Update_Date\", F.current_timestamp()) \n\treturn df\n\ndef write_Error_Log_File(error_log_df, error_log_file_name, error_log_file_dir_path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\"):\n    error_log_file_complete_path = error_log_file_dir_path + \"/\" + error_log_file_name\n    error_log_df.write.mode(\"overwrite\").parquet(error_log_file_complete_path)\n\ndef log_error_message(Error_Name, Data_Curently_Processed = None, Error_Message = None, Error_Log_File_Dir_Path = \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\"):\n    basic_error_log_name_string = \"Error_Log_\"\n    current_time = spark.sql(\"SELECT current_timestamp() as current_time\").collect()[0][\"current_time\"]\n    current_time_str = strip_non_numeric_char_from_string(str(current_time))\n    Error_Log_File_Name = basic_error_log_name_string + current_time_str + \".parquet\"\n    \n    # Create the basic df for the log file\n    Error_Log_df = create_basic_error_log_df(Error_Name, Data_Curently_Processed, Error_Message)\n    \n    # Save the error log\n    write_Error_Log_File(Error_Log_df, Error_Log_File_Name, Error_Log_File_Dir_Path)\n    \ndef hdfs_copy_file_from_source_to_destination(source_file_path, destination_file_path):\n    # Use subprocess to copy the file, the permission are changed, , ownership of the file is not preserved and attributed to yarn\n    copy_command = [\"hadoop\", \"dfs\", \"-cp\", source_file_path, destination_file_path]\n    # Then to change the permissions\n    grant_all_permission_command = [\"hadoop\", \"dfs\", \"-chmod\", \"777\", file_to_change_path]\n    try:\n        subprocess.run(copy_command, check=True)\n        subprocess.run(grant_all_permission_command, check=True)\n        #print(\"File copied successfully.\")\n    except subprocess.CalledProcessError as Error_1_hdfs_copy_file_from_source_to_destination:\n        current_error_name = \"Error_1_hdfs_copy_file_from_source_to_destination\"\n        current_error_message = str(Error_1_hdfs_copy_file_from_source_to_destination)\n        current_data_processed = source_file_path\n        #print(f\"Error copying file: {Error_1_hdfs_copy_file_from_source_to_destination}\")\n        #print(\"error_name = \", current_error_name)\n        #print(\"error_message = \", current_error_message)\n        #print(\"data_processed = \", current_data_processed)\n        log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n","user":"e854129","dateUpdated":"2023-09-05T14:44:02+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693913575141_1062166698","id":"20230905-133255_1690420957","dateCreated":"2023-09-05T13:32:55+0200","dateStarted":"2023-09-05T14:44:02+0200","dateFinished":"2023-09-05T14:44:03+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:131"},{"text":"%pyspark\nsource_path = \"/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv\"\ndestination_path = \"/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv\"\n\nhdfs_copy_file_from_source_to_destination(source_path, destination_path)","user":"e854129","dateUpdated":"2023-09-05T14:42:32+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Error copying file: Command '['hadoop', 'dfs', '-cp', '/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv', '/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv']' returned non-zero exit status 1.\nerror_name =  Error_1_hdfs_copy_file_from_source_to_destination\nerror_message =  Command '['hadoop', 'dfs', '-cp', '/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv', '/datalake/prod/c2/ddd/crm/acmf/To_delete/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv']' returned non-zero exit status 1.\ndata_processed =  /datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_20230803151826t.csv"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693915527030_1162976367","id":"20230905-140527_90468623","dateCreated":"2023-09-05T14:05:27+0200","dateStarted":"2023-09-05T14:42:32+0200","dateFinished":"2023-09-05T14:42:36+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:132"},{"text":"%pyspark\ndef hdfs_check_if_file_exist(file_path):\n    test_command = [\"hadoop\", \"fs\", \"-test\", \"-e\", file_path]\n    try:\n        subprocess.run(test_command, check=True)\n        return True\n        # You can perform your copy operation or other tasks here if the file exists.\n    except subprocess.CalledProcessError as Error_1_hdfs_check_if_file_exist:\n        current_error_name = \"Error_1_hdfs_check_if_file_exist\"\n        current_error_message = str(Error_1_hdfs_check_if_file_exist)\n        current_data_processed = file_path\n        log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n        return False\n\n\nhdfs_path = \"/datalake/prod/c2/ddd/crm/acmf/Copy_New_raw_files/SN466/TRD_P1153_ISSUE_3_PERFOS_IRYS2_REPORT_0580466_202308031826t.csv\"\n\nres = hdfs_check_if_file_exist(hdfs_path)\nprint(res)","user":"e854129","dateUpdated":"2023-09-05T15:25:19+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"False"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693916761805_-1470496346","id":"20230905-142601_812006147","dateCreated":"2023-09-05T14:26:01+0200","dateStarted":"2023-09-05T15:25:19+0200","dateFinished":"2023-09-05T15:25:22+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:133"},{"text":"%pyspark\ndef hdfs_check_if_dir_exist_and_create_it_if_not(full_path):\n    directory_that_need_to_exist_path = os.path.dirname(full_path)\n    mkdir_command = [\"hdfs\", \"dfs\", \"-mkdir\", \"-p\", directory_that_need_to_exist_path]\n    try:\n        subprocess.run(mkdir_command, check=True)\n    except subprocess.CalledProcessError as Error_1_hdfs_check_if_dir_exist_and_create_it_if_not:\n        current_error_name = \"Error_1_hdfs_check_if_dir_exist_and_create_it_if_not\"\n        current_error_message = str(Error_1_hdfs_check_if_dir_exist_and_create_it_if_not)\n        current_data_processed = full_path\n        log_error_message(current_error_name, current_data_processed, current_error_message, \"/datalake/prod/c2/ddd/crm/acmf/Log_ACMF_Files/ACMF_Error_Logs\")\n\nfull_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449/Year_2023/Month_06/Day_25/MUX_P1153_ISSUE_3_BCS_REPORT_0580449_20230625125813t.csv\"\nhdfs_check_if_dir_exist_and_create_it_if_not(full_path)","user":"e854129","dateUpdated":"2023-09-05T17:11:36+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693919584472_-1892540175","id":"20230905-151304_965077947","dateCreated":"2023-09-05T15:13:04+0200","dateStarted":"2023-09-05T17:11:36+0200","dateFinished":"2023-09-05T17:11:39+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:134"},{"text":"%pyspark\ndir_file_path = \"/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449\"\ngrant_all_permission_command_recursive = [\"hadoop\", \"dfs\", \"-chmod\", \"-R\", \"777\", dir_file_path]\n\nsubprocess.run(grant_all_permission_command_recursive, check=True)","user":"e854129","dateUpdated":"2023-09-05T17:51:29+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"CompletedProcess(args=['hadoop', 'dfs', '-chmod', '-R', '777', '/datalake/prod/c2/ddd/crm/acmf/Test_fichier_brut_par_mois/SN449'], returncode=0)"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1980<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1980/</a>"}]},"apps":[],"jobName":"paragraph_1693925690169_-1141006866","id":"20230905-165450_1870358126","dateCreated":"2023-09-05T16:54:50+0200","dateStarted":"2023-09-05T17:51:30+0200","dateFinished":"2023-09-05T17:51:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:135"},{"text":"%pyspark\nnew_raw_file_path = \"/datalake/prod/c2/ddd/crm/acmf/New_raw_files/SN449/MUX_P1153_ISSUE_3_AB_REPORT_0580449_20230625133725t.csv\"\n\ndf_to_copy = spark.read.option(\"delimiter\", \",\").option(\"header\", \"false\").csv(new_raw_file_path)\n\ndf_to_copy.show()","user":"e854129","dateUpdated":"2023-09-06T10:58:28+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+\n|                 _c0|\n+--------------------+\n|ReportName MUX_P1...|\n|AcmfApplicationNa...|\n|AcmfApplicationVe...|\n|TriggerTime 25 JU...|\n|Report written on...|\n|Aircraft Tail Num...|\n|     Frame (100 ms) |\n|                 -50|\n|                 -49|\n|                 -48|\n|                 -47|\n|                 -46|\n|                 -45|\n|                 -44|\n|                 -43|\n|                 -42|\n|                 -41|\n|                 -40|\n|                 -39|\n|                 -38|\n+--------------------+\nonly showing top 20 rows"},{"type":"HTML","data":"<hr/>Spark Application Id: application_1661169780396_1984<br/>Spark WebUI: <a href=\"http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/\">http://dalbigm02.dassault-avion.fr:8088/proxy/application_1661169780396_1984/</a>"}]},"apps":[],"jobName":"paragraph_1693929089679_1974828921","id":"20230905-175129_1835592452","dateCreated":"2023-09-05T17:51:29+0200","dateStarted":"2023-09-06T10:58:29+0200","dateFinished":"2023-09-06T10:58:33+0200","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:136"},{"text":"%pyspark\n","user":"e854129","dateUpdated":"2023-09-06T10:50:09+0200","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"editOnDblClick":false,"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1693990209761_-715774029","id":"20230906-105009_2093819390","dateCreated":"2023-09-06T10:50:09+0200","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:137"}],"name":"Prestation/Cedric_Schlosser/0_Pretraitement/preprocess_new_files_V2_11","id":"2JBRFCB8D","angularObjects":{"2E9RNJTWH:e854129:":[],"2DTHQK84C:e854129:2JBRFCB8D":[],"2DPT2KY4G:e854129:":[],"2DMZD3RC8:e854129:":[],"2DR8NJJ56:e854129:":[],"2HBEPS2W4:e854129:":[],"2C4U48MY3_spark2:e854129:":[],"2CHS8UYQQ:e854129:":[],"2CK8A9MEG:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[],"2HEW5MG2H:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}